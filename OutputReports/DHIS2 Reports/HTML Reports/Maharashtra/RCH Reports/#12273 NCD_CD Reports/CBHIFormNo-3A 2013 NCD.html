<!-- Developed by Shubham -->
<script type="text/javascript">
	
	/* Do not mess with this array! */
	const dataElements = [ 'M0VI1CNzOdF.uLtet5GVzs3', 'M0VI1CNzOdF.dN0s5oP00Ut', 'M0VI1CNzOdF.ibTTSMZJhFP', 'M0VI1CNzOdF.i5K96le4IjS', 'M0VI1CNzOdF.mG0zgFfA9iY', 'M0VI1CNzOdF.Rr0iLjh3jMJ', 'M0VI1CNzOdF.bSTwITmU6dE', 'M0VI1CNzOdF.o94sqEfZl2w', 'ztBYgp7xHOb.uLtet5GVzs3', 'ztBYgp7xHOb.dN0s5oP00Ut', 'ztBYgp7xHOb.ibTTSMZJhFP', 'ztBYgp7xHOb.i5K96le4IjS', 'ztBYgp7xHOb.mG0zgFfA9iY', 'ztBYgp7xHOb.Rr0iLjh3jMJ', 'ztBYgp7xHOb.bSTwITmU6dE', 'ztBYgp7xHOb.o94sqEfZl2w', 'Fggameo1xlD.uLtet5GVzs3', 'Fggameo1xlD.dN0s5oP00Ut', 'Fggameo1xlD.ibTTSMZJhFP', 'Fggameo1xlD.i5K96le4IjS', 'Fggameo1xlD.mG0zgFfA9iY', 'Fggameo1xlD.Rr0iLjh3jMJ', 'Fggameo1xlD.bSTwITmU6dE', 'Fggameo1xlD.o94sqEfZl2w', 'GjBLefjt3vk.uLtet5GVzs3', 'GjBLefjt3vk.dN0s5oP00Ut', 'GjBLefjt3vk.ibTTSMZJhFP', 'GjBLefjt3vk.i5K96le4IjS', 'GjBLefjt3vk.mG0zgFfA9iY', 'GjBLefjt3vk.Rr0iLjh3jMJ', 'GjBLefjt3vk.bSTwITmU6dE', 'GjBLefjt3vk.o94sqEfZl2w', 'FDAC50Eb39x.uLtet5GVzs3', 'FDAC50Eb39x.dN0s5oP00Ut', 'FDAC50Eb39x.ibTTSMZJhFP', 'FDAC50Eb39x.i5K96le4IjS', 'FDAC50Eb39x.mG0zgFfA9iY', 'FDAC50Eb39x.Rr0iLjh3jMJ', 'FDAC50Eb39x.bSTwITmU6dE', 'FDAC50Eb39x.o94sqEfZl2w', 'PZC4eswxppF.uLtet5GVzs3', 'PZC4eswxppF.dN0s5oP00Ut', 'PZC4eswxppF.ibTTSMZJhFP', 'PZC4eswxppF.i5K96le4IjS', 'PZC4eswxppF.mG0zgFfA9iY', 'PZC4eswxppF.Rr0iLjh3jMJ', 'PZC4eswxppF.bSTwITmU6dE', 'PZC4eswxppF.o94sqEfZl2w', 'zPZeRNnQcUu.uLtet5GVzs3', 'zPZeRNnQcUu.dN0s5oP00Ut', 'zPZeRNnQcUu.ibTTSMZJhFP', 'zPZeRNnQcUu.i5K96le4IjS', 'zPZeRNnQcUu.mG0zgFfA9iY', 'zPZeRNnQcUu.Rr0iLjh3jMJ', 'zPZeRNnQcUu.bSTwITmU6dE', 'zPZeRNnQcUu.o94sqEfZl2w', 'DFakZCGwgpW.uLtet5GVzs3', 'DFakZCGwgpW.dN0s5oP00Ut', 'DFakZCGwgpW.ibTTSMZJhFP', 'DFakZCGwgpW.i5K96le4IjS', 'DFakZCGwgpW.mG0zgFfA9iY', 'DFakZCGwgpW.Rr0iLjh3jMJ', 'DFakZCGwgpW.bSTwITmU6dE', 'DFakZCGwgpW.o94sqEfZl2w', 'YLKiYmvlFi1.uLtet5GVzs3', 'YLKiYmvlFi1.dN0s5oP00Ut', 'YLKiYmvlFi1.ibTTSMZJhFP', 'YLKiYmvlFi1.i5K96le4IjS', 'YLKiYmvlFi1.mG0zgFfA9iY', 'YLKiYmvlFi1.Rr0iLjh3jMJ', 'YLKiYmvlFi1.bSTwITmU6dE', 'YLKiYmvlFi1.o94sqEfZl2w', 'HLORUa7Llmw.uLtet5GVzs3', 'HLORUa7Llmw.dN0s5oP00Ut', 'HLORUa7Llmw.ibTTSMZJhFP', 'HLORUa7Llmw.i5K96le4IjS', 'HLORUa7Llmw.mG0zgFfA9iY', 'HLORUa7Llmw.Rr0iLjh3jMJ', 'HLORUa7Llmw.bSTwITmU6dE', 'HLORUa7Llmw.o94sqEfZl2w', 'vQNN6exCn3j.uLtet5GVzs3', 'vQNN6exCn3j.dN0s5oP00Ut', 'vQNN6exCn3j.ibTTSMZJhFP', 'vQNN6exCn3j.i5K96le4IjS', 'vQNN6exCn3j.mG0zgFfA9iY', 'vQNN6exCn3j.Rr0iLjh3jMJ', 'vQNN6exCn3j.bSTwITmU6dE', 'vQNN6exCn3j.o94sqEfZl2w', 'VczYgXRYKWP.uLtet5GVzs3', 'VczYgXRYKWP.dN0s5oP00Ut', 'VczYgXRYKWP.ibTTSMZJhFP', 'VczYgXRYKWP.i5K96le4IjS', 'VczYgXRYKWP.mG0zgFfA9iY', 'VczYgXRYKWP.Rr0iLjh3jMJ', 'VczYgXRYKWP.bSTwITmU6dE', 'VczYgXRYKWP.o94sqEfZl2w', 'LxNU1jn812i.uLtet5GVzs3', 'LxNU1jn812i.dN0s5oP00Ut', 'LxNU1jn812i.ibTTSMZJhFP', 'LxNU1jn812i.i5K96le4IjS', 'LxNU1jn812i.mG0zgFfA9iY', 'LxNU1jn812i.Rr0iLjh3jMJ', 'LxNU1jn812i.bSTwITmU6dE', 'LxNU1jn812i.o94sqEfZl2w', 'XpMocFtN796.uLtet5GVzs3', 'XpMocFtN796.dN0s5oP00Ut', 'XpMocFtN796.ibTTSMZJhFP', 'XpMocFtN796.i5K96le4IjS', 'XpMocFtN796.mG0zgFfA9iY', 'XpMocFtN796.Rr0iLjh3jMJ', 'XpMocFtN796.bSTwITmU6dE', 'XpMocFtN796.o94sqEfZl2w', 'sxM98il6fNX.uLtet5GVzs3', 'sxM98il6fNX.dN0s5oP00Ut', 'sxM98il6fNX.ibTTSMZJhFP', 'sxM98il6fNX.i5K96le4IjS', 'sxM98il6fNX.mG0zgFfA9iY', 'sxM98il6fNX.Rr0iLjh3jMJ', 'sxM98il6fNX.bSTwITmU6dE', 'sxM98il6fNX.o94sqEfZl2w', 'BPvNGx7Ejcr.uLtet5GVzs3', 'BPvNGx7Ejcr.dN0s5oP00Ut', 'BPvNGx7Ejcr.ibTTSMZJhFP', 'BPvNGx7Ejcr.i5K96le4IjS', 'BPvNGx7Ejcr.mG0zgFfA9iY', 'BPvNGx7Ejcr.Rr0iLjh3jMJ', 'BPvNGx7Ejcr.bSTwITmU6dE', 'BPvNGx7Ejcr.o94sqEfZl2w', 'hlD5qV0giK.uLtet5GVzs3', 'khlD5qV0giK.dN0s5oP00Ut', 'khlD5qV0giK.ibTTSMZJhFP', 'khlD5qV0giK.i5K96le4IjS', 'khlD5qV0giK.mG0zgFfA9iY', 'khlD5qV0giK.Rr0iLjh3jMJ', 'khlD5qV0giK.bSTwITmU6dE', 'khlD5qV0giK.o94sqEfZl2w', 'Rcv3ilHRSf6.uLtet5GVzs3', 'Rcv3ilHRSf6.dN0s5oP00Ut', 'Rcv3ilHRSf6.ibTTSMZJhFP', 'Rcv3ilHRSf6.i5K96le4IjS', 'Rcv3ilHRSf6.mG0zgFfA9iY', 'Rcv3ilHRSf6.Rr0iLjh3jMJ', 'Rcv3ilHRSf6.bSTwITmU6dE', 'Rcv3ilHRSf6.o94sqEfZl2w', 'Jmq2g1MnCnM.uLtet5GVzs3', 'Jmq2g1MnCnM.dN0s5oP00Ut', 'Jmq2g1MnCnM.ibTTSMZJhFP', 'Jmq2g1MnCnM.i5K96le4IjS', 'Jmq2g1MnCnM.mG0zgFfA9iY', 'Jmq2g1MnCnM.Rr0iLjh3jMJ', 'Jmq2g1MnCnM.bSTwITmU6dE', 'Jmq2g1MnCnM.o94sqEfZl2w', 'R0QVLANCNA1.uLtet5GVzs3', 'R0QVLANCNA1.dN0s5oP00Ut', 'R0QVLANCNA1.ibTTSMZJhFP', 'R0QVLANCNA1.i5K96le4IjS', 'R0QVLANCNA1.mG0zgFfA9iY', 'R0QVLANCNA1.Rr0iLjh3jMJ', 'R0QVLANCNA1.bSTwITmU6dE', 'R0QVLANCNA1.o94sqEfZl2w', 'gQW7clryzkG.uLtet5GVzs3', 'gQW7clryzkG.dN0s5oP00Ut', 'gQW7clryzkG.ibTTSMZJhFP', 'gQW7clryzkG.i5K96le4IjS', 'gQW7clryzkG.mG0zgFfA9iY', 'gQW7clryzkG.Rr0iLjh3jMJ', 'gQW7clryzkG.bSTwITmU6dE', 'gQW7clryzkG.o94sqEfZl2w', 'WWIx4r2BVzx.uLtet5GVzs3', 'WWIx4r2BVzx.dN0s5oP00Ut', 'WWIx4r2BVzx.ibTTSMZJhFP', 'WWIx4r2BVzx.i5K96le4IjS', 'WWIx4r2BVzx.mG0zgFfA9iY', 'WWIx4r2BVzx.Rr0iLjh3jMJ', 'WWIx4r2BVzx.bSTwITmU6dE', 'WWIx4r2BVzx.o94sqEfZl2w', 'fAeJMBn1u9.uLtet5GVzs3', 'mfAeJMBn1u9.dN0s5oP00Ut', 'mfAeJMBn1u9.ibTTSMZJhFP', 'mfAeJMBn1u9.i5K96le4IjS', 'mfAeJMBn1u9.mG0zgFfA9iY', 'mfAeJMBn1u9.Rr0iLjh3jMJ', 'mfAeJMBn1u9.bSTwITmU6dE', 'mfAeJMBn1u9.o94sqEfZl2w', 'ayYDJPqQ14j.uLtet5GVzs3', 'ayYDJPqQ14j.dN0s5oP00Ut', 'ayYDJPqQ14j.ibTTSMZJhFP', 'ayYDJPqQ14j.i5K96le4IjS', 'ayYDJPqQ14j.mG0zgFfA9iY', 'ayYDJPqQ14j.Rr0iLjh3jMJ', 'ayYDJPqQ14j.bSTwITmU6dE', 'ayYDJPqQ14j.o94sqEfZl2w', 'mX7ZOovkYnS.uLtet5GVzs3', 'mX7ZOovkYnS.dN0s5oP00Ut', 'mX7ZOovkYnS.ibTTSMZJhFP', 'mX7ZOovkYnS.i5K96le4IjS', 'mX7ZOovkYnS.mG0zgFfA9iY', 'mX7ZOovkYnS.Rr0iLjh3jMJ', 'mX7ZOovkYnS.bSTwITmU6dE', 'mX7ZOovkYnS.o94sqEfZl2w', 'T1CDgnil83.uLtet5GVzs3', 'kT1CDgnil83.dN0s5oP00Ut', 'kT1CDgnil83.ibTTSMZJhFP', 'kT1CDgnil83.i5K96le4IjS', 'kT1CDgnil83.mG0zgFfA9iY', 'kT1CDgnil83.Rr0iLjh3jMJ', 'kT1CDgnil83.bSTwITmU6dE', 'kT1CDgnil83.o94sqEfZl2w' ] ; 

		var totalColumnsId = [];
		var totalId = [[],[],[],[],[],[],[],[],[],[],[],[],]
		function td(id, index) {
			let tr = document.getElementById(id).innerHTML;
			let indx = index;
			if(id == "totalRow") {
				for(let i = 1; i < 13; i++) {
					tr += "<td id='" +i+ "' style='width: 64px;  text-align: center; border: 1px solid black;'></td>";
				}
			} else {
				for(let i = 1; i < 13; i++) {
					if (i === 7) {
						tr += "<td id='" + dataElements[indx-6] + "-" + dataElements[indx-2] + 
							  "' style='width: 64px;  text-align: center; border: 1px solid black;'></td>";
						totalColumnsId.push(dataElements[indx-6] + "-" + dataElements[indx-2]);
						totalId[i-1].push(dataElements[indx-6] + "-" + dataElements[indx-2]);
					} else if (i === 8) {
						tr += "<td id='" + dataElements[indx-5] + "-" + dataElements[indx-1] + 
							  "' style='width: 64px;  text-align: center; border: 1px solid black;'></td>";
						totalColumnsId.push(dataElements[indx-5] + "-" + dataElements[indx-1]);
						totalId[i-1].push(dataElements[indx-5] + "-" + dataElements[indx-1]);
					} else if (i === 9) {
						tr += "<td id='" + dataElements[indx-6] + "-" + dataElements[indx-2] + "-" + dataElements[indx-5] + "-" + dataElements[indx-1] + 
							  "' style='width: 64px;  text-align: center; border: 1px solid black;'></td>";
						totalColumnsId.push(dataElements[indx-6] + "-" + dataElements[indx-2] + "-" + dataElements[indx-5] + "-" + dataElements[indx-1]);
						totalId[i-1].push(dataElements[indx-6] + "-" + dataElements[indx-2] + "-" + dataElements[indx-5] + "-" + dataElements[indx-1]);
					} else if (i === 12) {
						tr += "<td id='" + dataElements[indx-2] + "-" + dataElements[indx-1] +
							  "' style='width: 64px;  text-align: center; border: 1px solid black;'></td>";
						totalColumnsId.push(dataElements[indx-2] + "-" + dataElements[indx-1]);
						totalId[i-1].push(dataElements[indx-2] + "-" + dataElements[indx-1]);
					} else {
						tr += "<td id='" + dataElements[indx] + "' style='width: 64px;  text-align: center; border: 1px solid black;'></td>";
						totalId[i-1].push(dataElements[indx]);
						indx++;
					}
				}	
			}
			document.getElementById(id).innerHTML = tr
		}
	</script>
	<style>
		 tbody tr:hover {
			background: rgba(240,240,240,.9);
		}

		.btn {
			display: inline-block;
			padding: 6px 12px;
			margin-bottom: 0;
			font-size: 14px;
			font-weight: 400;
			line-height: 1.42857143;
			text-align: center;
			white-space: nowrap;
			vertical-align: middle;
			-ms-touch-action: manipulation;
			touch-action: manipulation;
			cursor: pointer;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
			background-image: none;
			border: 1px solid transparent;
			border-radius: 4px;
		}
		.btn-primary {
		    color: #fff;
		    background-color: #337ab7;
		    border-color: #2e6da4;
}
		.btn-success {
		    color: #fff;
		    background-color: #5cb85c;
		    border-color: #4cae4c;
		}

		#loading {
		    display: block;
		    position: fixed;
		    z-index: 99999;
		    left: 0;
		    top: 0;
		    width: 100%;
		    height: 100%;
		    overflow: auto;
		    background-color: rgb(0,0,0);
		    background-color: rgba(0,0,0,0.9);
		}

		.loading-content {
			text-align: center;
		    margin: 20% auto;
		    padding: 20px;
		}

		@media print {
			td {
				font-size: 7.7px !important;
			}
			#btnBack, #btnPrint, #btnExport {
				display: none;
			}	
		}
	</style>
	<a id="dlink" style="display:none;"></a>
	<button type="button" id="btnBack" class="btn" style="vertical-align: middle;"
			onclick="location.href='../dhis-web-reports-app/index.html#/generate-report'">⬅ Goto Report Selection Page
	</button>
	<button type="button" id="btnPrint" class="btn btn-primary" style="vertical-align: middle;"
			onclick="window.print()">Print
	</button>
	<button type="button" class="btn btn-success" style="vertical-align: middle;" id="btnExport"
			onclick="tableToExcel('dataTable', 'name', 'CHBIFormNo-3A 2013 NCD.xls')">⬇ Download As Excel
	</button>

	<!-- The Modal -->
	<div id="loading">
		<!-- Modal content -->
		<div class="loading-content">
			<h1>Loading...</h1>
		</div>
	</div>
	
	<table id="dataTable" style="border-collapse: collapse;">
		<thead>
			<tr>
				<td colspan="10"></td>
				<td colspan="4" style="font-weight: bold; text-align: center; border: 1px solid black"><span style="color: red">2013</span> CBHI Form No.</td>
				<td style="font-weight: bold; text-align: center; border: 1px solid black">3-A</td>
			</tr>
			<tr>
				<td colspan="10"></td>
				<td colspan = "5" style="font-weight: bold; text-align: center; border: 1px solid black">Monthly</td>
			</tr>
			<tr>
				<td colspan="15">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="15" style="font-weight: bold; text-align: center;">Monthly Report on Cases and Deaths Due to Non-Communicable Diseases in the State / UT</td>
			</tr>
			<tr>
				<td colspan="15">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="2" >Name of the State/UT:</td>
				<td id="ouname" colspan="3" style="text-align: center; border: 1px solid black"></td>
				<td colspan="4">&nbsp;</td>
				<td colspan="2">Reporting Month & Year:</td>
				<td id="month" colspan="2" style="text-align: center; border: 1px solid black"></td>
				<td id="year" colspan="2" style="text-align: center; border: 1px solid black"></td>
			</tr>
			<tr>
				<td colspan="15">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="5">Total No. of Govt. Secondary, Tertiary & Super Speciality Medical Care Institutions in the State/UT:</td>
				<td colspan="2" style="text-align: center; border: 1px solid black">&nbsp;</td>
				<td colspan="3">&nbsp;</td>
				<td colspan="3">No. of Medical Care Institutions Reported During the Month:</td>
				<td colspan="2" style="text-align: center; border: 1px solid black">&nbsp;</td>
			</tr>
			<tr>
				<td colspan="15">&nbsp;</td>
			</tr>
			<tr>
				<td rowspan="3" style="border: 1px solid black;">S. No.</td>
				<td rowspan="3" style="text-align: center; border: 1px solid black;">Nature/ Group of Non Communicable Diseases</td>
				<td rowspan="4" style="text-align: center; border: 1px solid black;">ICD – 10 Code</td>
				<td colspan="9" style="text-align: center; border: 1px solid black;">New* Patients Reported/ Treated During the Month</td>
				<td colspan="3" rowspan="2" style="text-align: center; border: 1px solid black;">Total Deaths During the Reporting Month</td>
			</tr>
			<tr>
				<td colspan="2" style="text-align: center; border: 1px solid black;">OutPatient (OPD) Cases </td>
				<td colspan="2" style="text-align: center; border: 1px solid black;">In-Patient (IPD) Cases Referred Amongst Out-Patients (OPD)</td>
				<td colspan="2" style="text-align: center; border: 1px solid black;">IPD Cases Reported Direct</td>
				<td colspan="3" style="text-align: center; border: 1px solid black;">Total Cases</td>
			</tr>
			<tr>
				<td style="text-align: center; border: 1px solid black;">M</td>
				<td style="text-align: center; border: 1px solid black;">F</td>
				<td style="text-align: center; border: 1px solid black;">M</td>
				<td style="text-align: center; border: 1px solid black;">F</td>
				<td style="text-align: center; border: 1px solid black;">M</td>
				<td style="text-align: center; border: 1px solid black;">F</td>
				<td style="text-align: center; border: 1px solid black;">M</td>
				<td style="text-align: center; border: 1px solid black;">F</td>
				<td style="text-align: center; border: 1px solid black;">Total</td>
				<td style="text-align: center; border: 1px solid black;">M</td>
				<td style="text-align: center; border: 1px solid black;">F</td>
				<td style="text-align: center; border: 1px solid black;">Total</td>
			</tr>
			<tr>
				<td style="text-align: center; border: 1px solid black;">1</td>
				<td style="text-align: center; border: 1px solid black;">2</td>
				<td style="text-align: center; border: 1px solid black;">3</td>
				<td style="text-align: center; border: 1px solid black;">4</td>
				<td style="text-align: center; border: 1px solid black;">5</td>
				<td style="text-align: center; border: 1px solid black;">6</td>
				<td style="text-align: center; border: 1px solid black;">7</td>
				<td style="text-align: center; border: 1px solid black;">8</td>
				<td style="text-align: center; border: 1px solid black;">9<sub>(3+7)</sub></td>
				<td style="text-align: center; border: 1px solid black;">10<sub>(4+8)</sub></td>
				<td style="text-align: center; border: 1px solid black;">11<sub>(9+10)</sub></td>
				<td style="text-align: center; border: 1px solid black;">12</td>
				<td style="text-align: center; border: 1px solid black;">13</td>
				<td style="text-align: center; border: 1px solid black;">14<sub>(12+13)</sub></td>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="font-weight: bold; border: 1px solid black">1</td>
				<td colspan="14" style="font-weight: bold; border: 1px solid black">Cardio Vascular Deseases</td>
			</tr>
			<tr id="tr1.1">
				<td style="border: 1px solid black">1.1</td>
				<td style="border: 1px solid black; color: red">Rheumatic Fever</td>
				<td style="border: 1px solid black">100 - 102</td>
				<script type="text/javascript">
					td('tr1.1', 0);
				</script>
			</tr>
			<tr id="tr1.2">
				<td style="border: 1px solid black">1.2</td>
				<td style="border: 1px solid black">Hypertension</td>
				<td style="border: 1px solid black">110 - 115</td>
				<script type="text/javascript">
					td('tr1.2', 8);
				</script>
			</tr>
			<tr id="tr1.3">
				<td style="border: 1px solid black">1.3</td>
				<td style="border: 1px solid black">Ischemic Heart Diseases</td>
				<td style="border: 1px solid black">120 - 125</td>
				<script type="text/javascript">
					td('tr1.3', 16);
				</script>
			</tr>
			<tr id="tr1.4">
				<td style="border: 1px solid black">1.4</td>
				<td style="border: 1px solid black; color: red">Congenital Heart Disease</td>
				<td style="border: 1px solid black">Q20 - Q28</td>
				<script type="text/javascript">
					td('tr1.4', 24);
				</script>
			</tr>
			<tr id="tr1.5">
				<td style="border: 1px solid black">1.5</td>
				<td style="border: 1px solid black; color: red">Other Cardio Vascular Diseases</td>
				<td style="border: 1px solid black">105-109,126-152,170-199</td>
				<script type="text/javascript">
					td('tr1.5', 32);
				</script>
			</tr>
			<tr>
				<td style="font-weight: bold; border: 1px solid black">2</td>
				<td colspan="14" style="font-weight: bold; border: 1px solid black">Neurological Disorders</td>
			</tr>
			<tr id="tr2.1">
				<td style="border: 1px solid black">2.1</td>
				<td style="border: 1px solid black">Cerebro Vascular Accident</td>
				<td style="border: 1px solid black">160 - 169</td>
				<script type="text/javascript">
					td('tr2.1', 40);
				</script>
			</tr>
			<tr id="tr2.2">
				<td style="border: 1px solid black">2.2</td>
				<td style="border: 1px solid black; color: red">Chronic Neurological Disorder</td>
				<td style="border: 1px solid black">G90 - G99</td>
				<script type="text/javascript">
					td('tr2.2', 48);
				</script>
			</tr>
			<tr id="tr2.3">
				<td style="border: 1px solid black">2.3</td>
				<td style="border: 1px solid black">Other Neurological Disorders**</td>
				<td style="border: 1px solid black">F00-03, G00-G83</td>
				<script type="text/javascript">
					td('tr2.3', 56);
				</script>
			</tr>
			<tr>
				<td style="font-weight: bold; border: 1px solid black">3</td>
				<td colspan="14" style="font-weight: bold; border: 1px solid black">Diabetes Mellitus</td>
			</tr>
			<tr id="tr3.1">
				<td style="border: 1px solid black">3.1</td>
				<td style="border: 1px solid black">Type 1</td>
				<td style="border: 1px solid black">E 10</td>
				<script type="text/javascript">
					td('tr3.1', 64);
				</script>
			</tr>
			<tr id="tr3.2">
				<td style="border: 1px solid black">3.2</td>
				<td style="border: 1px solid black">Type 2</td>
				<td style="border: 1px solid black">E 11</td>
				<script type="text/javascript">
					td('tr3.2', 72);
				</script>
			</tr>
			<tr>
				<td style="font-weight: bold; border: 1px solid black">4</td>
				<td colspan="14" style="font-weight: bold; border: 1px solid black">Lungs Disease</td>
			</tr>
			<tr id="tr4.1">
				<td style="border: 1px solid black">4.1</td>
				<td style="border: 1px solid black">Bronchitis</td>
				<td style="border: 1px solid black">J 40</td>
				<script type="text/javascript">
					td('tr4.1', 80);
				</script>
			</tr>
			<tr id="tr4.2">
				<td style="border: 1px solid black">4.2</td>
				<td style="border: 1px solid black">Emphysemas</td>
				<td style="border: 1px solid black">J 43</td>
				<script type="text/javascript">
					td('tr4.2', 88);
				</script>
			</tr>
			<tr id="tr4.3">
				<td style="border: 1px solid black">4.3</td>
				<td style="border: 1px solid black">Asthma</td>
				<td style="border: 1px solid black">J 45</td>
				<script type="text/javascript">
					td('tr4.3', 96);
				</script>
			</tr>
			<tr>
				<td style="font-weight: bold; border: 1px solid black">5</td>
				<td colspan="14" style="font-weight: bold; border: 1px solid black">Psychiatric Disorder</td>
			</tr>
			<tr id="tr5.1">
				<td style="border: 1px solid black">5.1</td>
				<td style="border: 1px solid black">Common Mental Disorders</td>
				<td style="border: 1px solid black">F10 - F19</td>
				<script type="text/javascript">
					td('tr5.1', 104);
				</script>
			</tr>
			<tr id="tr5.2">
				<td style="border: 1px solid black">5.2</td>
				<td style="border: 1px solid black">Severe Mental Disorders</td>
				<td style="border: 1px solid black">F99</td>
				<script type="text/javascript">
					td('tr5.2', 112);
				</script>
			</tr>
			<tr id="tr6">
				<td style="font-weight: bold; border: 1px solid black">6</td>
				<td style="font-weight: bold; border: 1px solid black">Accidental Injusries</td>
				<td>S00-S99, T00-T14</td>
				<script type="text/javascript">
					td('tr6', 120);
				</script>
			</tr>
			<tr>
				<td style="font-weight: bold; border: 1px solid black">7</td>
				<td colspan="14" style="font-weight: bold; border: 1px solid black">Cancer (Malignant & Benign)</td>
			</tr>
			<tr id="tr7.1">
				<td style="border: 1px solid black">7.1</td>
				<td style="border: 1px solid black; color: red">Cervix Cancer</td>
				<td style="border: 1px solid black">C53, D26</td>
				<script type="text/javascript">
					td('tr7.1', 128);
				</script>
			</tr>
			<tr id="tr7.2">
				<td style="border: 1px solid black">7.2</td>
				<td style="border: 1px solid black; color: red">Breast Cancer</td>
				<td style="border: 1px solid black">C50 & D24</td>
				<script type="text/javascript">
					td('tr7.2', 136);
				</script>
			</tr>
			<tr id="tr7.3">
				<td style="border: 1px solid black">7.3</td>
				<td style="border: 1px solid black; color: red">Lung Cancer</td>
				<td style="border: 1px solid black">C34, D14.3</td>
				<script type="text/javascript">
					td('tr7.3', 144);
				</script>
			</tr>
			<tr id="tr7.4">
				<td style="border: 1px solid black">7.4</td>
				<td style="border: 1px solid black; color: red">Oral Cancer (Lip, Oral Cavity and Pharynx)</td>
				<td style="border: 1px solid black">C00 - C14, D10</td>
				<script type="text/javascript">
					td('tr7.4', 152);
				</script>
			</tr>
			<tr id="tr7.5">
				<td style="border: 1px solid black">7.5</td>
				<td style="border: 1px solid black; color: red">Other Cancers(excluding 7.1 to 7.4)</td>
				<td style="border: 1px solid black">C00-D48</td>
				<script type="text/javascript">
					td('tr7.5', 160);
				</script>
			</tr>
			<tr id="tr8">
				<td style="font-weight: bold; border: 1px solid black">8</td>
				<td style="font-weight: bold; border: 1px solid black">Snake Bite</td>
				<td>T 63.0</td>
				<script type="text/javascript">
					td('tr8', 168)
				</script>
			</tr>
			<tr>
				<td style="font-weight: bold; border: 1px solid black">9</td>
				<td colspan="14" style="font-weight: bold; border: 1px solid black">Renal Failure</td>
			</tr>
			<tr id="tr9.1">
				<td style="border: 1px solid black">9.1</td>
				<td style="border: 1px solid black">Acute Renal Failure</td>
				<td style="border: 1px solid black">N 17</td>
				<script type="text/javascript">
					td('tr9.1', 176);
				</script>
			</tr>
			<tr id="tr9.2">
				<td style="border: 1px solid black">9.2</td>
				<td style="border: 1px solid black">Chronic Renal Failure</td>
				<td style="border: 1px solid black">N 18</td>
				<script type="text/javascript">
					td('tr9.2', 184);
				</script>
			</tr>
			<tr id="tr10">
				<td style="font-weight: bold; border: 1px solid black">10</td>
				<td style="font-weight: bold; border: 1px solid black">Obesity</td>
				<td style="border: 1px solid black">E66</td>
				<script type="text/javascript">
					td('tr10', 192);
				</script>
			</tr>
			<tr id="tr11">
				<td style="font-weight: bold; border: 1px solid black">11</td>
				<td style="font-weight: bold; border: 1px solid black">Road Traffic Accidents</td>
				<td>V01 - V89</td>
				<script type="text/javascript">
					td('tr11', 200);
				</script>
			</tr>
			<tr id="totalRow">
				<td style="border: 1px solid black">&nbsp;</td>
				<td colspan="2" style="font-weight: bold; border: 1px solid black">TOTAL</td>
				<script type="text/javascript">
					td('totalRow', 0);
				</script>
			</tr>
		</tbody>
		<tfoot>
			<tr>
				<td colspan="7">M - Male, F - Female, T - Total</td>
				<td colspan="8">** - Other Neurological disorders like Epilepsy, Parkinson's Diseases</td>
			</tr>
			<tr>
				<td colspan="15">* - New Registrations are to be considered as New Patients.</td>
			</tr>
			<tr>
				<td colspan="15" style="font-weight: bold">This Monthly Report should be communicated Online <span style="color: blue; text-decoration: underline;">www.cbhidghs.nic.in</span> to CBHI positively by 20th of the succeeding month. In case it is not at all possible for Online data transmission, then send through e-mail- <span style="color: blue; text-decoration: underline; background: yellow">dircbhi@nic.in</span> OR Fax 011 – 23061529/23063175 to CBHI by 20th of succeeding month <span style="color: red">only by Dte.HS HQ.</span></td>
			</tr>
			<tr>
				<td colspan="9"></td>
				<td colspan="3">Signature</td>
				<td colspan="3" style="border: 1px solid black"></td>
			</tr>
			<tr>
				<td colspan="9"></td>
				<td colspan="3">Name & Designation</td>
				<td colspan="3" style="border: 1px solid black"></td>
			</tr>
			<tr>
				<td colspan="9"></td>
				<td colspan="3">Address with telephone No./e-mail</td>
				<td colspan="3" style="border: 1px solid black"></td>
			</tr>
		</tfoot>
	</table>

<script type="text/javascript">
	const orgUnit = dhis2.report.organisationUnit;
	const periods = dhis2.report.periods;
    const period = periods[0];
    const year = period.substring(0, 4);
    const month = getPeriod(period);
    document.getElementById('ouname').innerHTML = orgUnit.name;
    document.getElementById('month').innerHTML = month;
    document.getElementById('year').innerHTML = year;

	let url = '../api/26/analytics.json?dimension=dx:';

	for (let i = 0; i < dataElements.length; i++) {
		url += dataElements[i] + ';';
	}
	url += '&dimension=pe:' + period + '&filter=ou:' + orgUnit.id;

	$.get(url).then(function(result) {
		document.getElementById("loading").style.display = "none"; // Hide Loading

		const rows = result.rows;
		const sortedDataElements = dataElements.slice(0).sort(function(a,b){
			return a.localeCompare(b)
		});

		for(let row of rows) {
			binarySearch(sortedDataElements, row);
		}

		for(let id of totalColumnsId) {
			const splitId = id.split('-');
			if(splitId.length === 2) {
				let value1 = document.getElementById(splitId[0]).innerHTML;
				let value2 = document.getElementById(splitId[1]).innerHTML;
				if (value1 == "" && value2 == "") {
					document.getElementById(id).innerHTML = "";
				} else if(value1 == "") {
					document.getElementById(id).innerHTML = value2;
				} else if(value2 == "") {
					document.getElementById(id).innerHTML = value1;
				} else {
					document.getElementById(id).innerHTML = parseInt(value1) + parseInt(value2);
				}
			} else {
				let value3 = document.getElementById(splitId[0]).innerHTML;
				let value4 = document.getElementById(splitId[1]).innerHTML;
				let value5 = document.getElementById(splitId[2]).innerHTML;
				let value6 = document.getElementById(splitId[3]).innerHTML;
				let value7 = 0;
				if (value3 == "" && value4 == "" && value5 == "" && value6 == "") {
					document.getElementById(id).innerHTML = "";
				} else {
					if(value3 != "") {
						value7 += parseInt(value3);
					}
					if(value4 != "") {
						value7 += parseInt(value4);
					}
					if(value5 != "") {
						value7 += parseInt(value5);
					}
					if(value6 != "") {
						value7 += parseInt(value6);
					}
					document.getElementById(id).innerHTML = value7; 
				} 
			}
		}

		for (let j =1; j < 13; j++) {
			let value1 = 0;
			for (let k = 0; k < totalId[j-1].length; k++) {
				let value = document.getElementById(totalId[j-1][k]).innerHTML;
				value1 += (value != "") ? parseInt(value) : 0;
			}
			document.getElementById(j).innerHTML = value1;
		}

	});

	function binarySearch(a, i) {
        const mid = Math.floor(a.length / 2);
        
        if (a[mid] === i[0]) {
        	document.getElementById(a[mid]).innerHTML = parseInt(i[2]);
        } else if (i[0].localeCompare(a[mid]) < 0 && a.length > 1) {
        	binarySearch(a.slice(0, mid), i);
        } else if (i[0].localeCompare(a[mid]) >= 1 && a.length > 1) {
        	binarySearch(a.slice(mid, a.length), i);
        } else {
            return;
        }
    }

    function getPeriod(pr) {
        const month = parseInt(pr.substring(4, 6)) - 1;
        const monthsName = ["January","February","March","April","May","June","July","August","September","October","November","December"];
        return monthsName[month];
    }

    var tableToExcel = (function () {
        var uri = 'data:application/vnd.ms-excel;base64,'
            , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
            , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
            , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (table, name, filename) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

            document.getElementById("dlink").href = uri + base64(format(template, ctx));
            document.getElementById("dlink").download = filename;
            document.getElementById("dlink").click();

        }
    })()

    
</script>