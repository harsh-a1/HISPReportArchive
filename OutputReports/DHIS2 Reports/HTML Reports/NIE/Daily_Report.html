
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
   
    <script type="text/javascript" src="../dhis-web-commons/bootstrap/js/bootstrap.min.js"></script>
    <link type="text/css" rel="stylesheet"  href="../dhis-web-commons/bootstrap/css/bootstrap.min.css">

    <link rel="stylesheet" href="../dhis-web-commons/javascripts/jQuery/ui/css/redmond/jquery-ui.css">
    <script type="text/javascript" src="../dhis-web-commons/javascripts/jQuery/ui/jquery-ui.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
	<script>$(document).ready(function() {
  $.ajaxSetup({ cache: false });
});</script>
    <style>
        table tr td {
            text-align:left;
        }
        .righta{
            text-align:right;
        }
        .centa{
            text-align:center;
        }

        .datedivmng{
            float: left;position: relative;
        }
        .datedivmng .datepicker{
            position: relative;width: 87%!important;
            cursor: pointer;
        }
        .datedivmng:after {
            /* symbol for "opening" panels */
            font-family: 'FontAwesome';
            content: "\f073";
            color: #329ac4;
            font-size: 16px;
            text-shadow: none;
            position: absolute;
            vertical-align: middle;
            pointer-events: none;
            float: right;
            top: 2px;
            right: 7px;
        }
    </style>
  <style type="text/css" href="../api/documents/IlCodOSjSxY/data" media="print">
        @media print {
            .notPrint {
                display: none;
            }
            #printing {
                display: block;
            }
            @page {
                size: A4 landscape;
                max-height: 100%;
                max-width: 100%
            }
          
        }
    </style>

    <style>
        /* Center the loader */
        #loader {
            position: absolute;
            left: 50%;
            top: 50%;
            z-index:3;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }
        

        @-webkit-keyframes spin {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
       

        p {
            text-align: center;
        }
        .btn{
            border-color:darkgray;
            border-style: solid;
            border-width: 1px;
            background-color: white !important;
            color: black !important;
            cursor:pointer;
        }
        #dr1_fever, #dr1_fever1, #dr2_lab{
            font-size: 20px;
        }
        .hiddenrow{
            display:none;
        }
    </style>

</head>

<body>

<div id="loader" class="loader"></div>

<div class="notPrint">
    <div style="margin-left: 30%"><div class="datedivmng"><b>Start Date : </b>
    <input type="text" id="start" name="start" value="" placeholder="dd-mm-yyyy"/></div>
    <div class="datedivmng"><input type="checkbox" id ="checkit" onclick="checkfunction()" checked> <b>End Date :</b>
        <input type="text" id="end" name="end" value="" placeholder="dd-mm-yyyy" disabled required /></div></div><br><br>
</div>
<div style="text-align: center" class="notPrint">
    <button class="btn" onClick="generate(1);" id="dr1add">Daily Report 1-ADD</button>
    &nbsp;
    <button class="btn" onClick="generate(2);" id="dr1afi">Daily Report 1-AFI</button>
    &nbsp;
    <button class="btn" onClick="generate(3);" id="dr2">Daily Report 2 LAB</button><br><br>

    <button id="export1" class="btn" value="Download as Excel(DR1 ADD)" onClick="exportExcel_dr1add()">Download as Excel(DR1 ADD)</button>
    &nbsp;
    <button id="export2" class="btn" value="Download as Excel(DR1 AFI)" onClick="exportExcel_dr1afi()">Download as Excel(DR1 AFI)</button>
    &nbsp;
    <button id="export3" class="btn" value="Download as Excel(DR2 Lab)" onClick="exportExcel_dr2lab()">Download as Excel(DR2 Lab)</button>
</div>
<div id="printing">
    <br>
    <p class="heading" id="dr1_fever"><strong>Daily  Report - I - ADD</strong></p>
    <p class="heading" id="dr1_fever1"><strong>Daily  Report - I - AFI</strong></p>
    <p class="heading" id="dr2_lab"><strong>Daily  Report 2</strong></p>
    <p style="text-align: left;display: inline" id="datedisplay">Start Date:</p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<p style="text-align: left;display: inline" id="datedisplay1">End Date:</p>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<p style="text-align: center;display: inline" id="orgunitdisplay"><strong>OrgUnit:</strong></p>

    <table class="table table-hover table-bordered table_fever table_fever"  id="fever_table">
        <thead>
        <tr style='border:1px solid black' style="text-align:center">
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>S.No.</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Date of Admission</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Guardian</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Age(in years)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Gender (M/F)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Address</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Village</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>HSC</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>PHC</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the block</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the HUD</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the District</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Contact Number</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Probable Diagnosis</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of Hospital/organisation</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Remarks if any</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>Village code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>HSC code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>PHC code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>Block code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>HUD code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>District code</b></th></tr>
        </thead>
    </table>
    <table  class="table  table-hover table-bordered table_lab" id="lab_table">
        <thead>
        <tr style='border:1px solid black'style="text-align:center">
                <th id = 'tablerows' colspan='1' style="color: #000000"><b>S.No.</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Date of Admission</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Guardian</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Age(in years)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Gender (M/F)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Address</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Village</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>HSC</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>PHC</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the block</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the HUD</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the District</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Contact Number</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Lab Confirmed Diagnosis</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of Hospital/organisation</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Remarks if any</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>Village code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>HSC code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>PHC code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>Block code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>HUD code</b></th>
            <th id = 'tablerowsh' class = 'hiddenrow' colspan='1' style="color: #000000"><b>District code</b></th></tr>
        </thead>
    </table>
    <div style="display:flex">
        <p style="padding-right:50%" id="footer1"> Supported by GHSA Project, ICMR-NIE, Chennai-77</p>
        <p id="footer2"> Facilitated by DPH and PM, Chennai-06</p>
        </div>
</div>
<script>
    $("#start").datepicker({
        dateFormat: 'dd-mm-yy',
        changeMonth: true
       });
       $("#end").datepicker({
        dateFormat: 'dd-mm-yy',
        changeMonth: true
        });
</script>
<script type="text/javascript">
  
var startDate="",endDate="";
   var flag=0;
    $( document ).ready(function() {
        var today = new Date();
var dd = ("0" + (today.getDate())).slice(-2);
var mm = ("0" + (today.getMonth() +　1)).slice(-2);
var yyyy = today.getFullYear();
today = dd + '-' + mm + '-' + yyyy ;
document.getElementById('start').value = today;
        document.getElementById("loader").style.display = "none";
        document.getElementById("export2").disabled = true;
        document.getElementById("export1").disabled = true;
        document.getElementById("export3").disabled = true;
        $('.table_fever').hide();
        $('.table_lab').hide();
        $('#datedisplay').hide();
        $('#datedisplay1').hide();
        $('#orgunitdisplay').hide();
        $('#dr1_fever').hide();
        $('#dr1_fever1').hide();
        $('#dr2_lab').hide();
        $('#footer1').hide();
        $('#footer2').hide();
		
		var url = window.location.href;
		var arrayUrl = url.split('&');
		if(arrayUrl.length >2){
		var arraySDate = arrayUrl[2] ;
		 startDate = arraySDate.split('=')[1];
		var arrayEDate = arrayUrl[3];
		 endDate = arrayEDate.split('=')[1];
		var arrayType = arrayUrl[4];
		var type = arrayType.split('=')[1];
		flag = 2;
			generate(type);
		
		}
//
//            fever_table.Visible=false;
//            lab_table.Visible=false;

    });
	
	  var checkfunction = function(){
        if($('input:checkbox').is(':checked')){
            document.getElementById("end").disabled = true;
        }
        else{
            document.getElementById("end").disabled = false;
        }
    };
	var generate = function(selection){
	
				  
    var urlApi;
    var add_afi=[],add_aff=[],daily_ip=[],daily_op=[],daily_lab=[],village=[],hud=[],block=[],districtu=[],habitationu=[],gaurdian=[],remarks=[];
	var dateofAdd=[],patientname=[],age=[],sex=[],guardian=[],street1=[],street2=[],district=[],phc=[],hsc=[];
    var villagecode=[],hsccode=[],phccode=[],blockcode=[],hudcode=[],districtcode=[];
    var url = window.location.href;
    var ouu = url.split('=')[2],ouname;
   var ou = ouu.split('&')[0]
   var json,length;
   var addcount=1;
     var oulevel,oulevel_name;
	var lab_positive="Positive",lab_diagnosis=[],lab_diagnosis_string=[];
        var org_ghuid;
        var hospital=[],contactnumber=[],diagnosis=[],nameofhospital,remarks=[];
	
  
	
    function callApis(selection)
    {	
		if(flag!=2){
		startDate = document.getElementById("start").value;
        startDate = startDate.split("-").reverse().join("-");

        if($('input:checkbox').is(':checked')){

		endDate = startDate.substring(0,8)+(Number(startDate.substring(8,10)) + 1);
		flag = 1;

            
        }
        else{
            endDate = document.getElementById("end").value;
            endDate = endDate.split("-").reverse().join("-");
           
        }
		}
		
        document.getElementById("export2").disabled = true;
        document.getElementById("export1").disabled = true;
        document.getElementById("export3").disabled = true;
//        showLoader();

 $('.table_fever tbody').remove();
        $('.table_fever tbody').detach();
        $('#dr2_lab').hide();
        $('#datedisplay').show();
        $('#datedisplay1').show();
        $('#orgunitdisplay').show();
        $('#dr1_fever').hide();
		 $('#dr1_fever1').hide();
        $('#footer1').show();
        $('#footer2').show();
      

        $.getJSON("../api/organisationUnits/"+ou+".json", function(data1){
	$("#loader").show();
            ouname=data1.displayName;
            oulevel=data1.level;

            $.getJSON("../api/organisationUnitLevels?fields=level,name", function(data2) {

                $.each(data2.organisationUnitLevels, function (index, item) {
                    if(item.level==oulevel)
                    {
                        oulevel_name=item.name;
                    }
                });
                document.getElementById("orgunitdisplay").innerHTML="Facility: "+ouname +" "+oulevel_name;
          


        

       document.getElementById("datedisplay").innerHTML="Start Date:"+ startDate.split('-').reverse().join('-');
				if(endDate ==null)
				{
				endDate ="-";
				}
                document.getElementById("datedisplay1").innerHTML="End Date:"+ endDate.split('-').reverse().join('-');

//        $.getJSON("../api/events.json?orgUnit="+ou+"&program=Ml0ZNj9APN0&ouMode=DESCENDANTS&startDate="+startDate+"&endDate="+endDate+"&skipPaging=true&order=eventDate:desc", function(data){
//        $.getJSON("../api/sqlViews/aABHZ3xSINW/data.json?var=startDate:"+startDate+"&var=endDate:"+endDate+"&var=syndrome:ADD", function(data){


		
     
						if(selection == 1){
                            $.getJSON("../api/sqlViews/aABHZ3xSINW/data.json?var=startDate:"+startDate+"&var=endDate:"+endDate+"&var=syndrome:ADD", function(data) {
                                length = data.rows.length;
                                saveData(data, 0);
                                printDate1(length, 0);
                                document.getElementById("export1").disabled = false;
                                $('.table_fever').show();
                                $('.table_lab').hide();
                                $('#dr1_fever').show();
                            });
						}
						else if(selection == 2){
                            $.getJSON("../api/sqlViews/aABHZ3xSINW/data.json?var=startDate:"+startDate+"&var=endDate:"+endDate+"&var=syndrome:AFI", function(data) {
                                length = data.rows.length;
                                saveData(data,0);
							printDate2(length,0);
							document.getElementById("export2").disabled = false;
                                $('.table_fever').show();
                                $('.table_lab').hide();
							 $('#dr1_fever1').show();
                            });
						}
						else{
                            $.getJSON("../api/sqlViews/YD92a2cONvA/data.json?var=startDate:"+startDate+"&var=endDate:"+endDate, function(data) {
                                length = data.rows.length;

                                saveDataLab(data,0);
							printDate3(length,0);
							document.getElementById("export3").disabled = false;
                                $('.table_fever').hide();
                                $('.table_lab').show();
							$('#dr2_lab').show();
                            });
						}    


			$("#hidden1").show();
			$("#hidden2").show();       

	   });
		
  });

//        });
     

    }
			var saveData = function(data,p){
			if(p>=data.rows.length){
			return;}
			else{
					 json =  data.rows[p];

                    for(var p=0;p<data.rows.length;p++)
                    {
                        var dateof=data.rows[p][1].substring(0,10);

//                        console.log("--",(data.rows[p][1].substring(0,10)).split('-').reverse().join('-'));
                            dateofAdd.push(data.rows[p][1].substring(0,10));
//                            dateofAdd.push((data.rows[p][1].substring(0,10)).split('-').reverse().join('-'));
                            //Basic_Information/Name
                            patientname.push(data.rows[p][2]);
                            //Age in years
                            age.push(data.rows[p][4]);
                            //Gender
                            sex.push(data.rows[p][5]);
                            //Gaurdian
                        guardian.push(data.rows[p][6]);
                            //Street_Information/Street
                            street1.push(data.rows[p][7]);
                            //Street_Information/Pincode
                            street2.push(data.rows[p][8]);
                            //District
                            districtu.push(data.rows[p][14]);
                           habitationu.push(data.rows[p][9].replace(/[^A-Za-z]+/g, ''));
                            //Village
                           village.push(data.rows[p][11]);
                           //block
                           block.push(data.rows[p][12]);
                           //hud
                           hud.push(data.rows[p][13]);
                           //contact
                        contactnumber.push(data.rows[p][15]);
                        diagnosis.push(data.rows[p][16]);
                        //GH
                hospital.push((data.rows[p][17]).split("-")[1]);
                phc.push(data.rows[p][19]);
                hsc.push(data.rows[p][20]);
                        //remarks
                        remarks.push(data.rows[p][18]);

                        //codes mapping
                        villagecode.push(data.rows[p][21]);
                        hsccode.push(data.rows[p][22]);
                        phccode.push(data.rows[p][23]);
                        blockcode.push(data.rows[p][24]);
                        hudcode.push(data.rows[p][25]);
                        districtcode.push(data.rows[p][26]);
                    }

						if(dateofAdd[p]==null)
                        {
                            dateofAdd[p]="-";
                        }
						if(patientname[p]==null)
                        {
                            patientname[p]="-";
                        }
						if(age[p]==null)
                        {
                            age[p]="-";
                        }
						if(sex[p]==null)
                        {
                            sex[p]="-";
                        }

                if(!hospital[p])
                {
                    hospital[p]="-";
                }

                        if(street1[p]==null)
                        {
                            street1[p]="-";
                        }
						if(habitationu[p]==null)
                        {
                            habitationu[p]="-";
                        }
						if(village[p]==null)
                        {
                            village[p]="-";
                        }
						if(hud[p]==null)
                        {
                            hud[p]="-";
                        }
						if(block[p]==null)
                        {
                            block[p]="-";
                        }
						if(districtu[p]==null)
                        {
                            districtu[p]="-";
                        }
						if(hsc[p]==null)
                        {
                            hsc[p]="-";
                        }
						if(phc[p]==null)
                        {
                            phc[p]="-";
                        }

						saveData(data, p+1);
}
			};
	
			var saveDataLab = function(data,p){
			if(p>=data.rows.length){
			return;}
			else {
                for(var p=0;p<data.rows.length;p++)
                {

                dateofAdd.push(data.rows[p][3]);
                //Basic_Information/Name
                patientname.push(data.rows[p][2]);
                //Age in years
                age.push(data.rows[p][4]);
                //Gender
                sex.push(data.rows[p][5]);
                //Gaurdian
                guardian.push(data.rows[p][6]);
                //Street_Information/Street
                street1.push(data.rows[p][7]);
                //Street_Information/Pincode
                street2.push(data.rows[p][8]);
                //District
                districtu.push(data.rows[p][13]);
                habitationu.push(data.rows[p][9].replace(/[^A-Za-z]+/g, ''));
                //Village
                village.push(data.rows[p][11]);
                //block
                block.push(data.rows[p][12]);
                //hud
                hud.push(data.rows[p][13]);
                //district
                contactnumber.push(data.rows[p][15]);

                if (data.rows[p][16].includes("Dengue")) {
                    diagnosis.push("Dengue");
                }
                if (data.rows[p][17].includes("Malaria")) {
                    diagnosis.push("Malaria");
                }
                if (data.rows[p][18].includes("Lepto")) {
                    diagnosis.push("Leptosprirosis");
                }
                if (data.rows[p][19].includes("scrub_typhus")) {
                    diagnosis.push("scrub_typhus");
                }

                //GH
                hospital.push((data.rows[p][20]).split("-")[1]);
                phc.push(data.rows[p][22]);
                hsc.push(data.rows[p][23]);
                //remarks
                remarks.push(data.rows[p][21]);

                    //codes mapping
                        villagecode.push(data.rows[p][24]);
                        hsccode.push(data.rows[p][25]);
                        phccode.push(data.rows[p][26]);
                        blockcode.push(data.rows[p][27]);
                        hudcode.push(data.rows[p][28]);
                        districtcode.push(data.rows[p][29]);
            }
                    }



               
						if(dateofAdd[p]==null)
                        {
                            dateofAdd[p]="-";
                        }
						if(patientname[p]==null)
                        {
                            patientname[p]="-";
                        }
						if(age[p]==null)
                        {
                            age[p]="-";
                        }
						if(sex[p]==null)
                        {
                            sex[p]="-";
                        }
                if(!hospital[p])
                {
                    hospital[p]="-";
                }
                        if(street1[p]==null)
                        {
                            street1[p]="-";
                        }
						if(habitationu[p]==null)
                        {
                            habitationu[p]="-";
                        }
						if(village[p]==null)
                        {
                            village[p]="-";
                        }
						if(hud[p]==null)
                        {
                            hud[p]="-";
                        }
						if(block[p]==null)
                        {
                            block[p]="-";
                        }
						if(districtu[p]==null)
                        {
                            districtu[p]="-";
                        }if(hsc[p]==null)
                        {
                            hsc[p]="-";
                        }if(phc[p]==null)
                        {
                            phc[p]="-";
                        }
						saveDataLab(data, p+1);
}

	
	
	
	
			var printDate1 = function(i,p){
				if(p>=i){
				$("#loader").hide();
				return;}
				else{
				
				if(flag==1){
				var dateNew = dateofAdd[p].substring(0,10);
					if(dateNew != startDate){}
					else{
						var row = $("<tbody><tr><td  id = 'tablerowsh' class='centa' colspan='1' id='td'>" + addcount  + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + (dateofAdd[p].substring(0,10)).split('-').reverse().join('-') + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + guardian[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + age[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + village[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hsc[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + phc[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + block[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hud[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='righta' id='td'>" + contactnumber[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='centa' id='td'>ADD</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + remarks[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + villagecode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hsccode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + phccode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + blockcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hudcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + districtcode[p] + "</td></tr></tbody>");
                        $(".table_fever").append(row);
                        addcount++;
					}
				
				}
				else{
				
				
                        var row = $("<tbody><tr><td  id = 'tablerowsh' class='centa' colspan='1' id='td'>" + addcount  + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + (dateofAdd[p].substring(0,10)).split('-').reverse().join('-') + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + guardian[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + age[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + village[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hsc[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + phc[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + block[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hud[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='righta' id='td'>" + contactnumber[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='centa' id='td'>ADD</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + remarks[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + villagecode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hsccode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + phccode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + blockcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hudcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + districtcode[p] + "</td></tr></tbody>");
                        $(".table_fever").append(row);
                        addcount++;
					}
					}
					printDate1(i,p+1)
				};

			var printDate2 = function(i,p){
			json2= dateofAdd;
				if(p>=i){
				$("#loader").hide();
				return;}
				else{
                   
					if(flag==1){
				var dateNew = dateofAdd[p].substring(0,10);
					if(dateNew != startDate){}
					else{
						var row = $("<tbody><tr><td  id = 'tablerowsh' class='centa' colspan='1' id='td'>" + addcount  + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + (dateofAdd[p].substring(0,10)).split('-').reverse().join('-') + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + guardian[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + age[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + village[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hsc[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + phc[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + block[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hud[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='righta' id='td'>" + contactnumber[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='centa' id='td'>ADD</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + remarks[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + villagecode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hsccode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + phccode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + blockcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hudcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + districtcode[p] + "</td></tr></tbody>");
                        $(".table_fever").append(row);
                        addcount++;
					}
				
				}
				else{
				

				   var row = $("<tbody><tr><td  id = 'tablerowsh' class='centa' colspan='1' id='td'>" + addcount  + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + (dateofAdd[p].substring(0,10)).split('-').reverse().join('-') + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + guardian[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + age[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + village[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hsc[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + phc[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + block[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hud[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' class='righta' id='td'>" + contactnumber[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' class='centa' id='td'>AFI</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + remarks[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + villagecode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hsccode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + phccode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + blockcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hudcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + districtcode[p] + "</td></tr></tbody>");
                        $(".table_fever").append(row);
                        addcount++;
					}
}				
				printDate2(i,p+1)
				};
			var printDate3 = function(i,p){
				if(p>=i){
				$("#loader").hide();
				return;}
				else{
                   
				if(flag==1){
				var dateNew = dateofAdd[p].substring(0,10);
					if(dateNew != startDate){}
					else{
						var row = $("<tbody><tr><td  id = 'tablerowsh' class='centa' colspan='1' id='td'>" + addcount  + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + (dateofAdd[p].substring(0,10)).split('-').reverse().join('-') + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + guardian[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + age[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + village[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hsc[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + phc[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + block[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hud[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='righta' id='td'>" + contactnumber[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' class='centa' id='td'>"+diagnosis[p]+"</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + remarks[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + villagecode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hsccode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + phccode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + blockcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hudcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + districtcode[p] + "</td></tr></tbody>");
                        $(".table_lab").append(row);
                        addcount++;
					}
				
				}
				else{
				
				
				   var row = $("<tbody><tr><td  id = 'tablerowsh' class='centa' colspan='1' id='td'>" + addcount  + "</td>" +
                            "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + (dateofAdd[p].substring(0,10)).split('-').reverse().join('-') + "</td>" +
                            "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                            "<td id = 'tablerowsh' colspan='1' id='td'>" + guardian[p] + "</td>" +
                            "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + age[p] + "</td>" +
                            "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                            "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                            "<td id = 'tablerowsh' colspan='1' id='td'>" + village[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hsc[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + phc[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + block[p] + "</td>" +
                                "<td id = 'tablerowsh' colspan='1' id='td'>" + hud[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu[p] + "</td>" +
                            "<td  id = 'tablerowsh' colspan='1' class='righta' id='td'>" + contactnumber[p] + "</td>" +
                            "<td  id = 'tablerowsh' colspan='1' id='td'>" + diagnosis[p] +"</td>" +
                            "<td id = 'tablerowsh' colspan='1' class='centa' id='td'>" + hospital[p] + "</td>" +
                                "<td  id = 'tablerowsh' colspan='1' id='td'>" + remarks[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + villagecode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hsccode[p] + "</td>"+
                                "<td id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + phccode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow'colspan='1' id='td'>" + blockcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + hudcode[p] + "</td>"+
                                "<td  id = 'tablerowsh' class = 'hiddenrow' colspan='1' id='td'>" + districtcode[p] + "</td></tr></tbody>");
                        $(".table_lab").append(row);
                        addcount++;
					}
					}
					printDate3(i,p+1)
			};

			
			callApis(selection);
			};
  



</script>
<script type="text/javascript">

    function exportExcel_dr1add(e) {
    //   $('.hiddenrow').show();
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementsByClassName('table_fever')[0];
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'Daily Report ADD.xls';
        a.click();
        e.preventDefault();
    }
    function exportExcel_dr1afi(e) {
    //   $('.hiddenrow').show();
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementsByClassName('table_fever')[0];
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'Daily Report AFI.xls';
        a.click();
        e.preventDefault();
    }
 function exportExcel_dr2lab(e) {
    //   $('.hiddenrow').show();
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementsByClassName('table_lab')[0];
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'Daily Report2 Lab.xls';
        a.click();
        e.preventDefault();
    }

</script>
</body>

</html>
</div>          </div>
    <script type="text/javascript">
        </script>

    <div id="rightBar">
      <span id="hideRightBar"><a href="javascript:hideHelpContent()" title="Close">
        <i class="fa fa-times leftBarIcon"></i></a>
      </span>
      <div id="rightBarContents"></div>
    </div>

    


  </body>
</html>
