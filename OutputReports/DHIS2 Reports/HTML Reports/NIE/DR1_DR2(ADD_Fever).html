<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Daily Fever Report - I - Fever</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <style>
        table {
            border-collapse: collapse;
        }

        table,
        td,
        th {
            border: 1px solid black;
        }

        p {
            text-align: center;
        }
    </style>

</head>

<body>

<div id="loader"></div>
<b style="margin-left: 30%">Start Date : </b><input type="date" id ="start" required>
<input type="checkbox" id ="checkit" onclick="checkfunction()" checked> search only for single day End Date :  <input type="date" id ="end" disabled required><br><br>

<div style="text-align: center">
    <button onClick="genAdd()" id="dr1add">Daily Fever 1-ADD</button>
    &nbsp;
    <button onClick="genAfi()" id="dr1afi">Daily Fever 1-AFI</button>
    &nbsp;
    <button onClick="genLab()" id="dr2">Daily Fever 2</button><br><br>

    <input type="button" id="export1" value="Download as Excel(DR1 ADD)" onClick="exportExcel_dr1add()">
    &nbsp;
    <input type="button" id="export2" value="Download as Excel(DR1 AFI)" onClick="exportExcel_dr1afi()">
    &nbsp;
    <input type="button" id="export3" value="Download as Excel(DR2 Lab)" onClick="exportExcel_dr2lab()">
</div>
<div id="printing">

    <p id="dr1_fever"><strong>Daily Fever Report - I - Fever</strong></p>
    <p id="dr1_fever1"><strong>Daily Fever Report - I - ADD</strong></p>
    <p id="dr2_lab"><strong>Daily Fever Report2</strong></p>
    <p style="text-align: left;display: inline" id="datedisplay"><strong>Date:</strong></p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<p style="text-align: center;display: inline" id="orgunitdisplay"><strong>OrgUnit:</strong></p>

    <table style="text-align:center" class="table_fever" id="fever_table">
        <thead>
        <tr style='border:1px solid black'>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>S.No.</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Date of Admission</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Age(in years)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Sex (M/F)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Guardian</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Door Number,Street Name,Habitation</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Village</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the block</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the HUD</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the District</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Contact Number</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Probable Diagnosis</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of Hospital/organisation</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Remarks if any</b></th></tr>
        </thead>
    </table>
    <table style="text-align:center" class="table_lab" id="lab_table">
        <thead>
        <tr style='border:1px solid black'>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>S.No.</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Date of Confirmation</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Age(in years)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Sex (M/F)</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Guardian</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Door Number,Street Name,Habitation</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Village</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the block</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the HUD</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of the District</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Contact Number</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Diagnosis Lab Confirmed</b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Name of Institution/Lab Confirmed </b></th>
            <th id = 'tablerows' colspan='1' style="color: #000000"><b>Remarks if any</b></th></tr>
        </thead>
    </table>
    <div style="display:flex">
        <p style="padding-right:50%" id="footer1"> Supported by GHSA Project, ICMR-NIE, Chennai-77</p>
        <p id="footer2"> Facilitated by DPH and PM, Chennai-06</p>
        </div>
</div>

<script type="text/javascript">
    var startDate,endDate;
    var urlApi;

    var url = window.location.href;
    var ou = url.split('=')[2],ouname;
    $( document ).ready(function() {
        $('.table_fever ').hide();
        $('.table_lab ').hide();
        $('#datedisplay').hide();
        $('#orgunitdisplay').hide();
        $('#dr1_fever').hide();
        $('#dr1_fever1').hide();
        $('#dr2_lab').hide();
        $('#footer1').hide();
        $('#footer2').hide();
//
//            fever_table.Visible=false;
//            lab_table.Visible=false;

    });
    var checkfunction = function(){
        if($('input:checkbox').is(':checked')){
            document.getElementById("end").disabled = true;
        }
        else{
            document.getElementById("end").disabled = false;
        }
    };

    function genAdd()
    {
        $('.table_fever ').show();
        $('.table_lab ').hide();
        $('#dr2_lab').hide();
        $('#datedisplay').show();
        $('#orgunitdisplay').show();
        $('#dr1_fever').show();
        $('#footer1').show();
        $('#footer2').show();
        var oulevel,oulevel_name;
        var org_ghuid,hud,block,village,districtu,habitationu=[];
        var dateofAdd=[],patientname=[],age=[],sex=[],guardian,street1=[],street2=[],habitation,block,hud,district=[],hospital=[],contactnumber,diagnosis,nameofhospital,remarks;

        $.getJSON("../api/organisationUnits/"+ou+".json", function(data){

            ouname=data.displayName;
            oulevel=data.level;

            $.getJSON("../api/organisationUnitLevels?fields=level,name", function(data) {

                $.each(data.organisationUnitLevels, function (index, item) {
                    if(item.level==oulevel)
                    {
                        oulevel_name=item.name;
                    }
                });
                document.getElementById("orgunitdisplay").innerHTML="Facility: "+ouname +" "+oulevel_name;
            });

        });


        startDate = document.getElementById("start").value;

        if($('input:checkbox').is(':checked')){
            urlApi="../api/events.json?orgUnit="+ou+"&program=c9LK7wM2Xmp&ouMode=DESCENDANTS&startDate="+startDate
        }
        else{
            endDate = document.getElementById("end").value;
            urlApi="../api/events.json?orgUnit="+ou+"&program=c9LK7wM2Xmp&ouMode=DESCENDANTS&startDate="+startDate+"&endDate="+endDate
        }

        $('.table_fever tbody').remove();
        $('.table_fever tbody').detach();

        $.ajax({

            async : false,
            type: "GET",
            url: urlApi,
            success: function(data){
                for(var p=0;p<data.events.length;p++){

                    org_ghuid=data.events[p].orgUnit;
                    village=data.events[p].orgUnitName;


                    for(var q=0;q<data.events[p].dataValues.length;q++)
                    {
                        if(data.events[p].dataValues[q].dataElement=="LAEvImak9Lj")
                        {

                            dateofAdd.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="K7NJ8bJ2FGO")
                        {

                            //Basic_Information/Name
                            patientname.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="AzCxr5riBpr")
                        {

                            //Age in years
                            age.push(data.events[p].dataValues[q].value);
                        }else if(data.events[p].dataValues[q].dataElement=="dYEvSF9ZioI")
                        {
                            //Gender
                            sex.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="lDeFdq0qjL8")
                        {
                            //Street_Information/Street

                            street1.push(data.events[p].dataValues[q].value);
                            console.log(street1[p]);

                        }
                        else if(data.events[p].dataValues[q].dataElement=="UC2KEjjhznr")
                        {
                            //Street_Information/Pincode
                            street2.push(data.events[p].dataValues[q].value);
                            console.log(street2[p]);
                        }else if(data.events[p].dataValues[q].dataElement=="OXSEy2soB7c")
                        {
                            //District
                            district.push(data.events[p].dataValues[q].value);
                        }else if(data.events[p].dataValues[q].dataElement=="cwQmNiBeuWL")
                        {
                            //GH
                            hospital.push(data.events[p].dataValues[q].value.split('-')[1]);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="uyC3A25ESDb")
                        {
                            habitationu.push(data.events[p].dataValues[q].value.replace(/[^A-Za-z]+/g, ''));

                        }
                        /*To Do : Mapping Guardian   Contact    Remarks*/
                    }
                    $.ajax({

                        async : false,
                        type: "GET",
                        url: '../api/organisationUnits/'+org_ghuid+'?fields=ancestors[id,displayName,level],children[id,displayName,level]',
                        success: function(data1){
                            $.each(data1.ancestors, function (index, item) {
                                if(item.level==3)
                                {
                                    districtu=item.displayName;

                                }
                                if(item.level==4)
                                {
                                    hud=item.displayName;

                                }
                                if(item.level==5)
                                {
                                    block=item.displayName;

                                }

                            });

                        },
                        error: function(response){

                        }
                    });

                    var row = $("<tbody><tr><td  id = 'tablerowsh' colspan='1' id='td'>" + p + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + dateofAdd[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + age[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'></td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + village + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + hud + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + block + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu+ "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'></td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>ADD</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'></td></tr></tbody>");
                    $(".table_fever").append(row);

                }

                document.getElementById("datedisplay").innerHTML="Date:"+ startDate;

            },
            error: function(response){

            }






        });

        $("#hidden1").show();
        $("#hidden2").show();
    }


     function genAfi()
    {
        var org_ghuid,hud,block,village,districtu,habitationu=[];
        var dateofAdd=[],patientname=[],age=[],sex=[],guardian,street1=[],street2=[],habitation,block,hud,district=[],hospital=[],contactnumber,diagnosis,nameofhospital,remarks;

        $.getJSON("../api/organisationUnits/"+ou+".json", function(data){

            ouname=data.displayName;
            oulevel=data.level;

            $.getJSON("../api/organisationUnitLevels?fields=level,name", function(data) {

                $.each(data.organisationUnitLevels, function (index, item) {
                    if(item.level==oulevel)
                    {
                        oulevel_name=item.name;
                    }
                });
                document.getElementById("orgunitdisplay").innerHTML="Facility: "+ouname +" "+oulevel_name;
            });

        });



        startDate = document.getElementById("start").value;

        if($('input:checkbox').is(':checked')){
            urlApi="../api/events.json?orgUnit="+ou+"&ouMode=DESCENDANTS&startDate="+startDate
        }
        else{
            endDate = document.getElementById("end").value;
            urlApi="../api/events.json?orgUnit="+ou+"&ouMode=DESCENDANTS&startDate="+startDate+"&endDate="+endDate
        }

        $('.table_fever tbody').remove();
        $('.table_fever tbody').detach();

        $.ajax({

            async : false,
            type: "GET",
            url: urlApi,
            success: function(data){
                for(var p=0;p<data.events.length;p++){

                    org_ghuid=data.events[p].orgUnit;
                    village=data.events[p].orgUnitName;


                    for(var q=0;q<data.events[p].dataValues.length;q++)
                    {
                        if(data.events[p].dataValues[q].dataElement=="LAEvImak9Lj")
                        {

                            dateofAdd.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="K7NJ8bJ2FGO")
                        {

                            //Basic_Information/Name
                            patientname.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="AzCxr5riBpr")
                        {

                            //Age in years
                            age.push(data.events[p].dataValues[q].value);
                        }else if(data.events[p].dataValues[q].dataElement=="dYEvSF9ZioI")
                        {
                            //Gender
                            sex.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="lDeFdq0qjL8")
                        {
                            //Street_Information/Street

                            street1.push(data.events[p].dataValues[q].value);
                            console.log(street1[p]);

                        }
                        else if(data.events[p].dataValues[q].dataElement=="UC2KEjjhznr")
                        {
                            //Street_Information/Pincode
                            street2.push(data.events[p].dataValues[q].value);
                            console.log(street2[p]);
                        }else if(data.events[p].dataValues[q].dataElement=="OXSEy2soB7c")
                        {
                            //District
                            district.push(data.events[p].dataValues[q].value);
                        }else if(data.events[p].dataValues[q].dataElement=="cwQmNiBeuWL")
                        {
                            //GH
                            hospital.push(data.events[p].dataValues[q].value.split('-')[1]);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="uyC3A25ESDb")
                        {
                            habitationu.push(data.events[p].dataValues[q].value.replace(/[^A-Za-z]+/g, ''));

                        }
                        /*To Do : Mapping Guardian   Contact    Remarks*/
                    }
                    $.ajax({

                        async : false,
                        type: "GET",
                        url: '../api/organisationUnits/'+org_ghuid+'?fields=ancestors[id,displayName,level],children[id,displayName,level]',
                        success: function(data1){
                            $.each(data1.ancestors, function (index, item) {
                                if(item.level==3)
                                {
                                    districtu=item.displayName;

                                }
                                if(item.level==4)
                                {
                                    hud=item.displayName;

                                }
                                if(item.level==5)
                                {
                                    block=item.displayName;

                                }

                            });

                        },
                        error: function(response){

                        }
                    });

                    var row = $("<tbody><tr><td  id = 'tablerowsh' colspan='1' id='td'>" + p + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + dateofAdd[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + age[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'></td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + village + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + hud + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + block + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu+ "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'></td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>AFI</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'></td></tr></tbody>");
                    $(".table_fever").append(row);

                }

                document.getElementById("datedisplay").innerHTML="Date:"+ startDate;

            },
            error: function(response){

            }






        });

        $("#hidden1").show();
        $("#hidden2").show();
    }

    function genLab()
    {
        $('.table_fever ').hide();
        $('.table_lab ').show();
        $('#datedisplay').show();
        $('#orgunitdisplay').show();
        $('#dr1_fever').hide();
        $('#dr1_fever1').hide();
        $('#dr2_lab').show();
        $('#footer1').show();
        $('#footer2').show();
        var oulevel,oulevel_name,lab_positive="Positive",lab_diagnosis=[],lab_diagnosis_string="";
        var org_ghuid,hud,block,village,districtu,habitationu=[];
        var dateofAdd=[],patientname=[],age=[],sex=[],guardian,street1=[],street2=[],habitation,block,hud,district=[],hospital=[],contactnumber,diagnosis,nameofhospital,remarks;

        $.getJSON("../api/organisationUnits/"+ou+".json", function(data){

            ouname=data.displayName;
            oulevel=data.level;

            $.getJSON("../api/organisationUnitLevels?fields=level,name", function(data) {

                $.each(data.organisationUnitLevels, function (index, item) {
                    if(item.level==oulevel)
                    {
                        oulevel_name=item.name;
                    }
                });
                document.getElementById("orgunitdisplay").innerHTML="Facility: "+ouname +" "+oulevel_name;
            });

        });


        startDate = document.getElementById("start").value;

        if($('input:checkbox').is(':checked')){
            urlApi="../api/events.json?orgUnit="+ou+"&program=uN7UhBdFv0g&ouMode=DESCENDANTS&startDate="+startDate
        }
        else{
            endDate = document.getElementById("end").value;
            urlApi="../api/events.json?orgUnit="+ou+"&program=uN7UhBdFv0g&ouMode=DESCENDANTS&startDate="+startDate+"&endDate="+endDate
        }

        $('.table_lab tbody').remove();
        $('.table_lab tbody').detach();

        $.ajax({

            async : false,
            type: "GET",
            url: urlApi,
            success: function(data){
                for(var p=0;p<data.events.length;p++){

                    org_ghuid=data.events[p].orgUnit;
                    village=data.events[p].orgUnitName;


                    for(var q=0;q<data.events[p].dataValues.length;q++)
                    {
                        if(data.events[p].dataValues[q].dataElement=="LAEvImak9Lj")
                        {

                            dateofAdd.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="K7NJ8bJ2FGO")
                        {

                            //Basic_Information/Name
                            patientname.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="AzCxr5riBpr")
                        {

                            //Age in years
                            age.push(data.events[p].dataValues[q].value);
                        }else if(data.events[p].dataValues[q].dataElement=="dYEvSF9ZioI")
                        {
                            //Gender
                            sex.push(data.events[p].dataValues[q].value);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="lDeFdq0qjL8")
                        {
                            //Street_Information/Street

                            street1.push(data.events[p].dataValues[q].value);
                            console.log(street1[p]);

                        }
                        else if(data.events[p].dataValues[q].dataElement=="UC2KEjjhznr")
                        {
                            //Street_Information/Pincode
                            street2.push(data.events[p].dataValues[q].value);
                            console.log(street2[p]);
                        }else if(data.events[p].dataValues[q].dataElement=="OXSEy2soB7c")
                        {
                            //District
                            district.push(data.events[p].dataValues[q].value);
                        }else if(data.events[p].dataValues[q].dataElement=="cwQmNiBeuWL")
                        {
                            //GH
                            hospital.push(data.events[p].dataValues[q].value.split('-')[1]);
                        }
                        else if(data.events[p].dataValues[q].dataElement=="uyC3A25ESDb")
                        {
                            habitationu.push(data.events[p].dataValues[q].value.replace(/[^A-Za-z]+/g, ''));

                        }
                        else if(data.events[p].dataValues[q].dataElement=="iq8MowhqXPr")
                        {
                            //Dengue
                            if(data.events[p].dataValues[q].value.includes(lab_positive))
                            {
                                lab_diagnosis_string=lab_diagnosis_string+"Dengue";

                            }


                        }
                        else if(data.events[p].dataValues[q].dataElement=="vLwcDFMVQT5")
                        {
                            //Lepro
                            if(data.events[p].dataValues[q].value.includes(lab_positive))
                            {
                                lab_diagnosis_string=lab_diagnosis_string+",Leptosprirosis";

                            }

 0                       }
                      else if(data.events[p].dataValues[q].dataElement=="buxUamQKLyz")
                        {
                            //Malaria
                            if(data.events[p].dataValues[q].value.includes(lab_positive))
                            {
                                lab_diagnosis_string=lab_diagnosis_string+",Malaria";

                            }

                        }
                        else if(data.events[p].dataValues[q].dataElement=="klE6js540A1")
                        {
                            //Scrub
                            if(data.events[p].dataValues[q].value.includes(lab_positive))
                            {
                                lab_diagnosis_string=lab_diagnosis_string+",Scrub";

                            }

                        }

                        /*To Do : Mapping Guardian   Contact    Remarks*/
                    }
                    $.ajax({

                        async : false,
                        type: "GET",
                        url: '../api/organisationUnits/'+org_ghuid+'?fields=ancestors[id,displayName,level],children[id,displayName,level]',
                        success: function(data1){
                            $.each(data1.ancestors, function (index, item) {
                                if(item.level==3)
                                {
                                    districtu=item.displayName;

                                }
                                if(item.level==4)
                                {
                                    hud=item.displayName;

                                }
                                if(item.level==5)
                                {
                                    block=item.displayName;

                                }

                            });

                        },
                        error: function(response){

                        }
                    });

                    var row = $("<tbody><tr><td  id = 'tablerowsh' colspan='1' id='td'>" + p + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + dateofAdd[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + patientname[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + age[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + sex[p] + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'></td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + street1[p] +","+ habitationu[p] +"</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + village + "</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + hud + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + block + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>" + districtu+ "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'></td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'>"+lab_diagnosis_string+"</td>" +
                        "<td id = 'tablerowsh' colspan='1' id='td'>" + hospital[p] + "</td>" +
                        "<td  id = 'tablerowsh' colspan='1' id='td'></td></tr></tbody>");
                    $(".table_lab").append(row);
                    lab_diagnosis_string="";

                }

                document.getElementById("datedisplay").innerHTML="Date:"+ startDate;

            },
            error: function(response){

            }


        });

        $("#hidden1").show();
        $("#hidden2").show();
    }



</script>
<script type="text/javascript">

    function exportExcel_dr1add(e) {
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementsByClassName('table_fever')[0];
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'Daily Report ADD.xls';
        a.click();
        e.preventDefault();
    }
    function exportExcel_dr1afi(e) {
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementsByClassName('table_fever')[0];
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'Daily Report AFI.xls';
        a.click();
        e.preventDefault();
    }
 function exportExcel_dr2lab(e) {
        var a = document.createElement('a');
        var data_type = 'data:application/vnd.ms-excel';
        var table_div = document.getElementsByClassName('table_lab')[0];
        var table_html = table_div.outerHTML.replace(/ /g, '%20');
        a.href = data_type + ', ' + table_html;
        a.download = 'Daily Report2 Lab.xls';
        a.click();
        e.preventDefault();
    }

</script>
</body>

</html>