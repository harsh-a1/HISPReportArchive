<style type='text/css'>
	tbody td:hover {
		background: #cacfd1;
	}

	#loader {
    position: absolute;
    left: 50%;
    top: 50%;
    z-index: 1;
    width: 150px;
    height: 150px;
    margin: -75px 0 0 -75px;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid #34B4DB;
    width: 120px;
    height: 120px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
}

@-webkit-keyframes spin {
    0% {
        -webkit-transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(360deg);
    }
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}

</style>
<button type="button" style="vertical-align: middle;" id="btnExport" onclick="tableToExcel('dataTable', 'Labour Room Register','Labour_Room_Register.xls')">Download As Excel</button>
 <a id="dlink" style="display:none;"></a>

<div id="loader"></div>
	<table style='border-collapse: collapse;' id="dataTable">
	<thead>
		<tr>
			<th style='text-align: center; padding: 5px;' colspan='11'><h1>Labour Room Register</h1></th>
		</tr>
		<tr>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' colspan='2'>Serial NO.</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Details of PW</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Obstetric History</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Status of Admission</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Details of Delivery</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Condition of Mother during transfer to IPD</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Details about Baby</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Condition of baby at time of transfer to IPD</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Postpartum family Planning</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;' rowspan='2'>Remarks if Any</th>
		</tr>
		<tr>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>Annual</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>Monthly</th>
		</tr>
		<tr>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>1</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>2</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>3</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>4</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>5</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>6</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>7</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>8</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>9</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>10</th>
			<th style='border:1px solid #cacfd1; text-align: center; padding: 5px;'>11</th>
		</tr>
	</thead>
	<tbody id="tableBody">

	</tbody>
</table>
<script type="text/javascript">
	var url = window.location.href;
	var ou1 = url.split("&")[2];
	var ou = ou1.split("=")[1];

	var level = 0;
	var orgUnitHierarchylength = dhis2.report.organisationUnitHierarchy.length;
	if (orgUnitHierarchylength == 1) {
		level = 3;
	}
	else if (orgUnitHierarchylength == 2) {
		level = 2;
	}
	else if (orgUnitHierarchylength == 3) {
		level = 1;
	}


	var MCTS_RCH_No = "";
	var namePregnantWoman = "";
	var agePregnantWoman = "";
	var husbandFatherGuardianName = "";
	var addressPregnantWoman = "";
	var policeStation  = "";
	var contactNumber = "";
	var registrationNumber = "";
	var registration = "";
	var ifReferredFromWhere = "";
	var LMP = "";
	var EDD = "";
	var gravida = "";
	var parity = "";
	var abortion = "";
	var numberOfLivingChildren = "";
	var previousLSCS = "";
	var otherPreviousComplications = "";
	var dateOfAdmission = "";
	var timeOfAdmissionInHr = "";
	var timeOfAdmissionInMin = "";
	var timeOfAdmissionFormat =  "";
	var regdWithANM = "";
	var pregnancyInWeek = "";
	var pulseRate = "";
	var bpSystolic = "";
	var bpDiastolic = "";
	var temprature = "";
	var hb= "";
	var bloodGroupRh = "";
	var proteinuria = "";
	var malaria = "";
	var hivTestDone = "";
	var hivResult = "";
	var hepB = "";
	var FHR = "";
	var referred = "";
	var referredTo = "";
	var transportation = "";
	var deliveryDate= "";
	var deliveryTimeInHr = "";
	var deliveryTimeInMin = "";
	var deliveryTimeFormat = "";
	var typeOfDelivery = "";
	var normal = '';
	var assisted = '';
	var lscs = '';
	var indication = "";
	var deliveryConductedBy = "";
	var partographFilled = "";
	var AMTSL = "";
	var uterotonicUsed = "";
	var oxytocin = '';
	var misoprostol = '';
	var uterotonicSpecify = "";
	var antibiotics = "";
	var bloodTransfusion = "";
	var aph = "";
	var pph = "";
	var eclampsia = "";
	var sepsis = "";
	var obsLabour = "";
	var prolongedLabour = "";
	var otherComplicationSpecify = "";
	var death = "";
	var pulseOfMotherAt15Min = "";
	var systolicBpOfMotherAt15Min = "";
	var diastolicBpOfMotherAt15Min = "";
	var temperatureOfMotherAt15Min = "";
	var bleedingPV = "";
	var referrel = "";
	var referrelMotherYes = '';
	var referrelMotherNo = '';
	var referrelMotherTo = "";
	var reasons = "";
	var babyTicketNumber = "";
	var deliveryOutcome = "";
	var live = '';
	var stillBirth = '';
	var IUD = '';
	var diedAfterBirth = '';
	var male = '';
	var female = '';
	var others = '';
	var single = "";
	var twin = "";
	var weight = "";
	var criedImmediately = "";
	var criedImmediatelyYes = '';
	var criedImmediatelyNo = '';
	var breastFeedingWithin1Hr = "";
	var breastFeedingWithin1HrYes = '';
	var breastFeedingWithin1HrNo = '';
	var vitaminKGiven = "";
	var vitaminKGivenYes = '';
	var vitaminKGivenNo = '';
	var babyRespiration = "";
	var tempBaby = "";
	var colour = "";
	var referredOut = "";
	var referredOutYes = '';
	var referredOutNo = '';
	var reasonsBaby = "";
	var referredBabyTo = "";
	var otherComplicationSpecifyBaby = "";
	var methodAdoptedOther = "";
	var lam = "";
	var condoms = "";
	var injectable = "";
	var pop = "";
	var pps = "";
	var PPIUCD = "";
	var asphyxia = "";
	var transferTimeHr = "";
	var transferTimeMin = "";
	var transferTimeFormat = "";
	var counselingYes = "";
	var counselingNo = "";
	var sterilization = "";
	var followUpDate = "";
	var convulsions = "";
	var timeOfReferralHr = "";
	var timeOfReferralMin = "";
	var timeOfReferralFormat = "";
	var methodAdoptedYes = "";
	var methodAdoptedNo = "";
	var methodAdoptedLAM = "";
	var methodAdoptedCondoms = "";
	var methodAdoptedPPIUCD = "";
	var methodAdoptedPOP = "";
	var methodAdoptedPPS = "";
	var methodAdoptedSterilization = "";
	var methodAdoptedInjectable = "";

	var getData = function (teiList, ouID) {

			teiList.trackedEntityInstances.forEach(function (element, index) {
				var tei = element.trackedEntityInstance;
				var attributes = element.attributes;
				$.when(
					$.getJSON("../api/events.json?ou=" + ouID + "&trackedEntityInstance=" + tei + "&program=f1ctOk0ZOZw&fields=programStage,eventDate,dataValues&skipPaging=true", {
						format: "json"
					})
				).then(function (eventData) {
					for (var j = 0; j < attributes.length; j++) {
						switch (attributes[j].attribute) {
							case "UG03n3pVk7J":
								MCTS_RCH_No = attributes[j].value;
								break;
							case "WOACLVH2VAh":
								namePregnantWoman = attributes[j].value;
								break;
							case "weinW2nVMlu":
								agePregnantWoman = attributes[j].value;
								break;
							case "ucChpKrA87g":
								husbandFatherGuardianName = attributes[j].value;
								break;
							case "qrqPNb4Vwcg":
								addressPregnantWoman = attributes[j].value;
								break;
							case "IAIaMBD6Swx":
								policeStation = attributes[j].value;
								break;
							case "vf9DxLOjyBl":
								contactNumber = attributes[j].value;
								break;
							case "RxZw2ak8DBb":
								registrationNumber = attributes[j].value;
								break;
							case "VbqrfzxfWHd":
								registration = attributes[j].value;
								break;
							case "InNzGlYrCLV":
								ifReferredFromWhere = attributes[j].value;
								break;
							case "AUx5ndlhQmd":
								timeOfAdmissionInHr = attributes[j].value;
								break;
							case "LjR5PAX86gl":
								timeOfAdmissionInMin = attributes[j].value;
								break;
							case "N77ZLhkv3cV":
								timeOfAdmissionFormat = attributes[j].value;
								break;
							case "WmavZ0UCZGN":
								if (attributes[j].value == "true") {
									regdWithANM = "Y";
								}
								else if (attributes[j].value == "false") {
									regdWithANM = "N";
								}
								break;
							default:
								break;
						}
					}
					var events = eventData.events;
					for(var i = 0; i < events.length; i++) {
						dataValues = events[i].dataValues;
						if(events[i].programStage == "lB7Z230PEu8") {
							dateOfAdmission = events[i].eventDate;
							dateOfAdmission = dateOfAdmission.split('T')[0];
						}
						for(var l = 0; l < dataValues.length; l++) {
							switch (dataValues[l].dataElement) {
								case "SFFPCa7ozgr":
									LMP = dataValues[l].value;
									break;
								case "CZZ5ddvPUlx":
									EDD = dataValues[l].value;
									break;
								case "psttyIdtMfE":
									gravida = dataValues[l].value;
									break;
								case "ifpCf2KI2Sh":
									parity = dataValues[l].value;
									break;
								case "n8Kt9YNUaA7":
									abortion = dataValues[l].value;
									break;
								case "CLyVYrnC1yn":
									numberOfLivingChildren = dataValues[l].value;
									break;
								case "QdueFzMg1Rx":
									pulseRate = dataValues[l].value;
									break;
								case "LS8i400qt5v":
									previousLSCS = dataValues[l].value;
									break;
								case "SfG4Dhqa1Ak":
									otherPreviousComplications = dataValues[l].value;
									break;
								case "Xb4OC1HSi1B":
									pregnancyInWeek = dataValues[l].value;
									break;
								case "YUrhbiqGmOv":
									bpSystolic = dataValues[l].value;
									break;
								case "qsUxUlHVCpl":
									bpDiastolic = dataValues[l].value;
									break;
								case "rgYRDAlzEub":
									temprature = dataValues[l].value;
									break;
								case "ijy6KMzlDHJ":
									hb = dataValues[l].value;
									break;
								case "svCs0pUtvUS":
									bloodGroupRh = dataValues[l].value;
									break;
								case "zdXTzAd11WC":
									proteinuria = dataValues[l].value;
									break;
								case"MZq46toIoWY":
									malaria = dataValues[l].value;
									break;
								case "vmoMMn8ohNu":
									hivTestDone = dataValues[l].value;
									break;
								case "cqROPR3X98a":
									hivResult = dataValues[l].value;
									break;
								case "UHcg0y0YkEW":
									hepB = dataValues[l].value;
									break;
								case "tM72ASqfhRr":
									FHR = dataValues[l].value;
									break;
								case "I79aCD2wRVc":
									referred = dataValues[l].value;
									break;
								case "F0NqWMkCd4W":
									referredTo = dataValues[l].value;
									break;
								case "O41PqVFEt6P":
									transportation = dataValues[l].value;
									break;
								case "SMweB4Y1wLt":
									deliveryDate = dataValues[l].value;
									break;
								case "XBD1C8zRBpY":
									deliveryTimeInHr = dataValues[l].value;
									break;
								case "ReIRf8HTZbY":
									deliveryTimeInMin = dataValues[l].value;
									break;
								case "BLJFQdwKach":
									deliveryTimeFormat = dataValues[l].value;
									break;
								case "f3GBHXJufrq":
									if (dataValues[l].value == "Normal") {
										normal = "checked";
									}
									else if (dataValues[l].value == "Assisted") {
										assisted = "checked";
									}
									else if (dataValues[l].value == "LSCS") {
										lscs = "checked"
									}
									break;
								case "MUZjuMNue5c":
									indication = dataValues[l].value;
									break;
								case "mza8rVUtOCc":
									deliveryConductedBy = dataValues[l].value;
									break;
								case "k2KUsnPCcNh":
									partographFilled = dataValues[l].value;
									break;
								case "WoPu09CSqC9":
									AMTSL = dataValues[l].value;
									break;
								case "X8efH8wPYwp":
									if (dataValues[l].value == "Inj. Oxytocin") {
										oxytocin = "checked";
									}
									else if (dataValues[l].value == "Misoprostol") {
										misoprostol = "checked";
									}
									break;
								case "cUKkCdkfJlB":
									uterotonicSpecify = dataValues[l].value;
									break;
								case "R6ttSMgkSkV":
									if (dataValues[l].value == "true") {
										antibiotics = "checked";
									}
									break;
								case "h0Us1le7FEh":
									if (dataValues[l].value == "Yes") {
										aph = "checked";
									}
									break;
								case "qoMQSD7Hwwt":
									if (dataValues[l].value == "Yes") {
										pph = "checked";
									}
									break;
								case "ip1C2zprrC6":
									if (dataValues[l].value == "Yes") {
										eclampsia = "checked";
									}
									break;
								case "Zfe2JZKsa99":
									if (dataValues[l].value == "Yes") {
										sepsis = "checked";
									}
									break;
								case "j5clrwdS6ii":
									if (dataValues[l].value == "Yes") {
										obsLabour = "checked";
									}
									break;
								case "biDo417Kj0m":
									if (dataValues[l].value == "Yes") {
										prolongedLabour = "checked";
									}
									break;
								case "SfG4Dhqa1Ak":
									otherComplicationSpecify = dataValues[l].value;
									break;
								case "ehZGFxMlQXw":
									if (dataValues[l].value == "Yes") {
										death = "checked";
									}
									break;
								case "oIYvRql0xH5":
									pulseOfMotherAt15Min = dataValues[l].value;
									break;
								case "o7FQ5kUSgiu":
									systolicBpOfMotherAt15Min = dataValues[l].value;
									break;
								case "PxC6DEh3tMx":
									diastolicBpOfMotherAt15Min = dataValues[l].value;
									break;
								case "wHOiQYUC3b4":
									temperatureOfMotherAt15Min = dataValues[l].value;
									break;
								case "W5iYj88KCXG":
									bleedingPV = dataValues[l].value;
									break;
								case "CHdfvDPTINl":
									if (dataValues[l].value == "true") {
										referrelMotherYes = "checked";
									}
									else if (dataValues[l].value == "false") {
										referrelMotherNo = "checked";
									}
									break;
								case "H4NIIvjlvi4":
									referrelMotherTo = dataValues[l].value;
									break;
								case "CpUfI03Vqhd":
									reasons = dataValues[l].value;
									break;
								case "fL51bpE96cp":
									babyTicketNumber = dataValues[l].value;
									break;
								case "UJllY3Myq7D":
									if (dataValues[l].value == "Died immediately after birth") {
										diedAfterBirth = "checked";
									}
									else if (dataValues[l].value == "Intrauterine death") {
										IUD = "checked";
									}
									else if (dataValues[l].value == "Live") {
										live = "checked";
									}
									else if (dataValues[l].value == "Still birth ") {
										stillBirth = "checked";
									}
									break;
								case "HHbsty9dR06":
									if (dataValues[l].value == "Male") {
										male = "checked";
									}
									else if (dataValues[l].value == "Female") {
										female = "checked"
									}
									break;
								case "L90vV6xKEZA":
									if (dataValues[l].value == "true") {
										criedImmediatelyYes = "checked";
									}
									else if (dataValues[l].value == "false") {
										criedImmediatelyNo = "checked";
									}
									break;
								case "AJb5cKBVUVr":
									if (dataValues[l].value == "Yes") {
										breastFeedingWithin1HrYes = "checked";
									}
									else {
										breastFeedingWithin1HrNo = "checked";
									}
									break;
								case "Wt9lwK57fp1":
									if (dataValues[l].value == "true") {
										vitaminKGivenYes = "checked";
									}
									else if (dataValues[l].value == "false") {
										vitaminKGivenNo = "checked";
									}
									break;
								case "vIDH4aUC99T":
									colour = dataValues[l].value;
									break;
								case "o3Yo1m0q2Vp":
									if (dataValues[l].value == "true") {
										referredOutYes = "checked";
									}
									else if (dataValues[l].value == "false") {
										referredOutNo = "checked";
									}
									break;
								case "kB3mR88CjQ0":
									reasonsBaby = dataValues[l].value;
									break;
								case "laGaQeZruNQ":
									otherComplicationSpecifyBaby = dataValues[l].value;
									break;
								case "XN7bUfTSayK":
									if (dataValues[l].value == "true") {
										lam = "checked";
									}
									break;
								case "dM8mpQlWGzh":
									if (dataValues[l].value == "true") {
										condoms = "checked";
									}
									break;
								case "w7dEneRJFKL":
									if (dataValues[l].value == "true") {
										injectable = "checked";
									}
									break;
								case "ajg09amh9DL":
									if (dataValues[l].value == "true") {
										PPIUCD = "checked";
									}
									break;
								case "FwCpjMHZhhJ":
									methodAdoptedOther = dataValues[l].value;
									break;
								case "fp5M7NuTBZ5":
									if (dataValues[l].value == "true") {
										asphyxia = "checked";
									}
									break;
								case "xKtxBWKjntx":
									if (dataValues[l].value == "Single") {
										single = "checked";
									}
									else if (dataValues[l].value == "Twin (Multiple)") {
										twin = "checked";
									}
									break;
								case "pJXvSjh47wC":
									weight = dataValues[l].value;
									break;
								case "NqoUwV30kOR":
									transferTimeHr = dataValues[l].value;
									break;
								case "i7TKayaMZHc":
									transferTimeMin = dataValues[l].value;
									break;
								case "twMXhpDA4rk":
									transferTimeFormat = dataValues[l].value;
									break;
								case "YVhhY4qV9xp":
									if (dataValues[l].value == "Yes") {
										counselingYes = "checked";
									}
									else if (dataValues[l].value == "No") {
										counselingNo = "checked";
									}
									break;
								case "e4yjDI4VOWA":
									if (dataValues[l].value == "true") {
										sterilization = "checked";
									}
									break;
								case "oup0HsH5xHR":
									if (dataValues[l].value == "true") {
										pop = "checked";
									}
									break;
								case "AMkkD5a5bdW":
									if (dataValues[l].value == "true") {
										pps = "checked";
									}
									break;
								case "zB0kbQTNjH8":
									followUpDate = dataValues[l].value;
									break;
								case "og32aq7Slon":
									if (dataValues[l].value == "Convulsions") {
										convulsions = "Y";
									}
									else {
										convulsions = "N";
									}
									break;
								case "WbXy6GRONPI":
									timeOfReferralHr = dataValues[l].value;
									break;
								case "bfkdLyJ1OiA":
									timeOfReferralMin = dataValues[l].value;
									break;
								case "rqEO4Lr18Ae":
									timeOfReferralFormat = dataValues[l].value;
									break;
								case "SHNipchfTV4":
									if (parseInt(dataValues[l].value) > 0 && dataValues[l].value.length > 0) {
										babyRespiration = "Y";
									}
									else {
										babyRespiration = "N";
									}
									break;
								case "NYTiMRV1VyU":
									tempBaby = dataValues[l].value;
									break;
								case "j2UHtSYIv15":
									if (dataValues[l].value = "Yes") {
										methodAdoptedYes = "checked";
									}
									else if (dataValues[l].value == "No") {
										methodAdoptedNo = "checked";
									}
									break;
								case "CIIvUEYfBR0":
									if (dataValues[l].value == "true") {
										methodAdoptedCondoms = "checked";
									}
									break;
								case "JpyGQuBNuEd":
									if (dataValues[l].value == "true") {
										methodAdoptedInjectable = "checked";
									}
									break;
								case "k3RKh75VIAX":
									if (dataValues[l].value == "true") {
										methodAdoptedLAM = "checked";
									}
									break;
								case "rOaIhA5skGs":
									if (dataValues[l].value == "true") {
										methodAdoptedSterilization = "checked";
									}
									break;
								case "iOXmtxVEQEH":
									if (dataValues[l].value == "true") {
										methodAdoptedPOP = "checked";
									}
									break;
								case "Nllh5JkCxXt":
									if (dataValues[l].value == "true") {
										methodAdoptedPPS = "checked";
									}
									break;
								case "u7aPUGMYNjp":
									if (dataValues[l].value == "true") {
										methodAdoptedPPIUCD = "checked";
									}
									break;
								default:
								break;
							}
						}
					}

					document.getElementById('tableBody').innerHTML += "<tr><td style='border:1px solid #cacfd1;' rowspan='3'>&nbsp;</td><td style='border:1px solid #cacfd1;' rowspan='3'>&nbsp;</td><td valign='top' style='border:1px solid #cacfd1;' rowspan='3'><ul style='list-style: none; '><li style='padding: 5px; white-space: nowrap;'><b>MCTS/RCH No. - </b>" + MCTS_RCH_No + "</li><li style='padding: 5px;'><b>Name</b></li><li style='padding: 5px;'>" + namePregnantWoman + "</li><li style='padding: 5px;'><b>Age - </b>" + agePregnantWoman + "</li><li style='padding: 5px;'><b>Husband's/Fathers/Guardians Name</b></li><li style='padding: 5px;'>" + husbandFatherGuardianName + "</li><li style='padding: 5px;'><b>Address</b></li><li style='padding: 5px;'>" + addressPregnantWoman + "</li><li style='padding: 5px;'><b>Ps - </b>" + policeStation + "</li><li style='padding: 5px;'><b>Contact No.</b></li><li style='padding: 5px;'>" + contactNumber + "</li><li style='padding:5px;'><b>Registration No. - </b>"+ registrationNumber + "</li><li style='padding: 5px;'><b>Registration - </b>" + registration + "</li><li style='padding: 5px;'><b>If referred from where - </b>" + ifReferredFromWhere + "</li></ul></td><td valign='top' style='border:1px solid #cacfd1;' rowspan='3'><ul style='list-style: none; '><li style='padding: 5px; white-space: nowrap;'><b>Past Obstetric History</b></li><li style='padding: 5px;'><b>LMP - </b>" + LMP + "</li><li style='padding: 5px;'><b>EDD - </b>" + EDD + "</li><li style='padding: 5px;'><b>Gravida - </b>" + gravida + "</li><li style='padding: 5px;'><b>Parity - </b>" + parity + "</li><li style='padding: 5px;'><b>Abortion - </b>" + abortion + "</li><li style='padding: 5px;'><b>No. of Living Children - </b>" + numberOfLivingChildren + "</li><li style='padding: 5px; white-space: nowrap;'><b>Previous LSCS - </b>" + previousLSCS + "</li><li style='padding: 5px;'><b>If complications in previous pregnancy Specify:</b></li><li style='padding: 5px;'>" + otherPreviousComplications + "</li></ul></td><td valign='top' style='border:1px solid #cacfd1;' rowspan='3'><ul style='list-style: none; '><li style='padding: 5px;'><b>Date - </b>" + dateOfAdmission + "</li><li style='padding: 5px;'><b>Time - </b>" + timeOfAdmissionInHr + ":" + timeOfAdmissionInMin + "" + timeOfAdmissionFormat + "</li><li style='padding: 5px;'><b>Regd. with ANM - </b>" + regdWithANM + "</li><li style='padding: 5px;'><b>Pregnancy in week - </b>" + pregnancyInWeek + "</li><li style='padding: 5px;'><b>Conscious(Y/N) - </b></li><li style='padding: 5px; white-space: nowrap;'><b>Convulsions(Y/N) - </b>" + convulsions + "</li><li style='padding: 5px;'><b>Pulse Rate - </b>" + pulseRate + "</li><li style='padding: 5px;'><b>BP</b></li><li style='padding: 5px;'>Systolic - " + bpSystolic + "</li><li style='padding: 5px;'>Diastolic - " + bpDiastolic + "</li><li style='padding: 5px;'><b>Temp - </b>" + temprature + "</li><li style='padding: 5px;'><b>Hb% - </b>" + hb + "</li><li style='padding: 5px; white-space: nowrap;'><b>Blood Group &amp; Rh - </b>" + bloodGroupRh + "</li><li style='padding: 5px;'><b>Proteinuria - </b>" + proteinuria + "</li><li style='padding: 5px;'><b>Malaria - </b>" + malaria + "</li><li style='padding: 5px;'><b>HIV Test done - </b>" + hivTestDone + "</li><li style='padding: 5px;'><b>HIV Test result - </b>" + hivResult + "</li><li style='padding: 5px;'><b>Hep B - </b>" + hepB + "</li><li style='padding: 5px;'><b>FHR - </b>" + FHR + "</li><li style='padding: 5px;'><b>Referred - </b>" + referred + "</li><li style='padding: 5px;'><b>Referred To - </b></li><li style='padding: 5px;'>" + referredTo + "</li><li style='padding: 5px;'><b>Transportation - </b>" + transportation + "</li></ul></td><td valign='top' style='border:1px solid #cacfd1;' ><ul style='list-style: none; '><li style='padding: 5px;'><b>Date - </b>" + deliveryDate + "</li><li style='padding: 5px;'><b>Time - </b>" + deliveryTimeInHr + ":" + deliveryTimeInMin + "" + deliveryTimeFormat + "</li><li style='padding: 5px;'><b>Type:</b></li><li style='padding: 5px; white-space: nowrap;'>Normal<input type='checkbox' " + normal + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'>Assisted Delivery<input type='checkbox' " + assisted + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'>Caesarean<input type='checkbox' " + lscs + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px;'><b>If Caesarean, Indication:</b></li><li style='padding: 5px;'>" + indication + "</li><li style='padding: 5px;'><b>Delivery Conducted by:</b></li><li style='padding: 5px;'>" + deliveryConductedBy + "</li><li style='padding: 5px;'><b>Partograph Filled - </b>" + partographFilled + "</li><li style='padding: 5px; white-space: nowrap;'><b>AMTSL - </b>" + AMTSL + "</li><li style='padding: 5px;'><b>Type of Uterotonic:</b></li><li style='padding: 5px; white-space: nowrap;'>Oxytocin IM<input type='checkbox' " + oxytocin + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'>Misoprostol 3 Tabs<input type='checkbox' " + misoprostol + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>If others, then specify:</b></li><li style='padding: 5px;'>" + uterotonicSpecify + "</li><li style='padding: 5px; white-space: nowrap;'><b>Antibiotics</b><input type='checkbox' " + antibiotics + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Blood Transfusion</b><input type='checkbox' " + bloodTransfusion + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li></ul></td><td valign='top' style='border:1px solid #cacfd1;' ><ul style='list-style: none; '><li style='padding: 5px;'><b>Date and time of Transfer</b></li><li style='padding: 5px;'>" + transferTimeHr + ":" + transferTimeMin + "" + transferTimeFormat + "</li><li style='padding: 5px;'><b>Pulse - </b>" + pulseOfMotherAt15Min + "</li><li style='padding: 5px;'><b>BP</b></li><li style='padding: 5px;'>Systolic - " + systolicBpOfMotherAt15Min + "</li><li style='padding: 5px;'>Diastolic - " + diastolicBpOfMotherAt15Min + "</li><li style='padding: 5px;'><b>Temp - </b>" + temperatureOfMotherAt15Min + "</li><li style='padding: 5px;'><b>Bleeding PV - </b>" + bleedingPV + "</li><li style='padding: 5px;'><b>Complications if any</b></li><li style='padding: 5px;'><b>Referred</b></li><li style='padding: 5px;'>Yes<input type='checkbox' " + referrelMotherYes + " onclick='return false;' style='width: 15px; height: 15px;'>No<input type='checkbox' " + referrelMotherNo + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>Reasons:</b></li><li style='padding: 5px;'>" + reasons + "</li><li style='padding: 5px;'><b>Referred To:</b></li><li style='padding: 5px;'>" + referrelMotherTo + "</li></ul></td><td valign='top' style='border:1px solid #cacfd1;' rowspan='3'><ul style='list-style: none;'><li style='padding: 5px;'><b>Baby Ticket No.</b></li><li style='padding: 5px;'>" + babyTicketNumber + "</li><li style='padding: 5px;'><b>Baby Condition</b></li><li style='padding: 5px; white-space: nowrap;'><b>Alive</b><input type='checkbox' " + live + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Still birth</b><input type='checkbox' " + stillBirth + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>IUD</b><input type='checkbox' " + IUD + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Died Immediately after Birth</b><input type='checkbox' " + diedAfterBirth + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>Sex:</b></li><li style='padding: 5px; white-space: nowrap;'><b>Male</b><input type='checkbox' " + male + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Female</b><input type='checkbox' " + female + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Others</b><input type='checkbox' " + others + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px;'><b>Baby</b></li><li style='padding: 5px; white-space: nowrap;'><b>Single</b><input type='checkbox' " + single + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Multiple</b><input type='checkbox' " + twin + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px;'><b>Weight(Kgs) - </b> " + weight + " </li><li style='padding: 5px;'><b>Cried immediately after birth</b></li><li style='padding: 5px;'>Yes<input type='checkbox' " + criedImmediatelyYes + " onclick='return false;' style='width: 15px; height: 15px;'>No<input type='checkbox' " + criedImmediatelyNo + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>Breast feed within 1 hour</b></li><li style='padding: 5px;'>Yes<input type='checkbox' " + breastFeedingWithin1HrYes + " onclick='return false;' style='width: 15px; height: 15px;'>No<input type='checkbox' " + breastFeedingWithin1HrNo + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>Vitamin K, given</b></li><li style='padding: 5px;'>Yes<input type='checkbox' " + vitaminKGivenYes + " onclick='return false;' style='width: 15px; height: 15px;'>No<input type='checkbox' " + vitaminKGivenNo + " onclick='return false;' style='width: 15px; height: 15px;'></li></ul></td><td valign='top' style='border:1px solid #cacfd1;' rowspan='3'><ul style='list-style: none;'><li style='padding: 5px; white-space:nowrap;'><b>Baby Respiration(Y/N) - </b>" + babyRespiration +"</li><li style='padding: 5px;'><b>Temp - </b>" + tempBaby + "</li><li style='padding: 5px;'><b>Colour - </b>" + colour + "</li><li style='padding: 5px;'><b>Complications(if Any)</b></li><li style='padding: 5px;'><b>Birth</b></li><li style='padding: 5px; white-space: nowrap;'><b>Asphyxia</b><input type='checkbox' " + asphyxia + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>LBW</b><input type='checkbox' onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Pre Maturity</b><input type='checkbox' onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Others</b><input type='checkbox' onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px;'><b>(Specify):</b>" + otherComplicationSpecifyBaby + "</li><li style='padding: 5px;'></li><li style='padding: 5px;'><b>Referred out</b></li><li style='padding: 5px;'>Yes<input type='checkbox' " + referredOutYes+ " onclick='return false;' style='width: 15px; height: 15px;'>No<input type='checkbox' " + referredOutNo + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>Reasons:</b></li><li style='padding: 5px;'>" + reasonsBaby + "</li><li style='padding: 5px;'><b>Referred to - </b></li><li style='padding: 5px;'>" + referrelMotherTo + "</li><li style='padding: 5px; white-space: nowrap;'><b>Time of Referral - </b>" + timeOfReferralHr + ":" + timeOfReferralMin + "" + timeOfReferralFormat + "</li></ul></td><td valign='top' style='border:1px solid #cacfd1;' rowspan='2'><ul style='list-style: none;'><li style='padding: 5px;'><b>Counseling</b></li><li style='padding: 5px;'>Yes<input type='checkbox' " + counselingYes + " onclick='return false;' style='width: 15px; height: 15px;'>No<input type='checkbox' " + counselingNo + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>Counseling For:</b></li><li style='padding: 5px; white-space: nowrap;'><b>LAM</b><input type='checkbox' " + lam +" onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Condoms</b><input type='checkbox' " + condoms + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Injectable</b><input type='checkbox' " + injectable + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>PPIUCD</b><input type='checkbox' " + PPIUCD + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Male Sterilization</b><input type='checkbox' " + sterilization + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>PPS</b><input type='checkbox' " + pps + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px;'><b>POP - Centchroman(Weekly Pill)</b><input type='checkbox' " + pop + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px;'><b>Method Adopted</b></li><li style='padding: 5px;'>Yes<input type='checkbox' " + methodAdoptedYes + " onclick='return false;' style='width: 15px; height: 15px;'>No<input type='checkbox' " + methodAdoptedNo + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px; white-space: nowrap;'><b>LAM</b><input type='checkbox' " + methodAdoptedLAM +" onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Condoms</b><input type='checkbox' " + methodAdoptedCondoms + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Injectable</b><input type='checkbox' onclick='return false;' " + methodAdoptedInjectable + " style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>PPIUCD</b><input type='checkbox' " + methodAdoptedPPIUCD + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Male Sterilization</b><input type='checkbox' " + methodAdoptedSterilization + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>PPS</b><input type='checkbox' " + methodAdoptedPPS + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px;'><b>POP - Centchroman(Weekly Pill)</b><input type='checkbox' " + methodAdoptedPOP + " onclick='return false;' style='width: 15px; height: 15px; float: right;'></li><li style='padding: 5px; white-space: nowrap;'><b>Others - </b>" + methodAdoptedOther + "</li><li style='padding: 5px;'><b>Due date of Follow-up</b></li><li style='padding: 5px;'>" + followUpDate +"</li></ul></td><td style='border:1px solid #cacfd1;' rowspan='2'>&nbsp;</td></tr><tr><td style='border:1px solid #cacfd1;' rowspan='2' colspan='2'><ul style='list-style: none;'><li style='padding: 5px;'><b>Complications(If Any)</b></li><li style='padding: 5px; white-space: nowrap;'>APH<input type='checkbox' " + aph + " onclick='return false;' style='width: 15px; height: 15px;'>PPH<input type='checkbox' " + pph + " onclick='return false;' style='width: 15px; height: 15px;'>Pre-eclampsia/Eclampsis<input type='checkbox' " + eclampsia + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px; white-space: nowrap;'>Sepsis<input type='checkbox' " + sepsis + " onclick='return false;' style='width: 15px; height: 15px;'>Obs. Labour<input type='checkbox' " + obsLabour + " onclick='return false;' style='width: 15px; height: 15px;'>Prolonged Labour<input type='checkbox' " + prolongedLabour + " onclick='return false;' style='width: 15px; height: 15px;'></li><li style='padding: 5px;'><b>Others(Specify):</b>" + otherComplicationSpecify + "</li><li style='padding: 5px;'><b>Death</b><input type='checkbox' " + death + " onclick='return false;' style='width: 15px; height: 15px;'></li></ul></td></tr><tr><td style='border:1px solid #cacfd1; padding: 5px; white-space: nowrap;' colspan='2'><b>Signature of LR I/c:</b></td></tr>";

					MCTS_RCH_No = namePregnantWoman = agePregnantWoman = husbandFatherGuardianName = addressPregnantWoman = policeStation = contactNumber = registrationNumber = registration = ifReferredFromWhere = LMP = EDD = gravida = parity = abortion = numberOfLivingChildren = previousLSCS = otherPreviousComplications = dateOfAdmission = timeOfAdmissionInHr = timeOfAdmissionInMin = regdWithANM = pregnancyInWeek = pulseRate = bpSystolic = bpDiastolic = temprature = hb = bloodGroupRh = proteinuria = malaria = hivTestDone = hivResult = hepB = FHR = referred = referredTo = transportation = deliveryDate = deliveryTimeInHr = deliveryTimeInMin = deliveryTimeFormat = typeOfDelivery = normal = assisted = lscs = indication = deliveryConductedBy = partographFilled = AMTSL = uterotonicUsed = oxytocin = misoprostol = uterotonicSpecify = antibiotics = aph = pph = eclampsia = sepsis = obsLabour = prolongedLabour = otherComplicationSpecify = death = pulseOfMotherAt15Min = systolicBpOfMotherAt15Min = diastolicBpOfMotherAt15Min = temperatureOfMotherAt15Min = bleedingPV = referrel = referrelMotherYes = referrelMotherNo = referrelMotherTo = reasons = babyTicketNumber = deliveryOutcome = live = stillBirth = IUD = diedAfterBirth = male = female = other = single = twin = weight = criedImmediately = criedImmediatelyYes = criedImmediatelyNo = breastFeedingWithin1Hr = breastFeedingWithin1HrYes = breastFeedingWithin1HrNo = vitaminKGiven = vitaminKGivenYes = vitaminKGivenNo = colour = referredOut = referredOutYes = referredOutNo = reasonsBaby = referredBabyTo = otherComplicationSpecifyBaby = lam = condoms = PPIUCD = methodAdoptedOther = asphyxia = counselingYes = counselingNo = sterilization = followUpDate = transferTimeHr = transferTimeMin = transferTimeFormat =  convulsions = timeOfReferralFormat = timeOfReferralHr = timeOfReferralMin = babyRespiration = tempBaby = methodAdoptedYes = methodAdoptedNo = methodAdoptedLAM = methodAdoptedPOP = methodAdoptedPPS = methodAdoptedPPIUCD = methodAdoptedSterilization = methodAdoptedInjectable = methodAdoptedCondoms = injectable = pop = pps = '';
					
					  document.getElementById("loader").style.display = "none";

					});
			});
		};

  $(document).ready(function () {

  	$.when(
		$.getJSON("../api/organisationUnits/"+ou+".json?level="+level+"&fields=id&paging=false", {
			format: "json"
		})
		).then(function (ouList) {
			getTei(ouList);
		});

});

  var getTei = function(ouList) {
  	ouList.organisationUnits.forEach(function (element, index) {
  		var ouID = element.id;
  		$.when(
  		$.getJSON("../api/trackedEntityInstances.json?ou=" + ouID +"&fields=trackedEntityInstance,attributes&paging=false", {
			format: "json"
		})
  		).then(function (teiList) {
  			getData(teiList, ouID);
  		});
  	});
  };

  var tableToExcel = (function () {
            var uri = 'data:application/vnd.ms-excel;base64,'
                , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
                , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
                , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
            return function (table, name, filename) {
                if (!table.nodeType) table = document.getElementById(table)
                var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

                document.getElementById("dlink").href = uri + base64(format(template, ctx));
                document.getElementById("dlink").download = filename;
                document.getElementById("dlink").click();

            }
        })()
</script>
