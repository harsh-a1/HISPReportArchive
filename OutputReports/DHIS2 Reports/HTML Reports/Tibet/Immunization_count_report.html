<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Form A</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css"
        integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
    <style type="text/css" media="screen"></style>
    <style type="text/css" href="../api/documents/IlCodOSjSxY/data" media="print">
        @media print {
            #notPrint {
                display: none;
            }

            #printing {
                display: block;
            }

            @page {
                size: A4 landscape;
                max-height: 100%;
                max-width: 100%
            }
        }




    </style>

    <style>
        tbody>tr>td {
    font-weight: bold;
}
thead>tr>td {
font-weight: bold;
}
        table {
            border-collapse: collapse;
        }
        table,
        td,
        th {
            border: 1px solid black;
            text-align: center;
            height: 30px;
        }
        p {
            text-align: center;
        }
        .custom {
            margin-top: 50px;
            width: 100%;
            padding: 10px;
        }
        h3 {
            text-align: center;
        }
        .custom-table {
            width: 75%;
            font-size: 16px;
            margin: auto;
            text-align: center;
        }
        .custom-drop {
            text-align: center;
        }
        input[type=date] {
            border: 2px solid black;
            border-radius: 10px;
        }
        /* Center the loader  */

#loader {
    position: absolute;
    left: 50%;
    top: 50%;
    z-index: 1;
    width: 150px;
    height: 150px;
    margin: -75px 0 0 -75px;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid #34B4DB;
    width: 120px;
    height: 120px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
}

@-webkit-keyframes spin {
    0% {
        -webkit-transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(360deg);
    }
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}
/* Add animation to "page content" */

.animate-bottom {
    position: relative;
    -webkit-animation-name: animatebottom;
    -webkit-animation-duration: 1s;
    animation-name: animatebottom;
    animation-duration: 1s
}

@-webkit-keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0px;
        opacity: 1
    }
}

@keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0;
        opacity: 1
    }
}

*/ #printing {
    display: none;
    text-align: center;
}
        
       
        
    </style>
</head>

<body>
      
    <a id="dlink" style="display:none;"></a>
    <button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport" onclick="tableToExcel('tableid', 'name', 'Linelisting_L_form.xls')"><span
            class="glyphicon glyphicon-download-alt" style="font-size: 15px;"></span> &nbsp;
        Download As Excel
    </button>
    <div id="loader" ></div>
   
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-*  custom">
                <!-- <div id="notPrint">
                    <b style="margin-left: 30%">Start Date : </b><input type="date" id="startDate" required>
                    End Date : <input type="date" id="endDate" required> <br><br><br>
                    <button onClick="genFormA()" id="genformA" style="margin-left: 50%">Generate</button><br><br>
                </div> -->

              
                <div id="printing" >


                    <table width="100%" id="tableid" border="1" class="table  table-hover text-center">
                        <thead>
                            <tr colspan="68" style=" font-weight:400; text-align:center;">
                                <td colspan="20" style="border:1px solid black;background:#A9A9A9; ">Immunization count report</td>
                                    <td colspan="48" style="border:1px solid black;background:#A9A9A9; "> </td>
                            </tr>
                            <tr colspan="68" style=" font-weight:400; text-align:center;">
                                <td colspan="20" style="border:1px solid black;background:#A9A9A9; ">OrganisationUnit :
                                    - <span id="ouname"> </span> </td>
                                    <td colspan="48" style="border:1px solid black;background:#A9A9A9; "> </td>


                            </tr>

                            <!-- <tr colspan="68" style=" font-weight:400; text-align:center;">
                                <td colspan="10" style="border:1px solid black;background:#A9A9A9; "> From : - <span id="start"></span></td>
                                <td colspan="10" style="border:1px solid black;background:#A9A9A9; "> To : - <span id="end"></span>
                                </td>
                                <td colspan="48" style="border:1px solid black;background:#A9A9A9; "> </td>
                            </tr> -->

                            <tr style=" font-weight:400; text-align:center;">
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">S.No</span>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Enrollment
                                    date</span>
                                </td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Name</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">DOH ID no</td>


                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Organization
                                    unit</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">DOB</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">BCG vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">BCG dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">OPV vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> OPV dose given date</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Hepatitis
                                    B vaccine at birth</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Hepatitis
                                        B dose given date</td>
                               
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Hep B 1 vaccine
                                </td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Hep B 1 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Hep B 2 vaccine
                                </td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Hep B 2 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Hep B 3 vaccine
                                </td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Hep B 3 dose given date</td>
                             
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">DPT/Polio
                                    1 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> DPT/Polio 1 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">DPT/polio vaccine
                                    2</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> DPT/polio 2 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">DPT/polio vaccine
                                    3</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">DPT/polio 3 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">DPT/polio vaccine
                                    4</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> DPT/polio 4 dose given date</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">chicken
                                    pox vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> chicken pox dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">HI B-1 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> HI B-1 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">HI B-2 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> HI B-2 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">HI B-3 vaccine</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> HI B-3 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">HI B-4 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> HI B-4 date
                                    given</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Hepatitis
                                    A 1 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Hepatitis A 1 dose given date</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Hepatitis
                                    A2 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Hepatitis A 2 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Measles-1 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Measles-1dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Measles-2 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Measles-2 dose given date</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">MMR vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> MMR dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">IPV vaccine</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> IPV dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Rota-1 vaccine</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Rota-1 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Rota-2 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Rota-2 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Rota-3 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Rota-3 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Typhoid
                                    -1 vaccine</td>

                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Typhoid - 1  dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Typhoid -2 vaccine </td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Typhoid -2 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Vitamin-A1 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Vitamin-A1 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">Vitamin-A2 vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> Vitamin-A2 dose given date</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9">other
                                    vaccine</td>
                                <td style="border:1px solid black;text-align:center;background-color:#A9A9A9"> other dose given date</td>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>

                    <div style="display:flex" id="footer">

                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        var orgUnitUid = dhis2.report.organisationUnit.id;
        var ouname = dhis2.report.organisationUnit.name;
        document.getElementById('ouname').innerHTML = ouname;
        var Total1, Total2, Total3, Total11;
        // var orgUnitChildren = dhis2.report.organisationUnitChildren;
        var url = window.location.href;
        var ouu1 = url.split('=')[2];
        var ou1 = ouu1.split('&')[0];
        var ou2 = ouu1.split('&')[0];
        var flag = 0;





        
            //            if (flag != 1) {
            //                endDate = "";
            //            }

            
            var count_1 = "",
                count_2 = "",
                count_3 = "",
                count_4 = "",
                count_5 = "",
                count_6 = "",
                count_7 = "",
                count_8 = "",
               
                count_10 = "",
                count_11 = "",
                count_12 = "",
                count_13 = "",
                count_14 = "",
                count_15 = "",
                count_16 = "",
                count_17 = "",
                count_18 = "",
                count_19 = "",
                count_20 = "",
                count_21 = "",
                count_22 = "",
                count_23 = "",
                count_24 = "",
                count_25 = "",
                count_26 = "",
                count_27 = "",
                count_28 = "",
                count_29 = "",
                count_30 = "",
                count_31 = "",
                count_32 = "";

                var date1 = 0,
                date2 = 0,
                date3 = 0,
                date4 = 0,
                date5 = 0,
                date6 = 0,
                date7 = 0,
                date8 = 0,
                date9 = 0 ,
                date10 = 0,
                date11 = 0,
                date12 = 0,
                date13= 0 ,
                date14 = 0,
                date15 = 0,
                date16 = 0,
                date17 = 0,
                date18 = 0,
                date19 =0,
                date20=0,
                date21 = 0 ,
                date22 = 0 ,
                date23 = 0,
                date24 = 0 ,
                date25 = 0,
                date26 = 0 ,
                date27 = 0,
                date28 = 0,
                date29 = 0 ,
                date30 = 0 ,
                date31 = 0 ,
                date32 = 0 ;
               var d1 = 0 ,
                d2 = 0,
                d3 = 0,
                d4 = 0,
                d5 = 0 ,
                 d6 = 0,
                d7 = 0,
                d8 = 0 ,
                 d9  = 0,
                 d10 = 0 ,
                 d11 = 0,
                 d12 = 0 ,
                 d13 = 0 ,
                 d14 =  0,
                 d15= 0 ,
                 d16 = 0 ,
                 d17 = 0 ,
                 d18 = 0 ,
                 d19 = 0,
                 d20 = 0,
                 d21= 0,
                 d22 = 0,
                 d23 = 0,
                 d24 = 0,
                 d25 = 0,
                 d26  = 0,
                 d27 = 0,
                 d28 = 0,
                 d29 = 0,
                 d30 = 0,
                 d31 = 0;

                var reportdate1 = 0,
                reportdate2 = 0,
                reportdate3 = 0,
                reportdate4 = 0,
                reportdate5 = 0 ,
                reportdate6 = 0,
                 reportdate7 = 0,
                 reportdate8 = 0 ,
                 reportdate9  = 0,
                 reportdate10 = 0 ,
                 reportdate11 = 0,
                 reportdate12 = 0 ,
                 reportdate13 = 0 ,
                 reportdate14 =  0;


            var rowcount = 0;
            var enrollmentName = "";
            var trackedEntityInstanceId = "";
            var enrollmentDate = "";
            var OrganisationNAme = "";
            var DOH_ID_no = "";
            var DOB = "";
          
           var  EnrollmentDate = "";
           var EventDate1 = "";
           var EventDate2 = "";
           var EventDate3 = "";
           var EventDate4 = "";
           var EventDate5 = "";
           var EventDate6 = "";
           
           var EventDate7 = "";
           var EventDate8 = "";
           var EventDate9 = "";
           var EventDate10 = "";
           var EventDate11 = "";
           var EventDate12 = "";
           
           var EventDate13 = "";
           var EventDate14 = "";
           var EventDate15 = "";
           
           var EventDate16 = "";
           var EventDate17 = "";
           var EventDate18 = "";
           var EventDate19 = "";
           var EventDate20 = "";
           var EventDate21 = "";
           var EventDate22 = "";
           var EventDate23 = "";
           var EventDate24 = "";
           
           var EventDate25 = "";
           var EventDate26 = "";
           var EventDate27 = "";
           var EventDate28 = "";
           var EventDate29 = "";
           var EventDate30 = "";
           var EventDate31 = "";
           var EventDate32 = "";
         
           


            //Ml0ZNj9APN0
            // var startDate = document.getElementById("startDate").value;
            // var endDate = document.getElementById("endDate").value;

            // document.getElementById('start').innerHTML = startDate;
            // document.getElementById('end').innerHTML = endDate;

            $.ajax({
                async: false,
                type: "GET",
                url: "../api/enrollments.json?fields=*&ou=" + orgUnitUid +
                    "&program=vUlEW53A89s&ouMode=DESCENDANTS&paging=false",
                success: function (data1) {
                    var tabledata = '';
                    for (var m = 0; m < data1.enrollments.length; m++)

                    {

                        trackedEntityInstanceId = data1.enrollments[m].trackedEntityInstance;
                        enrollmentDate = data1.enrollments[m].enrollmentDate;
                       
                        OrganisationNAme = data1.enrollments[m].orgUnitName;
                        
                        var enrollmentDatee = enrollmentDate.split("T");
                                          var   enrollmentDateee = enrollmentDatee[0];
                                            EnrollmentDate = formatDate(enrollmentDateee);
                                            console.log("enroll =" + EnrollmentDate);

                               $.ajax({
                            async: false,
                            type: "GET",
                            url: "../api/trackedEntityInstances/" + trackedEntityInstanceId + ".json",
                            success: function (data2) {
                                for(var n = 0; n < data2.attributes.length; n++)
                            
                                {
                                    if(data2.attributes[n].displayName == "Name")
                                    {
                                        enrollmentName = data2.attributes[n].value;
                                        //console.log("trackedEntityInstanceName"+ trackedEntityInstanceName);

                                    }
                                  
                                    if(data2.attributes[n].displayName == "DOH ID No")
                                    {
                                        DOH_ID_no = data2.attributes[n].value;

                                      //  console.log("trackedEntityInstanceName"+ trackedEntityInstanceName);

                                    }
                                    
                                    if(data2.attributes[n].displayName == "DOB")
                                    {
                                        DOB = data2.attributes[n].value;
                                        DOB = formatDate(DOB);
                                       // console.log("trackedEntityInstanceName"+ trackedEntityInstanceName);

                                    }

                                }

                            }})


                        $.ajax({
                            async: false,
                            type: "GET",
                            url: "../api/events.json?fields=orgUnitName,eventDate,trackedEntityInstance,dataValues[dataElement,value]&ou=" + orgUnitUid +
                                "&program=vUlEW53A89s&trackedEntityInstance=" + trackedEntityInstanceId +
                                "&skipPaging=true",
                            success: function (data) {

                                var Pou = "";
                                document.getElementById("tableid").tBodies[0].innerHTML = ""
                               
                                for (var p = 0; p < data.events.length; p++) {
                                    

                                    for (var q = 0; q < data.events[p].dataValues.length; q++) {
                                        if (data.events[p].dataValues[q].dataElement ==
                                            "WpRdnhzs56o") { //BCG
                                            //Total_IP_Fever_Adult
                                            count_1 = data.events[p].dataValues[q].value;
                                          
                                           var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate1 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }

                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "mF6Mzz3BiGV") { //OPV --
                                            //Total_IP_Fever_child
                                            count_2 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate2 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                      
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "gppvuyQmJ6K") { // Hepatitis B at birth
                                            //Total_IP_Fever_adult 24 hours
                                            count_3 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate3 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                      
                                      
                                         

                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "BwyShxcyHcE") { //Hep B 1

                                            count_5 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate5 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                        
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "aPmOt2q1Um8") { // Hep B 2 

                                            count_6 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate6 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "MZS3SVuv8k3") { //Hep B 3
                                            //HUD_Aggregate/Case_Detected_24hrs_IgM
                                            count_7 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate7 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                           
                                       
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "rSPCzvfugtw") { //DPT/ polio 1
                                            //HUD_Aggregate/Dengue_Discharged_24hrs_NS1 
                                            count_10 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate10 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                       
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "x2TBipJcOCL") { //DPT/polio 2
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_11 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate11 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "QXGaxOhDBkH") { // DPT/polio 3
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_12 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate12 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                           
                                             
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "SJwRs0vdXC0") { // DPT/polio 4
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_13 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate13 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                         
                                            
                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "bkWhpgj11vu") { //chikn pox
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_14 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate14 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }

                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "JaZ7NHVsjrr") { //HI B-1 --
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_15 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate15 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "IZYboDiUazi") { //HI B-2 --
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_16 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate16 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                          


                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "Yrm2CsSUDiX") { //HI B-3 --
                                            count_17 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate17 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "JJLBL1qnMJb") { //HI B-4 --
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_18 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate18 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "XwIkuOotzMi") { //Hepatitis A 1
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_19 = data.events[p].dataValues[q].value;
                                           
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate19 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                            
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "GfJX3iXud0p") { //Hepatitis A 2
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_20 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate20 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                         
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "cGfiDql3h4t") { //Measles-1 
                                               
                                            count_21 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate21 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "MeFtRI6zYHW") { //  Measles-2
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_22 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate22 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                          
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "zROXa4cpA3i") { // MMR
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_23 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate23 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                          
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "nIZfBBWeDIo") { // IVP
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_24 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate24 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                         
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "IMYBJWaHibn") { // Rota-1
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_25 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate25 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            

                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "hpPASLvOfOm") { // Rota-2
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_26 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate26 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                         
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "VcBdaEWcPIC") { // Rota-3
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_27 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate27 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                          
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "pzVZJyCpysJ") { //Typhoid -1
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_28 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate28 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                         
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "T1oAGE6itWo") { //Typhoid -2
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_29 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate29 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                          
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "xgQvTlD7l2v") { //Vitamin-A1
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_30 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate30 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                        
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "hqVCQFOIiGT") { //Vitamin-A2
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_31 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate31 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                           
                                        }  if (data.events[p].dataValues[q].dataElement ==
                                            "rhzhPoZGvKI") { //other vaccine
                                            //HUD_Aggregate/Dengue_+ve_24hrs_IG1
                                            count_32 = data.events[p].dataValues[q].value;
                                            var  eventdate = data.events[p].eventDate;
                                            if((eventdate != undefined) && (eventdate != "") && (eventdate != 0) && (eventdate != "undefined") ){
                                    
                                            var  eventdatee = eventdate.split("T");
                                             var  eventdateee = eventdatee[0];
                                             EventDate32 = formatDate(eventdateee);
                                          // console.log("EventDate" + EventDate);
                                             }
                                            else
                                            {

                                            }
                                            
                                          
                                            

                                        }
                                    }


                                }
                              

                                          if((count_1 == 0) || (count_1 =="") || (count_1 == undefined) || (count_1 == "undefined")){
                                            count_1 = "No";
                                             }
                                             else
                                               {
                                            count_1 = "yes";
                                              }

                                
                                         
                                           
                                      
                                            if((count_2 == 0) || (count_2 =="") || (count_2 == undefined) || (count_2 == "undefined")){
                                            count_2 = "No";
                                             }
                                             else
                                               {
                                            count_2 = "yes";
                                              }
                                      
                                            if((count_3 == 0) || (count_3 =="") || (count_3 == undefined) || (count_3 == "undefined")){
                                            count_3 = "No";
                                             }
                                             else
                                               {
                                            count_3 = "yes";
                                              }
                                      
                                     

                                         

                                      
                                            if((count_5 == 0) || (count_5 =="") || (count_5 == undefined) || (count_5 == "undefined")){
                                            count_5 = "No";
                                             }
                                             else
                                               {
                                            count_5 = "yes";
                                              }
                                        
                                    
                                            if((count_6 ==0 ) || (count_6 =="") || (count_6 == undefined) || (count_6 == "undefined")){
                                            count_6 = "No";
                                             }
                                             else
                                               {
                                            count_6 = "yes";
                                              }
                                           
                                     
                                            if((count_7 == 0) || (count_7 =="") || (count_7 == undefined) || (count_7 == "undefined")){
                                            count_7 = "No";
                                             }
                                             else
                                               {
                                            count_7 = "yes";
                                              }
                                           
                                      
                                      
                                            if((count_10 == 0) || (count_10 =="") || (count_10 == undefined) || (count_10 == "undefined")){
                                            count_10 = "No";
                                             }
                                             else
                                               {
                                            count_10 = "yes";
                                              }
                                       
                                       
                                            if((count_11 == 0) || (count_11 =="") || (count_11 == undefined) || (count_11 == "undefined")){
                                            count_11 = "No";
                                             }
                                             else
                                               {
                                            count_11 = "yes";
                                              }
                                           
                                     
                                            if((count_12 == 0) || (count_12 =="") || (count_12 == undefined) || (count_12 == "undefined")){
                                            count_12 = "No";
                                             }
                                             else
                                               {
                                            count_12 = "yes";
                                              }
                                           
                                             
                                       
                                            if((count_13 == 0) || (count_13 =="") || (count_13 == undefined) || (count_13 == "undefined")){
                                               
                                            count_13 = "No";
                                             }
                                             else
                                               {
                                            count_13 = "yes";
                                              }
                                         
                                            
                                           
                                     
                                            if((count_14 == 0) || (count_14 =="") || (count_14 == undefined) || (count_14 == "undefined")){
                                            count_14 = "No";
                                             }
                                             else
                                               {
                                            count_14 = "yes";
                                              }
                                            
                                            

                                   
                                            if((count_15 == 0) || (count_14 =="") || (count_15 == undefined) || (count_15 == "undefined")){
                                            count_15 = "No";
                                             }
                                             else
                                               {
                                            count_15 = "yes";
                                              }
                                            
                                            
                                           
                                  
                                            if((count_16 == 0) || (count_16 =="") || (count_16 == undefined) || (count_16 == "undefined")){
                                            count_16 = "No";
                                             }
                                             else
                                               {
                                            count_16 = "yes";
                                              }
                                            
                                            
                                          


                                    
                                            if((count_17 == 0) || (count_17 =="") || (count_17 == undefined) || (count_17 == "undefined")){
                                            count_17 = "No";
                                             }
                                             else
                                               {
                                            count_17 = "yes";
                                              }
                                            
                                           
                                   
                                           
                                            if((count_18 == 0) || (count_18 =="") || (count_18 == undefined) || (count_18 == "undefined")){
                                            count_18 = "No";
                                             }
                                             else
                                               {
                                            count_18 = "yes";
                                              }
                                            
                                      
                                           
                                            if((count_19 == 0) || (count_19 =="") || (count_19 == undefined) || (count_19 == "undefined")){
                                            count_19 = "No";
                                             }
                                             else
                                               {
                                            count_19 = "yes";
                                              }
                                            
                                            
                                      
                                            if((count_20 == 0) || (count_20 =="") || (count_20 == undefined) || (count_20 == "undefined")){
                                            count_20 = "No";
                                             }
                                             else
                                               {
                                            count_20 = "yes";
                                              }
                                            
                                         
                                    
                                            if((count_21 == 0) &&( count_21 =="") || (count_21 == undefined) || (count_21 == "undefined")){
                                            count_21 = "No";
                                             }
                                             else
                                               {
                                            count_21 = "yes";
                                              }
                                            
                                           
                                    
                                            if((count_22 == 0) || (count_22 =="") || (count_22 == undefined) &&(count_22 == "undefined")){
                                            count_22 = "No";
                                             }
                                             else
                                               {
                                            count_22 = "yes";
                                              }
                                            
                                          
                                    
                                            if((count_23 == 0 )&& (count_23 =="") || (count_23 == undefined) || (count_23 == "undefined")){
                                            count_23 = "No";
                                             }
                                             else
                                               {
                                            count_23 = "yes";
                                              }
                                            
                                          
                                     
                                            if((count_24 == 0) || (count_24 =="" )&& (count_24 == undefined) || (count_24 == "undefined")){
                                            count_24 = "No";
                                             }
                                             else
                                               {
                                            count_24 = "yes";
                                              }
                                            
                                   
                                            if((count_25 == 0) || (count_25 =="") || (count_25 == undefined) || (count_25 == "undefined")){
                                            count_25 = "No";
                                             }
                                             else
                                               {
                                            count_25 = "yes";
                                              }
                                            

                                            if((count_26 == 0) || (count_26 =="") || (count_26 == undefined) || (count_26 == "undefined")){
                                            count_26 = "No";
                                             }
                                             else
                                               {
                                            count_26 = "yes";
                                              }
                                            
                                         
                                      
                                            if((count_27 == 0) || (count_27 =="") || (count_27 == undefined) || (count_27 == "undefined")){
                                            count_27 = "No";
                                             }
                                             else
                                               {
                                            count_27 = "yes";
                                              }
                                            
                                          
                                      
                                            if((count_28 == 0) || (count_28 =="") || (count_28 == undefined) || (count_28 == "undefined")){
                                            count_28 = "No";
                                             }
                                             else
                                               {
                                            count_28 = "yes";
                                              }
                                            
                                         
                                    
                                            if((count_29 == 0) || (count_29 =="") || (count_29 == undefined) || (count_29 == "undefined")){
                                            count_29 = "No";
                                             }
                                             else
                                               {
                                            count_29 = "yes";
                                              }
                                            
                                          
                                        
                                            if((count_30 == 0) || (count_30 =="") || (count_30 == undefined) || (count_30 == "undefined")){
                                            count_30 = "No";
                                             }
                                             else
                                               {
                                            count_30 = "yes";
                                              }
                                            
                                        
                                      
                                            if((count_31 == 0) || (count_31 =="") || (count_31 == undefined) || (count_31 == "undefined")){
                                            count_31 = "No";
                                             }
                                             else
                                               {
                                            count_31 = "yes";
                                              }
                                            
                                           
                                     
                                            if((count_32 == 0) || (count_32 =="") || (count_32 == undefined) || (count_32 == "undefined")){
                                            count_32 = "No";
                                             }
                                             else
                                               {
                                            count_32 = "yes";
                                              }


                                              if( count_1 == "No"){
                                                  EventDate1 = "-"
                                              }
                                             
                                              if( count_2 == "No"){
                                                  EventDate2 = "-"
                                              }
                                             
                                              if( count_3 == "No"){
                                                  EventDate3 = "-"
                                              }
                                             
                                              
                                             
                                              if( count_5 == "No"){
                                                  EventDate5 = "-"
                                              }
                                             
                                              if( count_6 == "No"){
                                                  EventDate6 = "-"
                                              }
                                              
                                              if( count_7 == "No"){
                                                  EventDate7 = "-"
                                              }
                                              
                                             
                                              
                                             
                                              if( count_10 == "No"){
                                                  EventDate10 = "-"
                                              }
                                             
                                              if( count_11 == "No"){
                                                  EventDate11 = "-"
                                              }
                                              
                                              if( count_12 == "No"){
                                                  EventDate12 = "-"
                                              }
                                             
                                              if( count_13 == "No"){
                                                  EventDate13 = "-"
                                              }
                                             
                                              if( count_14 == "No"){
                                                  EventDate14 = "-"
                                              }
                                             
                                              if( count_15 == "No"){
                                                  EventDate15 = "-"
                                              }
                                             
                                              if( count_16 == "No"){
                                                  EventDate16 = "-"
                                              }
                                             
                                              if( count_17 == "No"){
                                                  EventDate17 = "-"
                                              }
                                             
                                              if( count_18 == "No"){
                                                  EventDate18 = "-"
                                              }
                                             
                                              if( count_19 == "No"){
                                                  EventDate19 = "-"
                                              }
                                             
                                              if( count_20 == "No"){
                                                  EventDate20 = "-"
                                              }
                                             
                                              if( count_21 == "No"){
                                                  EventDate21 = "-"
                                              }
                                             
                                              if( count_22 == "No"){
                                                  EventDate22 = "-"
                                              }
                                             
                                              if( count_23 == "No"){
                                                  EventDate23 = "-"
                                              }
                                             
                                              if( count_24 == "No"){
                                                  EventDate24 = "-"
                                              }
                                             
                                              if( count_25 == "No"){
                                                  EventDate25 = "-"
                                              }
                                             
                                              if( count_26 == "No"){
                                                  EventDate26 = "-"
                                              }
                                             
                                              if( count_27 == "No"){
                                                  EventDate27 = "-"
                                              }
                                             
                                              if( count_28 == "No"){
                                                  EventDate28 = "-"
                                              }
                                              
                                              if( count_29 == "No"){
                                                  EventDate29 = "-"
                                              }
                                             
                                              if( count_30 == "No"){
                                                  EventDate30 = "-"
                                              }
                                             
                                              if( count_31 == "No"){
                                                  EventDate31 = "-"
                                              }
                                             
                                              if( count_32 == "No"){
                                                  EventDate32 = "-"
                                              }
                                             
                                             



                                rowcount++;

                               

                                tabledata += "<tr><td colspan = '1'>" +
                                    rowcount + " </td><td colspan = '1'>" + EnrollmentDate +
                                    " </td><td colspan = '1'>" + enrollmentName +" </td><td colspan = '1'>"+ DOH_ID_no +" </td><td colspan = '1'> "+ OrganisationNAme +"</td><td colspan = '1'> "+ DOB +"</td><td colspan = '1'>" +
                                    count_1 + " </td><td colspan = '1'>" + EventDate1 +
                                    " </td><td colspan = '1'>" + count_2 +
                                    " </td><td colspan = '1' if(>" + EventDate2 +
                                    " </td><td colspan = '1'>" + count_3 +
                                    " </td><td colspan = '1'>" + EventDate3 +
                                    " </td><td colspan = '1'>" + count_5 +
                                    " </td><td colspan = '1'>" + EventDate5 +
                                    " </td><td colspan = '1'>" + count_6 +
                                    " </td><td colspan = '1'>" + EventDate6 +
                                    " </td><td colspan = '1'>" + count_7 +
                                    " </td><td colspan = '1'>" + EventDate7 +
                                    " </td><td colspan = '1'>" + count_10 +
                                    " </td><td colspan = '1'>" + EventDate10 +
                                    " </td><td colspan = '1'>" + count_11 +
                                    " </td><td colspan = '1'>" + EventDate11 +
                                    " </td><td colspan = '1'>" + count_12 +
                                    " </td><td colspan = '1'>" + EventDate12 +
                                    " </td><td colspan = '1'>" + count_13 +
                                    " </td><td colspan = '1'>" + EventDate13 +
                                    " </td><td colspan = '1'>" + count_14 +
                                    " </td><td colspan = '1'>" + EventDate14 +
                                    " </td><td colspan = '1'>" + count_15 +
                                    " </td><td colspan = '1'>" + EventDate15 +
                                    " </td><td colspan = '1'>" + count_16 +
                                    " </td><td colspan = '1'>" + EventDate16 +
                                    " </td><td colspan = '1'>" + count_17 +
                                    " </td><td colspan = '1'>" + EventDate17 +
                                    " </td><td colspan = '1'>" + count_18 +
                                    " </td><td colspan = '1'>" + EventDate18 +
                                    " </td><td colspan = '1'>" + count_19 +
                                    " </td><td colspan = '1'>" + EventDate19 +
                                    " </td><td colspan = '1'>" + count_20 +
                                    " </td><td colspan = '1'>" + EventDate20 +
                                    " </td><td colspan = '1'>" + count_21 +
                                    " </td><td colspan = '1'>" + EventDate21 +
                                    " </td><td colspan = '1'>" + count_22 +
                                    " </td><td colspan = '1'>" + EventDate22 +
                                    " </td><td colspan = '1'>" + count_23 +
                                    " </td><td colspan = '1'>" + EventDate23 +
                                    " </td><td colspan = '1'>" + count_24 +
                                    " </td><td colspan = '1'>" + EventDate24 +
                                    " </td><td colspan = '1'>" + count_25 +
                                    " </td><td colspan = '1'>" + EventDate25 +
                                    " </td><td colspan = '1'>" + count_26 +
                                    " </td><td colspan = '1'>" + EventDate26 +
                                    " </td><td colspan = '1'>" + count_27 +
                                    " </td><td colspan = '1'>" + EventDate27 +
                                    " </td><td colspan = '1'>" + count_28 +
                                    " </td><td colspan = '1'>" + EventDate28 +
                                    " </td><td colspan = '1'>" + count_29 +
                                    " </td><td colspan = '1'>" + EventDate29 +
                                    " </td><td colspan = '1'>" + count_30 +
                                    " </td><td colspan = '1'>" + EventDate30 +
                                    " </td><td colspan = '1'>" + count_31 +
                                    " </td><td colspan = '1'>" + EventDate31 +
                                    " </td><td colspan = '1'>" + count_32 +
                                    " </td><td colspan = '1'>" + EventDate32 + " </td></tr>";

                                   


                                   


                                   

                                document.getElementById("tableid").tBodies[0].innerHTML +=
                                    tabledata;
                                    document.getElementById("loader").style.display = "none";
                                    document.getElementById("printing").style.display = "block";


                                   
                                  count_1 = "",
                count_2 = "",
                count_3 = "",
                count_4 = "",
                count_5 = "",
                count_6 = "",
                count_7 = "",
                count_8 = "",
               
                count_10 = "",
                count_11 = "",
                count_12 = "",
                count_13 = "",
                count_14 = "",
                count_15 = "",
                count_16 = "",
                count_17 = "",
                count_18 = "",
                count_19 = "",
                count_20 = "",
                count_21 = "",
                count_22 = "",
                count_23 = "",
                count_24 = "",
                count_25 = "",
                count_26 = "",
                count_27 = "",
                count_28 = "",
                count_29 = "",
                count_30 = "",
                count_31 = "",
                count_32 = "";

                EventDate = "";
                EventDate1 = "";
            EventDate2 = "";
            EventDate3 = "";
            EventDate4 = "";
            EventDate5 = "";
            EventDate6 = "";
           
            EventDate7 = "";
            EventDate8 = "";
            EventDate9 = "";
            EventDate10 = "";
            EventDate11 = "";
            EventDate12 = "";
           
            EventDate13 = "";
            EventDate14 = "";
            EventDate15 = "";
           
            EventDate16 = "";
            EventDate17 = "";
            EventDate18 = "";
            EventDate19 = "";
            EventDate20 = "";
            EventDate21 = "";
            EventDate22 = "";
            EventDate23 = "";
            EventDate24 = "";
           
            EventDate25 = "";
            EventDate26 = "";
            EventDate27 = "";
            EventDate28 = "";
            EventDate29 = "";
            EventDate30 = "";
            EventDate31 = "";
            EventDate32 = "";

                                    
           



                            }
                        });

                    }

                }
            });

function formatDate (input) {
    if ((input == undefined) || (input == "-") ||  (input == 0)|| (input == 10) ){
return true;
    }
    else{
    var datePart = input.split('-');    
//   var datePart = input.match(/\d+/g),
   year = datePart[0]; // get only two digits
  month = datePart[1];
   day = datePart[2];

  return day + '-'+ month + '-' + year;
    }
}


      

        var tableToExcel = (function () {
            var uri = 'data:application/vnd.ms-excel;base64,',
                template =
                '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
                base64 = function (s) {
                    return window.btoa(unescape(encodeURIComponent(s)))
                },
               
                format = function (s, c) {
                    return s.replace(/{(\w+)}/g, function (m, p) {
                        return c[p];
                    })
                }
            return function (table, name, filename) {
                if (!table.nodeType) table = document.getElementById(table)
                var ctx = {
                    worksheet: name || 'Worksheet',
                    table: table.innerHTML
                }

                document.getElementById("dlink").href = uri + base64(format(template, ctx));
                document.getElementById("dlink").download = filename;
                document.getElementById("dlink").click();

            }
        })()
    </script>
</body>

</html>