<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
    crossorigin="anonymous">

<style>
    thead>tr>td {
        font-weight: bold;
    }
    /* Center the loader  */

    #loader {
        position: absolute;
        left: 50%;
        top: 50%;
        z-index: 1;
        width: 150px;
        height: 150px;
        margin: -75px 0 0 -75px;
        border: 16px solid #f3f3f3;
        border-radius: 50%;
        border-top: 16px solid #34B4DB;
        width: 120px;
        height: 120px;
        -webkit-animation: spin 2s linear infinite;
        animation: spin 2s linear infinite;
    }

    @-webkit-keyframes spin {
        0% {
            -webkit-transform: rotate(0deg);
        }
        100% {
            -webkit-transform: rotate(360deg);
        }
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
    /* Add animation to "page content" */

    .animate-bottom {
        position: relative;
        -webkit-animation-name: animatebottom;
        -webkit-animation-duration: 1s;
        animation-name: animatebottom;
        animation-duration: 1s
    }

    @-webkit-keyframes animatebottom {
        from {
            bottom: -100px;
            opacity: 0
        }
        to {
            bottom: 0px;
            opacity: 1
        }
    }

    @keyframes animatebottom {
        from {
            bottom: -100px;
            opacity: 0
        }
        to {
            bottom: 0;
            opacity: 1
        }
    }

    */ #printing {
        display: none;
        text-align: center;
    }
</style>
<a id="dlink" style="display:none;"></a>

<button type="button" id="btnBack" class="btn brn-default btn-sm" style="vertical-align: middle;" onclick="location.href='../api/apps/Report-App/index.html#/generate-report'"><span
    class="glyphicon glyphicon-chevron-left" style="font-size: 15px;"></span>&nbsp; Goto Report Selection Page
</button>
<button type="button" class="btn btn-primary btn-sm" style="vertical-align: middle;" onclick="printContent('printing')"><span class="glyphicon glyphicon-print" style="font-size: 15px;"></span> &nbsp;
Print
</button>
<button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport" onclick="tableToExcel('dataTable', 'name', 'MPR- Quarterly Reporting Format (DTCC to STCC)-STATE.xls')"><span class="glyphicon glyphicon-download-alt" style="font-size: 15px;"></span> &nbsp;
Download As Excel
</button>

<br><br>
<div id="loader"></div>
<div id="printing" style="display:none;" class="animate-bottom">
    <div id='state'>
        <table width="100%" id="dataTable" border="1" class="table table-bordered table-hover text-center" cellspacing="6" cellpadding="4">
            <thead style="background:#ADD8E6; font-weight:400; text-align:center">
                <tr style="background:#ADD8E6; font-weight:400; text-align:center; ">
                    <td style="border:1px solid black" colspan="84">MPR- Quarterly Reporting Format (DTCC to STCC)</td>
                </tr>
                <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                    <td style="border:1px solid black" colspan="6">Organisation Unit:- <span id="ouname"></span></td>
                    <td style="border:1px solid black; text-align:left" colspan="78">TimeStamp:-<span id="timeStamp"></span></td>
                </tr>
                <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                    <td style="border:1px solid black" colspan="6">Year:- 2017-18</td>
                    <td style="border:1px solid black" colspan="78">&nbsp;</td>
                </tr>
                <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                    <td style="border:1px solid black" colspan="6">Reporting month:-<span id="periodName"></span></td>
                    <td style="border:1px solid black" colspan="78">&nbsp;</td>
                </tr>
                <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                    <td style="border:1px solid black" rowspan="3">SN</td>
                    <td style="border:1px solid black" rowspan="3" width="123" id="level1"></td>
                   <!--<td style="border:1px solid black" rowspan="2" width="123" id="level2"></td>-->
                    <td style="border:1px solid black" rowspan="3" width="111">Name of the district</td>
                    <td style="border:1px solid black" rowspan="3"  width="111">Whether District Cell has been set up (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="111">Whether TCC has been set up (including procurement of equipments) (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="111">Status of recruitment of staff in the District Cell (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="111">District Consultant </td>
                    <td style="border:1px solid black" rowspan="3"  width="111">Psychologist </td>
                    <td style="border:1px solid black" rowspan="3"  width="111">Social Worker</td>
                    <td style="border:1px solid black" rowspan="3"  width="111">Any other</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether District Level Co-ordination Committee (DLCC) has been constituted (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether COTPA and its rules have been displayed on the official district website (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether challaning mechanism for COTPA has been set up at District Level (Yes/No</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether separate head of account has been opened for deposit of challan amount at district level (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether challan books have been received from STCC (Yes/No) </td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether challan books have been distributed to authorized officers (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether enforcement squads have been set up in the district to monitor compliance of COTPA (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether compliance of COTPA has been integrated in the monthly crime review meetings(kindly share monthly reports with the STCC) (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether Utilization Certificate has been submitted for the previous financial year (Yes/No)</td>
                    <td style="border:1px solid black" rowspan="3"  width="112">Whether Statement of Expenditure has been submitted for the previous financial year (Yes/No)</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">No. of meetings of the DLCC with dates</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">No. Visits conducted by the enforcement squads</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">Persons challaned and amount collected (information to be given month-wise in the format as annexed) </td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">Complaints received through National Violations helpline</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">Details of such complaints where action has been taken</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">Trainings/Sensitization programmes for different stakeholders organized by DTCC</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">Participants in the trainings/sensitization programmes organized</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">No. and types of IEC materials adapted/ developed by DTCC  (e.g. posters/stickers/handouts/wall paintings/hoardings etc)</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2"  width="112">No. of  PHCs, CHCs, Govt buildings, schools and other public places covered with these IEC materials</td>
                    <td style="border:1px solid black" colspan="6" width="112">Schools covered in the School Programmes by the DTCC</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">Details of Children covered in the School Programmes</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">Details of  School  Programmes conducted</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">Details of meetings held with other relevant State Govt. departments</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">Details of training programs of other departments in which DTCC participated and made presentations on tobacco control</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">Details of meetings held with civil society organizations and professional bodies (e.g. NGOs, NSS, NCC, IDA, IMA etc)</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">No. of Blocks where Block Level Coordination Committees have been set up</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">No. of villages where Village Level Committees have been set up</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">Details of TCC set up in the district (indicate separately details of TCCs set uo in the district hospital, other government set ups, NGOs, private set ups etc. )</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">a.Whether Staff is in place in these TCCs</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">b.Whether counselors working in these TCCs are formally Trained in cessation activities (indicate separately the total number of counselors in place and the number of counselors who have received formal training)  </td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">c.Have the TCCs arranged for any cessation trainings for healthcare providers/workers? If yes, indicate the number of trainings undertaken with details </td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">d.No. of FGD done in Quarter </td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">e.Whether pharmacological treatment of tobacco dependence is available</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">f.Whether equipments such as Carbon Monoxide monitor and Spirometer have been procured</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">g.No. of persons who availed services at the TCCs</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">i) Number of person who received counseling </td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">ii) Number of persons who received pharmacotherapy </td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">iii) Number of persons who received both</td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">iv) Number of person who quit tobacco after counseling </td>
                    <td style="border:1px solid black" colspan="2" rowspan="2" width="112">h. Other activities during the month you want to share with STCC</td>
                    
                  
                    
                </tr>
                <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                    <td colspan="2" style="border:1px solid black" width="108">(i) Public Schools</td>
                    <td colspan="2" style="border:1px solid black" width="115">(ii) Private Schools</td>
                    <td colspan="2" style="border:1px solid black" width="108">(iii) Coaching</td>
                    
                </tr>
                <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                     
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    <td style="border:1px solid black" width="60">Quarterly</td>
                    <td style="border:1px solid black" width="51">Cumu.</td>
                    

                    
                    
                   
                </tr>
            </thead>
        </table>

    </div>
</div>
<!-- printing script -->
<script type="text/javascript">
    function printContent(el) {
        var restorepage = document.body.innerHTML;
        var printcontent = document.getElementById(el).innerHTML;
        document.body.innerHTML = printcontent;
        window.print();
        document.body.innerHTML = restorepage;
    }

</script>

<script>
    // Code fr date and time stamp
    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth() + 1; //January is 0!
    var yyyy = today.getFullYear();

    if (dd < 10) {
        dd = '0' + dd
    }

    if (mm < 10) {
        mm = '0' + mm
    }

    today = mm + '/' + dd + '/' + yyyy;



    function displayTime() {
        var str = "";

        var currentTime = new Date()
        var hours = currentTime.getHours()
        var minutes = currentTime.getMinutes()
        var seconds = currentTime.getSeconds()

        if (minutes < 10) {
            minutes = "0" + minutes
        }
        if (seconds < 10) {
            seconds = "0" + seconds
        }
        str += hours + ":" + minutes + ":" + seconds + " ";
        if (hours > 11) {
            str += "PM"
        } else {
            str += "AM"
        }
        return str;
    }


    document.getElementById('timeStamp').innerHTML = today + "-" + displayTime();

</script>

<script>
    // How to force async functions to execute sequentially 
    // by using deferred pipe chaining.

    // The master deferred.
    var dfd = $.Deferred(),  // Master deferred
        dfdNext = dfd; // Next deferred in the chain
    x = 0, // Loop index
        values = [], // Saves loop values because functions are called after loop finishes


        // Simulates $.ajax, but with predictable behaviour.
        // You only need to understand that higher 'value' param will finish earlier.
        simulateAjax = function (value) {
            var dfdAjax = $.Deferred();
     
            var res4 = $.ajax(
                {
                    type: "GET",
                    url: "../api/analytics.json?dimension=dx:RtOaSIHiuge.Ti9FJqkSK6J;HbBhkEQsQWD.Ti9FJqkSK6J;ywkxAqOdlmJ.Ti9FJqkSK6J;XLeq3SqsZcZ.al2NuvITR0p;XLeq3SqsZcZ.Ulk5zlEzXeV;XLeq3SqsZcZ.wDLCGzD2cDD;XLeq3SqsZcZ.h2Vrexr6NTU;n2QRdX6158V.Ti9FJqkSK6J;CDbmNLvSGco.Ti9FJqkSK6J;v02GFnzZSO8.Ti9FJqkSK6J;uYFDAcfLRSM.Ti9FJqkSK6J;tjAQzqSjkDQ.Ti9FJqkSK6J;OChco5ML9uc.Ti9FJqkSK6J;lAupbr69nh1.Ti9FJqkSK6J;KlY36scyeBE.Ti9FJqkSK6J;IrZpUPK6kdz.Ti9FJqkSK6J;j28udeo9tIb.Ti9FJqkSK6J;CXKge3o94vi.qQ5QJ8fcrGX;f8iY8UeMB2r.qQ5QJ8fcrGX;RT4QZ1ZsX7F.qQ5QJ8fcrGX;i5xrZvHbx4y.qQ5QJ8fcrGX;UpdJ1N7DN2c.qQ5QJ8fcrGX;mnIwNFnaEeB.qQ5QJ8fcrGX;IlkdVZ5HJzQ.qQ5QJ8fcrGX;m7cqECIjVjf.qQ5QJ8fcrGX;VzGePaoQWeF.qQ5QJ8fcrGX;fGa3njErIPF.qQ5QJ8fcrGX;m1j7p2NeLOs.qQ5QJ8fcrGX;hBxK0rdid2u.qQ5QJ8fcrGX;XcnSOnvy3TK.qQ5QJ8fcrGX;DpdPHER9ARi.qQ5QJ8fcrGX;MhMtvMcnJj7.qQ5QJ8fcrGX;AfEqeI1KnGS.qQ5QJ8fcrGX;udhdpTQ0glB.qQ5QJ8fcrGX;KynVPUios59.qQ5QJ8fcrGX;bQpSbqiWLk7.qQ5QJ8fcrGX;q2TUNhj8Z9F.qQ5QJ8fcrGX;VDFjmnbUkis.qQ5QJ8fcrGX;TG18zo2Lv7S.qQ5QJ8fcrGX;COqwksEkJL2.qQ5QJ8fcrGX;spWOjsz6UyL.qQ5QJ8fcrGX;u9XN4DTKCQp.qQ5QJ8fcrGX;xGYogvZU9QT.qQ5QJ8fcrGX;D0hfiEuLSyD.qQ5QJ8fcrGX;i4tTtjhFLk0.qQ5QJ8fcrGX;UlmKlz5gCKq.qQ5QJ8fcrGX;lURot0Njutj.qQ5QJ8fcrGX;fBKDpQMokQS.qQ5QJ8fcrGX;OBeITwYWy4r.qQ5QJ8fcrGX;&dimension=pe:"+gotPeriod+"&filter=ou:"+value+"&displayProperty=NAME",
                    data: JSON,
                    success: function (data4, status) {

                        $.ajax(
                            {
                                type: "GET",
                                url: "../api/analytics.json?dimension=dx:RtOaSIHiuge.Ti9FJqkSK6J;HbBhkEQsQWD.Ti9FJqkSK6J;ywkxAqOdlmJ.Ti9FJqkSK6J;XLeq3SqsZcZ.al2NuvITR0p;XLeq3SqsZcZ.Ulk5zlEzXeV;XLeq3SqsZcZ.wDLCGzD2cDD;XLeq3SqsZcZ.h2Vrexr6NTU;n2QRdX6158V.Ti9FJqkSK6J;CDbmNLvSGco.Ti9FJqkSK6J;v02GFnzZSO8.Ti9FJqkSK6J;uYFDAcfLRSM.Ti9FJqkSK6J;tjAQzqSjkDQ.Ti9FJqkSK6J;OChco5ML9uc.Ti9FJqkSK6J;lAupbr69nh1.Ti9FJqkSK6J;KlY36scyeBE.Ti9FJqkSK6J;IrZpUPK6kdz.Ti9FJqkSK6J;j28udeo9tIb.Ti9FJqkSK6J;CXKge3o94vi.qQ5QJ8fcrGX;f8iY8UeMB2r.qQ5QJ8fcrGX;RT4QZ1ZsX7F.qQ5QJ8fcrGX;i5xrZvHbx4y.qQ5QJ8fcrGX;UpdJ1N7DN2c.qQ5QJ8fcrGX;mnIwNFnaEeB.qQ5QJ8fcrGX;IlkdVZ5HJzQ.qQ5QJ8fcrGX;m7cqECIjVjf.qQ5QJ8fcrGX;VzGePaoQWeF.qQ5QJ8fcrGX;fGa3njErIPF.qQ5QJ8fcrGX;m1j7p2NeLOs.qQ5QJ8fcrGX;hBxK0rdid2u.qQ5QJ8fcrGX;XcnSOnvy3TK.qQ5QJ8fcrGX;DpdPHER9ARi.qQ5QJ8fcrGX;MhMtvMcnJj7.qQ5QJ8fcrGX;AfEqeI1KnGS.qQ5QJ8fcrGX;udhdpTQ0glB.qQ5QJ8fcrGX;KynVPUios59.qQ5QJ8fcrGX;bQpSbqiWLk7.qQ5QJ8fcrGX;q2TUNhj8Z9F.qQ5QJ8fcrGX;VDFjmnbUkis.qQ5QJ8fcrGX;TG18zo2Lv7S.qQ5QJ8fcrGX;COqwksEkJL2.qQ5QJ8fcrGX;spWOjsz6UyL.qQ5QJ8fcrGX;u9XN4DTKCQp.qQ5QJ8fcrGX;xGYogvZU9QT.qQ5QJ8fcrGX;D0hfiEuLSyD.qQ5QJ8fcrGX;i4tTtjhFLk0.qQ5QJ8fcrGX;UlmKlz5gCKq.qQ5QJ8fcrGX;lURot0Njutj.qQ5QJ8fcrGX;fBKDpQMokQS.qQ5QJ8fcrGX;OBeITwYWy4r.qQ5QJ8fcrGX;&dimension=pe:"+periodcumulative+"&filter=ou:"+value+"&displayProperty=NAME",
                                data: JSON,
                                success: function (data5, status) {
                                    dfdAjax.resolve(data4, data5);
                                }
                            });

                    }
                });

            return dfdAjax.promise();
        },
        // This would be a user function that makes an ajax request
        requestAjax = function (value) {
            // console.log('requestAjax with value: ' + value);
            return simulateAjax(value);
        };

    // Start the pipe chain.  You should be able to do this anywhere in the program, even
    // at the end,and it should still give the same results.
    // console.log('Setting off the pipes...');
    dfd.resolve();

    //Defferd code ends here 


    var periods = dhis2.report.periods;
    var period = periods[0];

    var periodName = getPeriod(period);

   

    var url = window.location.href;
    var params = url.split('=');
    var gotOrgUnit = params[3];
    var gotPeriod = params[2].toString().substring(0, 6);
    var periodArray = getcumulative();
    var periodcum = periodArray.toString();
    var periodcumulative = periodcum.replace(/,/g, "");

    var viewperiod;
    if(gotPeriod.substring(4,6)=="Q1")
    {
        viewperiod="January to March"+"-"+gotPeriod.substring(0,4);
    }
    if(gotPeriod.substring(4,6)=="Q2")
    {
        viewperiod="April to June"+"-"+gotPeriod.substring(0,4);
    }
    if(gotPeriod.substring(4,6)=="Q3")
    {
        viewperiod="July to September"+"-"+gotPeriod.substring(0,4);
    }
    if(gotPeriod.substring(4,6)=="Q4")
    {
        viewperiod="October to December"+"-"+gotPeriod.substring(0,4);
    }


    document.getElementById('periodName').innerHTML = viewperiod;


    var selOrgUnitLevel = dhis2.report.organisationUnitHierarchy.length;


    if (selOrgUnitLevel == 2) {
        document.getElementById('level1').innerHTML = "Division Name";
       // document.getElementById('level2').innerHTML = "District Name";
    }
    else if (selOrgUnitLevel == 3) {
        document.getElementById('level1').innerHTML = "Division Name";
       // document.getElementById('level2').innerHTML = "Block Name";
    }
    else if (selOrgUnitLevel == 4) {
        document.getElementById('level1').innerHTML = "Division Name";
        //document.getElementById('level2').innerHTML = "Facility Name";
    }






    var count = 0;

    var value3 = 0;
    var value4 = 0;
    var value5 = 0;
    var value6 = 0;
    var value7 = 0;
    var value8 = 0;
    var value9 = 0;
    var value10 = 0;
    var value11 = 0;
    var value12 = 0;
    var value13 = 0;
    var value14 = 0;
    var value15 = 0;
    var value16 = 0;
    var value17 = 0;
    var value18 = 0;
    var value19 = 0;
    var value20 = 0;
    var value21 = 0;
    var value22 = 0;
    var value23 = 0;
    var value24 = 0;
    var value25 = 0;
    var value26 = 0;
    var value27 = 0;
    var value28 = 0;
    var value29 = 0;
    var value30 = 0;
    var value31 = 0;
    var value32 = 0;
   
    var value33 =0;
    var value34 =0;
    var value35 =0;
    var value36 =0;
    var value37 =0;
    var value38 =0;
    var value39 =0;
    var value40 =0;
    var value41 =0;
    var value42 =0;
    var value43 =0;
    var value44 =0;
    var value45 =0;
    var value46 =0;
    var value47 =0;
    var value48 =0;
    var value49 =0;
    var value50 =0;
    var value51 =0;
    var value52 =0;
    var value53 =0;
    var value54 =0;
    var value55 =0;
    var value56 =0;
    var value57 =0;
    var value58 =0;
    var value59 =0;
    var value60 =0;
    var value61 =0;
    var value62 =0;
    var value63 =0;
    var value64 =0;
    var value65 =0;
    var value66 =0;
    var value67 =0;
    var value68 =0;
    var value69 =0;
    var value70 =0;
    var value71 =0;
    var value72 =0;
    var value73 =0;
    var value74 =0;
    var value75 =0;
    var value76 =0;
    var value77 =0;
    var value78 =0;
    var value79 =0;
    var value80 =0;
    var value81 =0;
    var value82 =0;
    var value83 =0;
    var value84 =0;
    var value85 =0;
    var value86 =0;
    var value87 =0;
    var value88 =0;
    var value89 =0;
    var value90 =0;
    var value91 =0;
    var value92 =0;
    var value93 =0;
    var value94 =0;
    var value95 =0;
    var value96 =0;
    var value97 =0;
    var value98 =0;
    var value99 =0;
    var value100 =0;


    // Variable for total
    var sum3 = 0;
    var sum4 = 0;
    var sum5 = 0;
    var sum6 = 0;
    var sum7 = 0;
    var sum8 = 0;
    var sum9 = 0;
    var sum10 = 0;
    var sum11 = 0;

    var sum12 = 0;
    var sum13 = 0;
    var sum14 = 0;
    var sum15 = 0;
    var sum16 = 0;
    var sum17 = 0;
    var sum18 = 0;
    var sum19 = 0;
    var sum20 = 0;
    var sum21 = 0;

    var sum22 = 0;
    var sum23 = 0;
    var sum24 = 0;
    var sum25 = 0;
    var sum26 = 0;
    var sum27 = 0;
    var sum28 = 0;
    var sum29 = 0;
    var sum30 = 0;

    var sum31 = 0;
    var sum32 = 0;
    var sum33 =0;
    var sum34 =0;
    var sum35 =0;
    var sum36 =0;
    var sum37 =0;
    var sum38 =0;
    var sum39 =0;
    var sum40 =0;
    var sum41 =0;
    var sum42 =0;
    var sum43 =0;
    var sum44 =0;
    var sum45 =0;
    var sum46 =0;
    var sum47 =0;
    var sum48 =0;
    var sum49 =0;
    var sum50 =0;
    var sum51 =0;
    var sum52 =0;
    var sum53 =0;
    var sum54 =0;
    var sum55 =0;
    var sum56 =0;
    var sum57 =0;
    var sum58 =0;
    var sum59 =0;
    var sum60 =0;
    var sum61 =0;
    var sum62 =0;
    var sum63 =0;
    var sum64 =0;
    var sum65 =0;
    var sum66 =0;
    var sum67 =0;
    var sum68 =0;
    var sum69 =0;
    var sum70 =0;
    var sum71 =0;
    var sum72 =0;
    var sum73 =0;
    var sum74 =0;
    var sum75 =0;
    var sum76 =0;
    var sum77 =0;
    var sum78 =0;
    var sum79 =0;
    var sum80 =0;
    var sum81 =0;
    var sum82 =0;
    var sum83 =0;
    var sum84 =0;
    var sum85 =0;
    var sum86 =0;
    var sum87 =0;
    var sum88 =0;
    var sum89 =0;
    var sum90 =0;
    var sum91 =0;
    var sum92 =0;
    var sum93 =0;
    var sum94 =0;
    var sum95 =0;
    var sum96 =0;
    var sum97 =0;
    var sum98 =0;
    var sum99 =0;
    var sum100 =0;



    // Variables for grand total
    var msum3 = 0;
    var msum4 = 0;
    var msum5 = 0;
    var msum6 = 0;
    var msum7 = 0;
    var msum8 = 0;
    var msum9 = 0;
    var msum10 = 0;
    var msum11 = 0;

    var msum12 = 0;
    var msum13 = 0;
    var msum14 = 0;
    var msum15 = 0;
    var msum16 = 0;
    var msum17 = 0;
    var msum18 = 0;
    var msum19 = 0;
    var msum20 = 0;

    var msum21 = 0;
    var msum22 = 0;
    var msum23 = 0;
    var msum24 = 0;
    var msum25 = 0;
    var msum26 = 0;
    var msum27 = 0;
    var msum28 = 0;
    var msum29 = 0;
    var msum30 = 0;

    var msum31 = 0;
    var msum32 = 0;
    var msum33 =0;
    var msum34 =0;
    var msum35 =0;
    var msum36 =0;
    var msum37 =0;
    var msum38 =0;
    var msum39 =0;
    var msum40 =0;
    var msum41 =0;
    var msum42 =0;
    var msum43 =0;
    var msum44 =0;
    var msum45 =0;
    var msum46 =0;
    var msum47 =0;
    var msum48 =0;
    var msum49 =0;
    var msum50 =0;
    var msum51 =0;
    var msum52 =0;
    var msum53 =0;
    var msum54 =0;
    var msum55 =0;
    var msum56 =0;
    var msum57 =0;
    var msum58 =0;
    var msum59 =0;
    var msum60 =0;
    var msum61 =0;
    var msum62 =0;
    var msum63 =0;
    var msum64 =0;
    var msum65 =0;
    var msum66 =0;
    var msum67 =0;
    var msum68 =0;
    var msum69 =0;
    var msum70 =0;
    var msum71 =0;
    var msum72 =0;
    var msum73 =0;
    var msum74 =0;
    var msum75 =0;
    var msum76 =0;
    var msum77 =0;
    var msum78 =0;
    var msum79 =0;
    var msum80 =0;
    var msum81 =0;
    var msum82 =0;
    var msum83 =0;
    var msum84 =0;
    var msum85 =0;
    var msum86 =0;
    var msum87 =0;
    var msum88 =0;
    var msum89 =0;
    var msum90 =0;
    var msum91 =0;
    var msum92 =0;
    var msum93 =0;
    var msum94 =0;
    var msum95 =0;
    var msum96 =0;
    var msum97 =0;
    var msum98 =0;
    var msum99 =0;
    var msum100 =0;

    

    var orgUnitChildren_Array = [];
    var secondChildren_Array = [];
    var orgUnit = dhis2.report.organisationUnit;
    var orgUnitChildren = dhis2.report.organisationUnitChildren;
    var selOrgUnitLevel = dhis2.report.organisationUnitHierarchy.length;



    document.getElementById('ouname').innerHTML = orgUnit.name;



    $.each(orgUnitChildren, function (i, val) {
        orgUnitChildren_Array.push([val.id, val.name]);
    });
    orgUnitChildren_Array.sort(arraySorting);



    // New Code start from here
    var count = 0;
    var count1 = 0;
    var secondChild = [];
    var count4 = 0;


    function getcumulative(){
        var periodArray = [];
        var year=parseInt(gotPeriod.substring(0,4));
        var quatr=gotPeriod.substring(4,6);

        if(quatr=="Q1")
        {
            for(var i=4;i<=12;i++)
            {
                periodArray.push(year-1+"0"+i+";");
            }
            for(var i=1;i<=3;i++)
            {
                periodArray.push(year+"0"+i+";");
            }
        }
        else if(quatr=="Q2")
        {
            for(var i=4;i<=6;i++)
            {
                periodArray.push(year+"0"+i+";");
            }

        }
        else if(quatr=="Q3")
        {
            for(var i=4;i<=9;i++)
            {
                periodArray.push(year+"0"+i+";");
            }
        }
        else if(quatr=="Q4"){
            for(var i=4;i<=12;i++)
            {
                periodArray.push(year+"0"+i+";");
            }
        }

            return periodArray;

    }


    function datafordate(ouid, period) {
        var dataA = 0;
        $.ajax({
            async: false,
            url: "../api/dataValues.json?de=yl3ZGkjVbli&pe=" + period + "&ou=" + ouid + "",
            success: function (data) {
                dataA = data[0];
            }
        });
        return dataA;
    }


    $.each(orgUnitChildren_Array, function (index, element) {
        var ouid = element[0];


        var orgUnitAPI = $.ajax(
            {
                type: "GET",
                async: 'false',
                url: "../api/organisationUnits/" + ouid + ".json?fields=children[id,name]&order=name:desc",
                data: JSON,
                success: function (data, status) {
                }
            });


        $.when(orgUnitAPI).then(function (res) {
            var ouidName = element[1];
            count4++;


            var values1 = [];
            var count3 = 0;
            for (var x = 0; x < res.children.length; x++) {

                values.push(res.children[x].id);
                values1.push(res.children[x].name);

                dfdNext = dfdNext.pipe(function () {

                    var divName = values1.shift();
                    var value = values.shift();

                    return requestAjax(value).
                        done(function (response, response1) {
                            count++;
                            count3++;

                           //date = datafordate(value);

                            finalvalue(response, response1, ouidName, divName, count);

                            if (count3 == res.children.length) {
                                finalvalue(0, 0, 0,  0, 0);
                            }

                            if (index == orgUnitChildren_Array.length - 1 && count3 == res.children.length) {
                                finalvalue(0, 0, 0, 0, undefined, 00);
                            }

                        });
                });

            }

        });



    })

    function datafordate(ouid) {
        var dataA = 0;
        $.ajax({
            async: false,
            url: "../api/dataValues.json?de=yl3ZGkjVbli&pe=" + period + "&ou=" + ouid + "",
            success: function (data) {
                dataA = data[0];
            }
        });
        return dataA;
    }




    function finalvalue(res4, res5, ouidName, name, count, count1) {
       // console.log(date);
       
        if (count != 0 && count != undefined) {
           
            value4 = datavalue(res4,'RtOaSIHiuge.Ti9FJqkSK6J');
            value6 = datavalue(res4,'HbBhkEQsQWD.Ti9FJqkSK6J');
            value8 = datavalue(res4,'ywkxAqOdlmJ.Ti9FJqkSK6J');
            value10 = datavalue(res4,'XLeq3SqsZcZ.al2NuvITR0p');
            value12 = datavalue(res4,'XLeq3SqsZcZ.Ulk5zlEzXeV');
            value14 = datavalue(res4,'XLeq3SqsZcZ.wDLCGzD2cDD');
            value16 = datavalue(res4,'XLeq3SqsZcZ.h2Vrexr6NTU');
            value18 = datavalue(res4,'n2QRdX6158V.Ti9FJqkSK6J');
            value20 = datavalue(res4,'CDbmNLvSGco.Ti9FJqkSK6J');
            value22 = datavalue(res4,'v02GFnzZSO8.Ti9FJqkSK6J');
            value24 = datavalue(res4,'uYFDAcfLRSM.Ti9FJqkSK6J');
            value26 = datavalue(res4,'tjAQzqSjkDQ.Ti9FJqkSK6J');
            value28 = datavalue(res4,'OChco5ML9uc.Ti9FJqkSK6J');
            value30 = datavalue(res4,'lAupbr69nh1.Ti9FJqkSK6J');
            value32 = datavalue(res4,'KlY36scyeBE.Ti9FJqkSK6J');
            value34 = datavalue(res4,'IrZpUPK6kdz.Ti9FJqkSK6J');
            value36 = datavalue(res4,'j28udeo9tIb.Ti9FJqkSK6J');
            value38 = datavalue(res4,'CXKge3o94vi.qQ5QJ8fcrGX');
            value40 = datavalue(res4,'f8iY8UeMB2r.qQ5QJ8fcrGX');
            value42 = datavalue(res4,'RT4QZ1ZsX7F.qQ5QJ8fcrGX');
            value44 = datavalue(res4,'i5xrZvHbx4y.qQ5QJ8fcrGX');
            value46 = datavalue(res4,'UpdJ1N7DN2c.qQ5QJ8fcrGX');
            value48 = datavalue(res4,'mnIwNFnaEeB.qQ5QJ8fcrGX');
            value50 = datavalue(res4,'IlkdVZ5HJzQ.qQ5QJ8fcrGX');
            value52 = datavalue(res4,'m7cqECIjVjf.qQ5QJ8fcrGX');
            value54 = datavalue(res4,'VzGePaoQWeF.qQ5QJ8fcrGX');
            value56 = datavalue(res4,'fGa3njErIPF.qQ5QJ8fcrGX');
            value58 = datavalue(res4,'m1j7p2NeLOs.qQ5QJ8fcrGX');
            value60 = datavalue(res4,'hBxK0rdid2u.qQ5QJ8fcrGX');
            value62 = datavalue(res4,'XcnSOnvy3TK.qQ5QJ8fcrGX');
            value64 = datavalue(res4,'DpdPHER9ARi.qQ5QJ8fcrGX');
            value66 = datavalue(res4,'MhMtvMcnJj7.qQ5QJ8fcrGX');
            value68 = datavalue(res4,'AfEqeI1KnGS.qQ5QJ8fcrGX');
            value70 = datavalue(res4,'udhdpTQ0glB.qQ5QJ8fcrGX');
            value72 = datavalue(res4,'KynVPUios59.qQ5QJ8fcrGX');
            value74 = datavalue(res4,'bQpSbqiWLk7.qQ5QJ8fcrGX');
            value76 = datavalue(res4,'q2TUNhj8Z9F.qQ5QJ8fcrGX');
            value78 = datavalue(res4,'VDFjmnbUkis.qQ5QJ8fcrGX');
            value80 = datavalue(res4,'TG18zo2Lv7S.qQ5QJ8fcrGX');
            value82 = datavalue(res4,'COqwksEkJL2.qQ5QJ8fcrGX');
            value84 = datavalue(res4,'spWOjsz6UyL.qQ5QJ8fcrGX');
            value86 = datavalue(res4,'u9XN4DTKCQp.qQ5QJ8fcrGX');
            value88 = datavalue(res4,'xGYogvZU9QT.qQ5QJ8fcrGX');
            value90 = datavalue(res4,'D0hfiEuLSyD.qQ5QJ8fcrGX');
            value92 = datavalue(res4,'i4tTtjhFLk0.qQ5QJ8fcrGX');
            value94 = datavalue(res4,'UlmKlz5gCKq.qQ5QJ8fcrGX');
            value96 = datavalue(res4,'lURot0Njutj.qQ5QJ8fcrGX');
            value98 = datavalue(res4,'fBKDpQMokQS.qQ5QJ8fcrGX');
            value100 = datavalue(res4,'OBeITwYWy4r.qQ5QJ8fcrGX');
  
            value37 = datavalue(res5,'CXKge3o94vi.qQ5QJ8fcrGX');
            value39 = datavalue(res5,'f8iY8UeMB2r.qQ5QJ8fcrGX');
            value41 = datavalue(res5,'RT4QZ1ZsX7F.qQ5QJ8fcrGX');
            value43 = datavalue(res5,'i5xrZvHbx4y.qQ5QJ8fcrGX');
            value45 = datavalue(res5,'UpdJ1N7DN2c.qQ5QJ8fcrGX');
            value47 = datavalue(res5,'mnIwNFnaEeB.qQ5QJ8fcrGX');
            value49 = datavalue(res5,'IlkdVZ5HJzQ.qQ5QJ8fcrGX');
            value51 = datavalue(res5,'m7cqECIjVjf.qQ5QJ8fcrGX');
            value53 = datavalue(res5,'VzGePaoQWeF.qQ5QJ8fcrGX');
            value55 = datavalue(res5,'fGa3njErIPF.qQ5QJ8fcrGX');
            value57 = datavalue(res5,'m1j7p2NeLOs.qQ5QJ8fcrGX');
            value59 = datavalue(res5,'hBxK0rdid2u.qQ5QJ8fcrGX');
            value61 = datavalue(res5,'XcnSOnvy3TK.qQ5QJ8fcrGX');
            value63 = datavalue(res5,'DpdPHER9ARi.qQ5QJ8fcrGX');
            value65 = datavalue(res5,'MhMtvMcnJj7.qQ5QJ8fcrGX');
            value67 = datavalue(res5,'AfEqeI1KnGS.qQ5QJ8fcrGX');
            value69 = datavalue(res5,'udhdpTQ0glB.qQ5QJ8fcrGX');
            value71 = datavalue(res5,'KynVPUios59.qQ5QJ8fcrGX');
            value73 = datavalue(res5,'bQpSbqiWLk7.qQ5QJ8fcrGX');
            value75 = datavalue(res5,'q2TUNhj8Z9F.qQ5QJ8fcrGX');
            value77 = datavalue(res5,'VDFjmnbUkis.qQ5QJ8fcrGX');
            value79 = datavalue(res5,'TG18zo2Lv7S.qQ5QJ8fcrGX');
            value81 = datavalue(res5,'COqwksEkJL2.qQ5QJ8fcrGX');
            value83 = datavalue(res5,'spWOjsz6UyL.qQ5QJ8fcrGX');
            value85 = datavalue(res5,'u9XN4DTKCQp.qQ5QJ8fcrGX');
            value87 = datavalue(res5,'xGYogvZU9QT.qQ5QJ8fcrGX');
            value89 = datavalue(res5,'D0hfiEuLSyD.qQ5QJ8fcrGX');
            value91 = datavalue(res5,'i4tTtjhFLk0.qQ5QJ8fcrGX');
            value93 = datavalue(res5,'UlmKlz5gCKq.qQ5QJ8fcrGX');
            value95 = datavalue(res5,'lURot0Njutj.qQ5QJ8fcrGX');
            value97 = datavalue(res5,'fBKDpQMokQS.qQ5QJ8fcrGX');
            value99 = datavalue(res5,'OBeITwYWy4r.qQ5QJ8fcrGX');




            
            if(value4==0 ||value6==0 ||value8==0 ||value18==0 ||value20==0 ||value22==0 ||value24==0  ||value26==0 ||value28==0 ||value30==0 ||value32==0 ||value34==0 ||value36==0  )
            {
                value4="no";value6="no";value8="no";value18="no";value20="no";value22="no";value24="no";value26="no";value28="no";value30="no";value32="no";value34="no";value36="no";
            }
            
            if(value4==1 ||value6==1 ||value8==1 ||value18==1 ||value20==1 ||value22==1 ||value24==1  ||value26==1 ||value28==1 ||value30==1 ||value32==1 ||value34==1 ||value36==1) 
            {
                value4="yes";value6="yes";value8="yes";value18="yes";value20="yes";value22="yes";value24="yes";value26="yes";value28="yes";value30="yes";value32="yes";value34="yes";value36="yes";
            }
            
            
            
            



           

            var tabledata = '<tr>';

            tabledata += ("<td>" + count + "</td><td>" + ouidName + "</td><td>" + name + "</td><td>"+value4+"</td><td>" + value6 + "</td><td>"+ value8 + "</td><td>"+ value10 + "</td><td>" + value12  + "</td><td>" + value14 + "</td><td>" + value16 + "</td><td>" + value18 + "</td><td>" + value20 + "</td><td>" + value22  + "</td><td>" + value24 + "</td><td>" + value26  + "</td><td>" + value28  + "</td><td>" + value30  + "</td><td>" + value32  + "</td><td>" + value34 + "</td><td>" + value36 + "</td><td>" + value37 + "</td><td>" + value38 + "</td><td>" + value39 + "</td><td>" + value40 + "</td><td>" + value41 + "</td><td>" + value42 + "</td><td>" + value43 + "</td><td>" + value44 + "</td><td>" + value45 + "</td><td>" + value46 + "</td><td>" + value47 + "</td><td>" + value48 + "</td><td>" + value49 + "</td><td>" + value50 + "</td><td>"+value51 + "</td><td>"+	value52 + "</td><td>"+	value53 + "</td><td>"+	value54 + "</td><td>"+	value55 + "</td><td>"+	value56 + "</td><td>"+	value57 + "</td><td>"+	value58 + "</td><td>"+	value59 + "</td><td>"+	value60 + "</td><td>"+	value61 + "</td><td>"+	value62 + "</td><td>"+	value63 + "</td><td>"+	value64 + "</td><td>"+	value65 + "</td><td>"+	value66 + "</td><td>"+	value67 + "</td><td>"+	value68 + "</td><td>"+	value69 + "</td><td>"+	value70 + "</td><td>"+	value71 + "</td><td>"+	value72 + "</td><td>"+	value73 + "</td><td>"+	value74 + "</td><td>"+	value75 + "</td><td>"+	value76 + "</td><td>"+	value77 + "</td><td>"+	value78 + "</td><td>"+	value79 + "</td><td>"+	value80 + "</td><td>"+	value81 + "</td><td>"+	value82 + "</td><td>"+	value83 + "</td><td>"+	value84 + "</td><td>"+	value85 + "</td><td>"+	value86 + "</td><td>"+	value87 + "</td><td>"+	value88 + "</td><td>"+	value89 + "</td><td>"+	value90 + "</td><td>"+	value91 + "</td><td>"+	value92 + "</td><td>"+	value93 + "</td><td>"+	value94 + "</td><td>"+	value95 + "</td><td>"+	value96 + "</td><td>"+	value97 + "</td><td>"+value98+"</td><td>"+	value99 + "</td><td>"+value100 + "</td>");

            tabledata += "</tr>";
            document.getElementById("dataTable").innerHTML += tabledata;
            document.getElementById("loader").style.display = "none";
            document.getElementById("printing").style.display = "block";

            
            sum4 += value4;
           
            sum6 += value6;
            
            sum8 += value8;
            
            sum10 += value10;
            

            sum12 += value12;
            
            sum14 += value14;
            
            sum16 += value16;
            
            sum18 += value18;
            
            sum20 += value20;
            

            sum22 += value22;
            
            sum24 += value24;
            
            sum26 += value26;
            
            sum28 += value28;
            
            sum30 += value30;

            sum22 += value22;
            
            sum24 += value24;
            
            sum26 += value26;
            
            sum28 += value28;
            
            sum30 += value30;

            sum32 += value32;
            
            sum34 += value34;
            
            
            sum36 += value36;
            sum37 += value37;
            sum38 += value38;
            sum39 += value39;
            sum40 += value40;

            sum41 += value41;
            sum42 += value42;
            sum43 += value43;
            sum44 += value44;
            sum45 += value45;
            sum46 += value46;
            sum47 += value47;
            sum48 += value48;
            sum49 += value49;
            sum50 += value50;

            sum51 += value51;
            sum52 += value52;
            sum53 += value53;
            sum54 += value54;
            sum55 += value55;
            sum56 += value56;
            sum57 += value57;
            sum58 += value58;
            sum59 += value59;
            sum60 += value60;
            sum61 += value61;
            sum62 += value62;
            sum63 += value63;
            sum64 += value64;
            sum65 += value65;
            sum66 += value66;
            sum67 += value67;
            sum68 += value68;
            sum69 += value69;
            sum70 += value70;
            sum71 += value71;
            sum72 += value72;
            sum73 += value73;
            sum74 += value74;
            sum75 += value75;
            sum76 += value76;
            sum77 += value77;
            sum78 += value78;
            sum79 += value79;
            sum80 += value80;
            sum81 += value81;
            sum82 += value82;
            sum83 += value83;
            sum84 += value84;
            sum85 += value85;
            sum86 += value86;
            sum87 += value87;
            sum88 += value88;
            sum89 += value89;
            sum90 += value90;
            sum91 += value91;
            sum92 += value92;
            sum93 += value93;
            sum94 += value94;
            sum95 += value95;
            sum96 += value96;
            sum97 += value97;
            sum98 += value98;
            sum99 += value99;
            sum100 += value100;



           
           
          

        }



        else if (count == 0) {


            tabledata = ("<tr style='background:#ADD8E6'><td colspan='3'>Total</td><td></td><td></td><td></td><td>" + sum10 + "</td><td>" + sum12 + "</td><td>" +sum14 +"</td><td>" + sum16 + "</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>" + sum37 + "</td><td>" + sum38 + "</td><td>" + sum39 + "</td><td>" + sum40 + "</td><td>" + sum41 + "</td><td>" + sum42 + "</td><td>" + sum43 + "</td><td>" + sum44 + "</td><td>" + sum45 + "</td><td>" + sum46 + "</td><td>" + sum47 + "</td><td>" + sum48 + "</td><td>" + sum49 + "</td><td>" + sum50 + "</td><td>"+sum51 + "</td><td>"+	sum52 + "</td><td>"+	sum53 + "</td><td>"+	sum54 + "</td><td>"+	sum55 + "</td><td>"+	sum56 + "</td><td>"+	sum57 + "</td><td>"+	sum58 + "</td><td>"+	sum59 + "</td><td>"+	sum60 + "</td><td>"+	sum61 + "</td><td>"+	sum62 + "</td><td>"+	sum63 + "</td><td>"+	sum64 + "</td><td>"+	sum65 + "</td><td>"+	sum66 + "</td><td>"+	sum67 + "</td><td>"+	sum68 + "</td><td>"+	sum69 + "</td><td>"+	sum70 + "</td><td>"+	sum71 + "</td><td>"+	sum72 + "</td><td>"+	sum73 + "</td><td>"+	sum74 + "</td><td>"+	sum75 + "</td><td>"+	sum76 + "</td><td>"+	sum77 + "</td><td>"+	sum78 + "</td><td>"+	sum79 + "</td><td>"+	sum80 + "</td><td>"+	sum81 + "</td><td>"+	sum82 + "</td><td>"+	sum83 + "</td><td>"+	sum84 + "</td><td>"+	sum85 + "</td><td>"+	sum86 + "</td><td>"+	sum87 + "</td><td>"+	sum88 + "</td><td>"+	sum89 + "</td><td>"+	sum90 + "</td><td>"+	sum91 + "</td><td>"+	sum92 + "</td><td>"+	sum93 + "</td><td>"+	sum94 + "</td><td>"+	sum95 + "</td><td>"+	sum96 + "</td><td>"+	sum97 + "</td><td>"+	sum98 + "</td><td>"+	sum99 + "</td><td>"+	sum100 + "</td></tr>"); 
 

            document.getElementById("dataTable").innerHTML += tabledata;

            
            msum4 += sum4;
           
            msum6 += sum6;
            
            msum8 += sum8;
            
            msum10 += sum10;
           

            msum12 += sum12;
            
            msum14 += sum14;
            
            msum16 += sum16;
            
            msum18 += sum18;
            
            msum20 += sum20;
            

            msum22 += sum22;
            
            msum24 += sum24;
           
            msum26 += sum26;
           
            msum28 += sum28;
            
            msum30 += sum30;

           
            msum32 += sum32;
           
            msum34 += sum34;
            
            msum36 += sum36;
            msum37 += sum37;
            msum38 += sum38;
            msum39 += sum39;
            msum40 += sum40;

            msum41 += sum41;
            msum42 += sum42;
            msum43 += sum43;
            msum44 += sum44;
            msum45 += sum45;
            msum46 += sum46;
            msum47 += sum47;
            msum48 += sum48;
            msum49 += sum49;
            msum50 += sum50;

            msum51 += sum51;
            msum52 += sum52;
            msum53 += sum53;
            msum54 += sum54;
            msum55 += sum55;
            msum56 += sum56;
            msum57 += sum57;
            msum58 += sum58;
            msum59 += sum59;
            msum60 += sum60;
            msum61 += sum61;
            msum62 += sum62;
            msum63 += sum63;
            msum64 += sum64;
            msum65 += sum65;
            msum66 += sum66;
            msum67 += sum67;
            msum68 += sum68;
            msum69 += sum69;
            msum70 += sum70;
            msum71 += sum71;
            msum72 += sum72;
            msum73 += sum73;
            msum74 += sum74;
            msum75 += sum75;
            msum76 += sum76;
            msum77 += sum77;
            msum78 += sum78;
            msum79 += sum79;
            msum80 += sum80;
            msum81 += sum81;
            msum82 += sum82;
            msum83 += sum83;
            msum84 += sum84;
            msum85 += sum85;
            msum86 += sum86;
            msum87 += sum87;
            msum88 += sum88;
            msum89 += sum89;
            msum90 += sum90;
            msum91 += sum91;
            msum92 += sum92;
            msum93 += sum93;
            msum94 += sum94;
            msum95 += sum95;
            msum96 += sum96;
            msum97 += sum97;
            msum98 += sum98;
            msum99 += sum99;
            msum100 += sum100;

           



            // Variable for total
            
            sum4 = 0;
           
            sum6 = 0;
           
            sum8 = 0;
           
            sum10 = 0;

            
            sum12 = 0;
           
            sum14 = 0;
           
            sum16 = 0;
           
            sum18 = 0;
            
            sum20 = 0;

           
            sum22 = 0;
            
            sum24 = 0;
            
            sum26 = 0;
            
            sum28 = 0;
            
            sum30 = 0;

            
            sum32 = 0;
           
            sum34 = 0;
           
            sum36 = 0;
            sum37 = 0;
            sum38 = 0;
            sum39 = 0;
            sum40 = 0;

            sum41 = 0;
            sum42 = 0;
            sum43 = 0;
            sum44 = 0;
            sum45 = 0;
            sum46 = 0;
            sum47 = 0;
            sum48 = 0;
            sum49 = 0;
            sum50 = 0;

            sum51 =0;
            sum52 =0;
            sum53 =0;
            sum54 =0;
            sum55 =0;
            sum56 =0;
            sum57 =0;
            sum58 =0;
            sum59 =0;
            sum60 =0;
            sum61 =0;
            sum62 =0;
            sum63 =0;
            sum64 =0;
            sum65 =0;
            sum66 =0;
            sum67 =0;
            sum68 =0;
            sum69 =0;
            sum70 =0;
            sum71 =0;
            sum72 =0;
            sum73 =0;
            sum74 =0;
            sum75 =0;
            sum76 =0;
            sum77 =0;
            sum78 =0;
            sum79 =0;
            sum80 =0;
            sum81 =0;
            sum82 =0;
            sum83 =0;
            sum84 =0;
            sum85 =0;
            sum86 =0;
            sum87 =0;
            sum88 =0;
            sum89 =0;
            sum90 =0;
            sum91 =0;
            sum92 =0;
            sum93 =0;
            sum94 =0;
            sum95 =0;
            sum96 =0;
            sum97 =0;
            sum98 =0;
            sum99 =0;
            sum100 =0;




           
        }
        if (count1 == 00) {
            tabledata = ("<tr style='background:#ADD8E6'><td colspan='3'>Grand Total<td></td><td></td><td></td><td>" + msum10 + "</td><td>"  + msum12 + "</td><td>" + msum14 + "</td><td>"  + msum16 + "</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>" + msum37 + "</td><td>" + msum38 + "</td><td>" + msum39 + "</td><td>" + msum40 + "</td><td>" + msum41 + "</td><td>" + msum42 + "</td><td>" + msum43 + "</td><td>" + msum44 + "</td><td>" + msum45 + "</td><td>" + msum46 + "</td><td>" + msum47 + "</td><td>" + msum48 + "</td><td>" + msum49 + "</td><td>" + msum50 +"</td><td>"+msum51+"</td><td>"+msum52+"</td><td>"+msum53+"</td><td>"+msum54+"</td><td>"+msum55+"</td><td>"+msum56+"</td><td>"+msum57+"</td><td>"+msum58+"</td><td>"+msum59+"</td><td>"+msum60+"</td><td>"+msum61+"</td><td>"+msum62+"</td><td>"+msum63+"</td><td>"+msum64+"</td><td>"+msum65+"</td><td>"+msum66+"</td><td>"+msum67+"</td><td>"+msum68+"</td><td>"+msum69+"</td><td>"+msum70+"</td><td>"+msum71+"</td><td>"+msum72+"</td><td>"+msum73+"</td><td>"+msum74+"</td><td>"+msum75+"</td><td>"+msum76+"</td><td>"+msum77+"</td><td>"+msum78+"</td><td>"+msum79+"</td><td>"+msum80+"</td><td>"+msum81+"</td><td>"+msum82+"</td><td>"+msum83+"</td><td>"+msum84+"</td><td>"+msum85+"</td><td>"+msum86+"</td><td>"+msum87+"</td><td>"+msum88+"</td><td>"+msum89+"</td><td>"+msum90+"</td><td>"+msum91+"</td><td>"+msum92+"</td><td>"+msum93+"</td><td>"+msum94+"</td><td>"+msum95+"</td><td>"+msum96+"</td><td>"+msum97+"</td><td>"+msum98+"</td><td>"+msum99+"</td><td>"+msum100+"</td><tr>");
             document.getElementById("dataTable").innerHTML += tabledata;
         
        }


    }



    function datavalue(dataJSON, id, id1) {
        var value1 = 0;
        for (var i = 0; i < dataJSON.rows.length; i++) {
            if (dataJSON.rows[i][0] == id) {
                value1 = parseInt(dataJSON.rows[i][2]);
            }
        }
        return (value1);
    }


    function arraySorting(a, b) {
        return ((a[1] < b[1]) ? -1 : ((a[1] > b[1]) ? 1 : 0));
    }

    function getPeriod(pr) {
        var year = pr.substring(0, 4);
        var month = pr.substring(4, 6);
        var strMonth = "";

        if (month == "01" || month == "1") strMonth = "January";
        else if (month == "02" || month == "2") strMonth = "February";
        else if (month == "03" || month == "3") strMonth = "March";
        else if (month == "04" || month == "4") strMonth = "April";
        else if (month == "05" || month == "5") strMonth = "May";
        else if (month == "06" || month == "6") strMonth = "June";
        else if (month == "07" || month == "7") strMonth = "July";
        else if (month == "08" || month == "8") strMonth = "August";
        else if (month == "09" || month == "9") strMonth = "September";
        else if (month == "10") strMonth = "October";
        else if (month == "11") strMonth = "November";
        else if (month == "12") strMonth = "December";

        return strMonth + " " + year;
    }

    function getPeriods() {
        var periodArray = [];
        var year = parseInt(gotPeriod.substring(0, 4));
        var mnth = parseInt(gotPeriod.substring(4, 6));

        if (mnth > 3) {
            for (var i = 4; i <= mnth; i++) {
                if (i < 10) {
                    periodArray.push(year.toString() + "0" + i + ";");
                }
                else {
                    periodArray.push(year.toString() + i + ";");
                }
            }
        }

        if (mnth <= 3) {
            for (var i = 4; i <= 12; i++) {
                if (i < 10) {
                    periodArray.push((year - 1).toString() + "0" + i + ";");
                }
                else {
                    periodArray.push((year - 1).toString() + i + ";");
                }
            }

            for (var i = 1; i <= mnth; i++) {
                if (i < 10) {
                    periodArray.push(year.toString() + "0" + i + ";");
                }
                else {
                    periodArray.push(year.toString() + i + ";");
                }
            }

        }
        return periodArray;
    }

    var tableToExcel = (function () {
        var uri = 'data:application/vnd.ms-excel;base64,'
            , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
            , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
            , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (table, name, filename) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

            document.getElementById("dlink").href = uri + base64(format(template, ctx));
            document.getElementById("dlink").download = filename;
            document.getElementById("dlink").click();

        }
    })()

</script>