<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
crossorigin="anonymous">

<style>
tbody>tr>td {
    font-weight: bold;
}
/* Center the loader  */

#loader {
    position: absolute;
    left: 50%;
    top: 50%;
    z-index: 1;
    width: 150px;
    height: 150px;
    margin: -75px 0 0 -75px;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid #34B4DB;
    width: 120px;
    height: 120px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
}

@-webkit-keyframes spin {
    0% {
        -webkit-transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(360deg);
    }
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}
/* Add animation to "page content" */

.animate-bottom {
    position: relative;
    -webkit-animation-name: animatebottom;
    -webkit-animation-duration: 1s;
    animation-name: animatebottom;
    animation-duration: 1s
}

@-webkit-keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0px;
        opacity: 1
    }
}

@keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0;
        opacity: 1
    }
}

*/ #printing {
    display: none;
    text-align: center;
}
</style>
<a id="dlink" style="display:none;"></a>

<button type="button" id="btnBack" class="btn brn-default btn-sm" style="vertical-align: middle;" onclick="location.href='../dhis-web-reports-app/index.html#/generate-report'"><span
class="glyphicon glyphicon-chevron-left" style="font-size: 15px;"></span>&nbsp; Goto Report Selection Page
</button>
<button type="button" class="btn btn-primary btn-sm" style="vertical-align: middle;" onclick="printContent('printing')"><span class="glyphicon glyphicon-print" style="font-size: 15px;"></span> &nbsp;
Print
</button>
<button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport" onclick="tableToExcel('dataTable', 'name', 'MPR-SUMMARY OF SCREENING CAMPS.xls')"><span class="glyphicon glyphicon-download-alt" style="font-size: 15px;"></span> &nbsp;
Download As Excel
</button>

<br><br>
<div id="loader"></div>
<div id="printing" style="display:none;" class="animate-bottom">
<div id='state'>
    <table width="100%" id="dataTable" border="1" class="table  table-hover text-center" cellspacing="6" cellpadding="4">
            <tbody style="background:#ADD8E6; font-weight:400; text-align:center">
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
            <td style="border:1px solid black " colspan="23" width="1823">MPR-SUMMARY OF SCREENING CAMPS</td>
            </tr>
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
            <td style="border:1px solid black " colspan="4">Month:2017-2018</td>
            <td style="border:1px solid black " colspan="9" width="1570">organisationUnit<span id = 'ouname'></span></td>
            <td style="border:1px solid black " colspan="10" width="1570">timeStamp<span id = 'timeStamp'></span></td>
            </tr>
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                    <td style="border:1px solid black " rowspan="3" width="50">क्रम संख्या</td>
                    <td style="border:1px solid black " rowspan="3" width="70" id='level1'></td>
                      <td style="border:1px solid black " rowspan="3" width="70" id='level2'></td>
                    
        
            <td style="border:1px solid black " rowspan="3" width="144">No of cases Screended</td>
            <td  style="border:1px solid black " colspan="4">0-5 Years</td>
            <td style="border:1px solid black " colspan="4">6-15 Years</td>
            <td style="border:1px solid black " colspan="4">16-50 Years</td>
            <td style="border:1px solid black " colspan="4">&gt;50 Years</td>
            </tr>
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
            <td style="border:1px solid black " colspan="2">Male</td>
            <td style="border:1px solid black " colspan="2">Female</td>
            <td style="border:1px solid black " colspan="2">Male</td>
            <td style="border:1px solid black " colspan="2">Female</td>
            <td style="border:1px solid black " colspan="2">Male</td>
            <td style="border:1px solid black " colspan="2">Female</td>
            <td style="border:1px solid black " colspan="2">Male</td>
            <td style="border:1px solid black " colspan="2">Female</td>
            </tr>
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
           
            <td style="border:1px solid black " width="74">Monthly</td>
            <td style="border:1px solid black " width="51">Cumu.</td>
            <td style="border:1px solid black "  width="90">Monthly</td>
            <td  style="border:1px solid black " width="92">Cumu.</td>
            
            <td style="border:1px solid black " width="112">Monthly</td>
            <td style="border:1px solid black " width="74">Cumu.</td>
            <td style="border:1px solid black " width="108">Monthly</td>
            <td style="border:1px solid black " width="67">Cumu.</td>
            <td style="border:1px solid black " width="91">Monthly</td>
            <td style="border:1px solid black " width="83">Cumu.</td>
            <td style="border:1px solid black " width="73">Monthly</td>
            <td style="border:1px solid black " width="69">Cumu.</td>
            <td style="border:1px solid black " width="78">Monthly</td>
            <td style="border:1px solid black " width="64">Cumu.</td>
            <td style="border:1px solid black " width="77">Monthly</td>
            <td style="border:1px solid black " width="64">Cumu.</td>
            
            </tr>
            </tbody>
    </table>

</div>
</div>
<!-- printing script -->
<script type="text/javascript">
function printContent(el) {
    var restorepage = document.body.innerHTML;
    var printcontent = document.getElementById(el).innerHTML;
    document.body.innerHTML = printcontent;
    window.print();
    document.body.innerHTML = restorepage;
}

</script>

<script>
// Code fr date and time stamp
var today = new Date();
var dd = today.getDate();
var mm = today.getMonth() + 1; //January is 0!
var yyyy = today.getFullYear();

if (dd < 10) {
    dd = '0' + dd
}

if (mm < 10) {
    mm = '0' + mm
}

today = mm + '/' + dd + '/' + yyyy;



function displayTime() {
    var str = "";

    var currentTime = new Date()
    var hours = currentTime.getHours()
    var minutes = currentTime.getMinutes()
    var seconds = currentTime.getSeconds()

    if (minutes < 10) {
        minutes = "0" + minutes
    }
    if (seconds < 10) {
        seconds = "0" + seconds
    }
    str += hours + ":" + minutes + ":" + seconds + " ";
    if (hours > 11) {
        str += "PM"
    } else {
        str += "AM"
    }
    return str;
}


document.getElementById('timeStamp').innerHTML = today + "-" + displayTime();

</script>

<!-- Main Script -->
<script>
var periods = dhis2.report.periods;
var period = periods[0];

var periodName = getPeriod(period);

//document.getElementById('periodName').innerHTML = periodName;

var url = window.location.href;
var params = url.split('=');
var gotOrgUnit = params[3];
var gotPeriod = params[2].toString().substring(0, 6);
var periodArray = getPeriods();
var periodcum = periodArray.toString();
var periodcumulative = periodcum.replace(/,/g, "");
var selOrgUnitLevel = dhis2.report.organisationUnitHierarchy.length;

if (selOrgUnitLevel == 2) {
    document.getElementById('level1').innerHTML = "State Name";
    document.getElementById('level2').innerHTML = "Divison Name";
}
else if (selOrgUnitLevel == 3) {
    document.getElementById('level1').innerHTML = "Divison Name";
    document.getElementById('level2').innerHTML = "District Name";
}
else if (selOrgUnitLevel == 4) {
    document.getElementById('level1').innerHTML = "District Name";
    document.getElementById('level2').innerHTML = "Block Name";
}
else if (selOrgUnitLevel == 5) {
    document.getElementById('level1').innerHTML = "Block Name";
    document.getElementById('level2').innerHTML = "Facility Name";
}





var count = 0;
    var value0 = 0;
    var value1 = 0;
    var value2 = 0;

    var value3 = 0;
    var value4 = 0;
    var value5 = 0;
    var value6 = 0;
    var value7 = 0;
    var value8 = 0;
    var value9 = 0;
    var value10 = 0;
    var value11 = 0;
    var value12 = 0;
    var value13 = 0;
    var value14 = 0;
    var value15 = 0;
    var value16 = 0;
    var value17 = 0;
    var value18 = 0;
    var value19 = 0;
    var value20 = 0;
    var value21 = 0;
    var value22 = 0;
    var value23 = 0;
    var value24 = 0;
    var value25 = 0;
    var value26 = 0;
    var value27 = 0;
    var value28 = 0;
    var value29 = 0;
    var value30 = 0;
    var value31 = 0;
    var value32 = 0;
    var value33 = 0;
    var value34 = 0;
    var value35 = 0;
    var value36 = 0;
    var value37 = 0;
    var value38 = 0;
    var value39 = 0;
    var value40 = 0;
    var value41 = 0;
    var value42 = 0;
    var value43 = 0;
    var value44 = 0;
    var value45 = 0;
    var value46 = 0;
    var value47 = 0;
    var value48 = 0;
    var value49 = 0;
    var value50 = 0;
    var value51 = 0;
    var value52 = 0;
    var value53 = 0;
    var value54 = 0;
    var value55 = 0;
    var value56 = 0;
    var value57 = 0;
    var value58 = 0;
    var value59 = 0;

    var value60 = 0;
    var value61 = 0;
    var value62 = 0;
    var value63 = 0;
    var value64 = 0;
    var value65 = 0;
    var value66 = 0;

    var value67 = 0;
    var value68 = 0;
    var value69 = 0;
    var value70 = 0;
    var value71 = 0;

    var value72 = 0;
    var value73 = 0;
    var value74 = 0;
    var value75 = 0;
    var value76 = 0;

    var value77 = 0;
    var value78 = 0;
    var value79 = 0;
    var value80 = 0;

    var value81 = 0;
    var value82 = 0;
    var value83 = 0;
    var value84 = 0;
    var value85 = 0;

    var value86 = 0;
    var value87 = 0;
    var value88 = 0;
    var value89 = 0;

    var value90 = 0;
    var value91 = 0;
    var value92 = 0;
    var value93 = 0;
    var value94 = 0;
    var value95 = 0;
    var value96 = 0;
    var value97 = 0;
    var value98 = 0;
    var value99 = 0;
    var value100 = 0;
    var value101 = 0;
    var value102 = 0;
    var value103 = 0;
    var value104 = 0;
    var value105 = 0;
    var value106 = 0;
    var value107 = 0;
    var value108 = 0;
    var value109 = 0;
    var value110 = 0;
    var value111 = 0;
    var value112 = 0;
    var value113 = 0;
    var value114 = 0;
    var value115 = 0;
    var value116 = 0;
    var value117 = 0;
    var value118 = 0;
    var value119 = 0;
    var value120 = 0;

    var value121 = 0;
    var value122 = 0;
    var value123 = 0;
    var value124 = 0;
    var value125 = 0;
    var value126 = 0;
    var value127 = 0;
    var value128 = 0;

    var value129 = 0;
    var value130 = 0;
    var value131 = 0;
    var value132 = 0;
    var value133 = 0;
    var value134 = 0;
    var value135 = 0;

    var value136 = 0;
    var value137 = 0;
    var value138 = 0;
    var value139 = 0;
    var value140 = 0;
    var value141 = 0;
    var value142 = 0;
    var value143 = 0;

    var value144 = 0;
    var value145 = 0;
    var value146 = 0;
    var value147 = 0;
    var value148 = 0;
    var value149 = 0;
    var value150 = 0;
    var value151 = 0;
    var value152 = 0;
    var value153 = 0;
    var value154 = 0;
    var value155 = 0;
    var value156 = 0;
    var value157 = 0;

    var value158 = 0;
    var value159 = 0;
    var value160 = 0;

    var value161 = 0;
    var value162 = 0;

    var value163 = 0;
    var value164 = 0;
    var value165 = 0;
    var value166 = 0;

    var value167 = 0;
    var value168 = 0;
    var value169 = 0;
    var value170 = 0;

    var value171 = 0;
    var value172 = 0;
    var value173 = 0;
    var value174 = 0;
    var value175 = 0;
    var value176 = 0;
    var value177 = 0;

    var value178 = 0;
    var value179 = 0;
    var value180 = 0;
    var value181 = 0;
    var value182 = 0;
    var value183 = 0;
    var value184 = 0;

    var value185 = 0;
    var value186 = 0;
    var value187 = 0;
    var value188 = 0;

    var value189 = 0;
    var value190 = 0;
    var value191 = 0;

    var value192 = 0;
    var value193 = 0;
    var value194 = 0;

    var value195 = 0;
    var value196 = 0;

    var value197 = 0;
    var value198 = 0;
    var value199 = 0;

    var value200 = 0;
    var value201 = 0;
    var value202 = 0;
    var value203 = 0;
    var value204 = 0;

    var value205 = 0;
    var value206 = 0;
    var value207 = 0;
    var value208 = 0;
    var value209 = 0;

    var value210 = 0;
    var value211 = 0;
    var value212 = 0;

    var value213 = 0;
    var value214 = 0;
    var value215 = 0;
    var value216 = 0;
    var value217 = 0;
    var value218 = 0;
    var value219 = 0;

    var value220 = 0;
    var value221 = 0;
    var value222 = 0;

    var value223 = 0;
    var value224 = 0;
    var value225 = 0;

    var value226 = 0;
    var value227 = 0;
    var value228 = 0;

    var value229 = 0;
    var value230 = 0;

    var value231 = 0;
    var value232 = 0;
    var value233 = 0;
    var value234 = 0;
    var value235 = 0;
    var value236 = 0;








    // Variable for total
    var sum0 = 0;

    var sum1 = 0;
    var sum2 = 0;
    var sum3 = 0;
    var sum4 = 0;
    var sum5 = 0;
    var sum6 = 0;
    var sum7 = 0;
    var sum8 = 0;
    var sum9 = 0;
    var sum10 = 0;
    var sum11 = 0;

    var sum12 = 0;
    var sum13 = 0;
    var sum14 = 0;
    var sum15 = 0;
    var sum16 = 0;
    var sum17 = 0;
    var sum18 = 0;
    var sum19 = 0;
    var sum20 = 0;
    var sum21 = 0;

    var sum22 = 0;
    var sum23 = 0;
    var sum24 = 0;
    var sum25 = 0;
    var sum26 = 0;
    var sum27 = 0;
    var sum28 = 0;
    var sum29 = 0;
    var sum30 = 0;

    var sum31 = 0;
    var sum32 = 0;
    var sum33 = 0;
    var sum34 = 0;
    var sum35 = 0;
    var sum36 = 0;
    var sum37 = 0;
    var sum38 = 0;
    var sum39 = 0;
    var sum40 = 0;

    var sum41 = 0;
    var sum42 = 0;
    var sum43 = 0;
    var sum44 = 0;
    var sum45 = 0;
    var sum46 = 0;
    var sum47 = 0;
    var sum48 = 0;
    var sum49 = 0;
    var sum50 = 0;

    var sum51 = 0;
    var sum52 = 0;
    var sum53 = 0;
    var sum54 = 0;
    var sum55 = 0;
    var sum56 = 0;
    var sum57 = 0;
    var sum58 = 0;
    var sum59 = 0;
    var sum60 = 0;

    var sum61 = 0;
    var sum62 = 0;
    var sum63 = 0;
    var sum64 = 0;
    var sum65 = 0;
    var sum66 = 0;
    var sum67 = 0;
    var sum68 = 0;
    var sum69 = 0;
    var sum70 = 0;
    var sum71 = 0;
    var sum72 = 0;

    var sum73 = 0;
    var sum74 = 0;
    var sum75 = 0;
    var sum76 = 0;
    var sum77 = 0;

    var sum78 = 0;
    var sum79 = 0;
    var sum80 = 0;

    var sum81 = 0;
    var sum82 = 0;
    var sum83 = 0;

    var sum84 = 0;
    var sum85 = 0;
    var sum86 = 0;
    var sum87 = 0;

    var sum88 = 0;
    var sum89 = 0;
    var sum90 = 0;
    var sum91 = 0;
    var sum92 = 0;

    var sum93 = 0;
    var sum94 = 0;
    var sum95 = 0;
    var sum96 = 0;
    var sum97 = 0;

    var sum98 = 0;
    var sum99 = 0;
    var sum100 = 0;

    var sum101 = 0;

    var sum102= 0;
    var sum103= 0;
    var sum104 = 0;
    var sum105 = 0;

    var sum106 = 0;
    var sum107 = 0;
    var sum108= 0;

    var sum109= 0;
    var sum110 = 0;
    var sum111 = 0;
    var sum112 = 0;

    var sum113 = 0;
    var sum114 = 0;
    var sum115 = 0;

    var sum116 = 0;
    var sum117 = 0;
    var sum118 = 0;
    var sum119 = 0;

    var sum120 = 0;
    var sum121 = 0;
    var sum122 = 0;
    var sum123 = 0;

    var sum124 = 0;
    var sum125 = 0;
    var sum126= 0;

    var sum127 = 0;
    var sum128 = 0;

    var sum129 = 0;
    var sum130 = 0;

    var sum131 = 0;
    var sum132 = 0;
    var sum133 = 0;

    var sum134 = 0;
    var sum135 = 0;
    var sum136 = 0;

    var sum137 = 0;
    var sum138 = 0;
    var sum139 = 0;

    var sum140 = 0;
    var sum141 = 0;
    var sum142 = 0;

    var sum143= 0;
    var sum144 = 0;
    var sum145= 0;

    var sum146= 0;
    var sum147= 0;

    var sum148= 0;
    var sum149= 0;

    var sum150= 0;
    var sum151 = 0;
    var sum152 = 0;

    var sum153= 0;
    var sum154 = 0;
    var sum155 = 0;
    var sum156 = 0;
    var sum157 = 0;

    var sum158 = 0;

    var sum159= 0;
    var sum160 = 0;
    var sum161 = 0;
    var sum162 = 0;
    var sum163 = 0;
    var sum164 = 0;
    var sum165 = 0;
    var sum166 = 0;
    var sum167 = 0;
    var sum168 = 0;
    var sum169 = 0;
    var sum170 = 0;
    var sum171 = 0;
    var sum172 = 0;
    var sum173 = 0;
    var sum174 = 0;
    var sum175 = 0;
    var sum176 = 0;
    var sum177 = 0;

    var sum178 = 0;
    var sum179 = 0;
    var sum180 = 0;
    var sum181 = 0;
    var sum182 = 0;
    var sum183 = 0;

    var sum184 = 0;
    var sum185 = 0;
    var sum186 = 0;
    var sum187 = 0;

    var sum188 = 0;
    var sum189 = 0;
    var sum190 = 0;
    var sum191 = 0;

    var sum192 = 0;
    var sum193 = 0;
    var sum194 = 0;
    var sum195 = 0;

    var sum196 = 0;
    var sum197 = 0;
    var sum198 = 0;
    var sum199 = 0;

    var sum200 = 0;
    var sum201 = 0;
    var sum202 = 0;

    var sum203 = 0;
    var sum204 = 0;
    var sum205 = 0;
    var sum206 = 0;
    var sum207 = 0;

    var sum208 = 0;
    var sum209 = 0;
    var sum210 = 0;
    var sum211 = 0;
  
    var sum212 = 0;
    var sum213 = 0;

    var sum214 = 0;
    var sum215 = 0;
    var sum216 = 0;
    var sum217 = 0;
    var sum218 = 0;
    var sum219 = 0;

    var sum220 = 0;
    var sum221 = 0;
    var sum222 = 0;
    var sum223 = 0;
    var sum224 = 0;
    var sum225 = 0;
    var sum226 = 0;

    var sum227 = 0;
    var sum228 = 0;
    var sum229 = 0;

    var sum230 = 0;
    var sum231 = 0;
    var sum232 = 0;
    var sum233 = 0;

    var sum234 = 0; var sum235 = 0;

    var sum236 = 0;
    var sum237 = 0;
    var sum238 = 0;
    var sum239 = 0;
    var sum240 = 0; 

    var msum0 = 0;
    var msum1 = 0;
    var msum2 = 0;
    var msum3 = 0;
    var msum4 = 0;
    var msum5 = 0;
    var msum6 = 0;
    var msum7 = 0;
    var msum8 = 0;
    var msum9 = 0;
    var msum10 = 0;
    var msum11 = 0;

    var msum12 = 0;
    var msum13 = 0;
    var msum14 = 0;
    var msum15 = 0;
    var msum16 = 0;
    var msum17 = 0;
    var msum18 = 0;
    var msum19 = 0;
    var msum20 = 0;
    var msum21 = 0;

    var msum22 = 0;
    var msum23 = 0;
    var msum24 = 0;
    var msum25 = 0;
    var msum26 = 0;
    var msum27 = 0;
    var msum28 = 0;
    var msum29 = 0;
    var msum30 = 0;

    var msum31 = 0;
    var msum32 = 0;
    var msum33 = 0;
    var msum34 = 0;
    var msum35 = 0;
    var msum36 = 0;
    var msum37 = 0;
    var msum38 = 0;
    var msum39 = 0;
    var msum40 = 0;

    var msum41 = 0;
    var msum42 = 0;
    var msum43 = 0;
    var msum44 = 0;
    var msum45 = 0;
    var msum46 = 0;
    var msum47 = 0;
    var msum48 = 0;
    var msum49 = 0;
    var msum50 = 0;

    var msum51 = 0;
    var msum52 = 0;
    var msum53 = 0;
    var msum54 = 0;
    var msum55 = 0;
    var msum56 = 0;
    var msum57 = 0;
    var msum58 = 0;
    var msum59 = 0;
    var msum60 = 0;

    var msum61 = 0;
    var msum62 = 0;
    var msum63 = 0;
    var msum64 = 0;
    var msum65 = 0;
    var msum66 = 0;
    var msum67 = 0;
    var msum68 = 0;
    var msum69 = 0;
    var msum70 = 0;
    var msum71 = 0;
    var msum72 = 0;

    var msum73 = 0;
    var msum74 = 0;
    var msum75 = 0;
    var msum76 = 0;
    var msum77 = 0;

    var msum78 = 0;
    var msum79 = 0;
    var msum80 = 0;

    var msum81 = 0;
    var msum82 = 0;
    var msum83 = 0;

    var msum84 = 0;
    var msum85 = 0;
    var msum86 = 0;
    var msum87 = 0;

    var msum88 = 0;
    var msum89 = 0;
    var msum90 = 0;
    var msum91 = 0;
    var msum92 = 0;

    var msum93 = 0;
    var msum94 = 0;
    var msum95 = 0;
    var msum96 = 0;
    var msum97 = 0;

    var msum98 = 0;
    var msum99 = 0;
    var msum100 = 0;

    var msum101 = 0;

    var msum102= 0;
    var msum103= 0;
    var msum104 = 0;
    var msum105 = 0;

    var msum106 = 0;
    var msum107 = 0;
    var msum108= 0;

    var msum109= 0;
    var msum110 = 0;
    var msum111 = 0;
    var msum112 = 0;

    var msum113 = 0;
    var msum114 = 0;
    var msum115 = 0;

    var msum116 = 0;
    var msum117 = 0;
    var msum118 = 0;
    var msum119 = 0;

    var msum120 = 0;
    var msum121 = 0;
    var msum122 = 0;
    var msum123 = 0;

    var msum124 = 0;
    var msum125 = 0;
    var msum126= 0;

    var msum127 = 0;
    var msum128 = 0;

    var msum129 = 0;
    var msum130 = 0;

    var msum131 = 0;
    var msum132 = 0;
    var msum133 = 0;

    var msum134 = 0;
    var msum135 = 0;
    var msum136 = 0;

    var msum137 = 0;
    var msum138 = 0;
    var msum139 = 0;

    var msum140 = 0;
    var msum141 = 0;
    var msum142 = 0;

    var msum143= 0;
    var msum144 = 0;
    var msum145= 0;

    var msum146= 0;
    var msum147= 0;

    var msum148= 0;
    var msum149= 0;

    var msum150= 0;
    var msum151 = 0;
    var msum152 = 0;

    var msum153= 0;
    var msum154 = 0;
    var msum155 = 0;
    var msum156 = 0;
    var msum157 = 0;

    var msum158 = 0;

    var msum159= 0;
    var msum160 = 0;
    var msum161 = 0;
    var msum162 = 0;
    var msum163 = 0;
    var msum164 = 0;
    var msum165 = 0;
    var msum166 = 0;
    var msum167 = 0;
    var msum168 = 0;
    var msum169 = 0;
    var msum170 = 0;
    var msum171 = 0;
    var msum172 = 0;
    var msum173 = 0;
    var msum174 = 0;
    var msum175 = 0;
    var msum176 = 0;
    var msum177 = 0;

    var msum178 = 0;
    var msum179 = 0;
    var msum180 = 0;
    var msum181 = 0;
    var msum182 = 0;
    var msum183 = 0;

    var msum184 = 0;
    var msum185 = 0;
    var msum186 = 0;
    var msum187 = 0;

    var msum188 = 0;
    var msum189 = 0;
    var msum190 = 0;
    var msum191 = 0;

    var msum192 = 0;
    var msum193 = 0;
    var msum194 = 0;
    var msum195 = 0;

    var msum196 = 0;
    var msum197 = 0;
    var msum198 = 0;
    var msum199 = 0;

    var msum200 = 0;
    var msum201 = 0;
    var msum202 = 0;

    var msum203 = 0;
    var msum204 = 0;
    var msum205 = 0;
    var msum206 = 0;
    var msum207 = 0;

    var msum208 = 0;
    var msum209 = 0;
    var msum210 = 0;
    var msum211 = 0;
  
    var msum212 = 0;
    var msum213 = 0;

    var msum214 = 0;
    var msum215 = 0;
    var msum216 = 0;
    var msum217 = 0;
    var msum218 = 0;
    var msum219 = 0;

    var msum220 = 0;
    var msum221 = 0;
    var msum222 = 0;
    var msum223 = 0;
    var msum224 = 0;
    var msum225 = 0;
    var msum226 = 0;

    var msum227 = 0;
    var msum228 = 0;
    var msum229 = 0;

    var msum230 = 0;
    var msum231 = 0;
    var msum232 = 0;
    var msum233 = 0;

    var msum234 = 0; 
    var msum235 = 0;

    var msum236 = 0;
    var msum237 = 0;
    var msum238 = 0;
    var msum239 = 0;
    var msum240 = 0; 




var orgUnitChildren_Array = [];
var secondChildren_Array = [];
var orgUnit = dhis2.report.organisationUnit;
var orgUnitChildren = dhis2.report.organisationUnitChildren;
var selOrgUnitLevel = dhis2.report.organisationUnitHierarchy.length;

var count = 0;

document.getElementById('ouname').innerHTML = orgUnit.name;



$.each(orgUnitChildren, function (i, val) {
    orgUnitChildren_Array.push([val.id, val.name]);
});
orgUnitChildren_Array.sort(arraySorting);



// New Code start from here

var count1 = 0;

orgUnitChildren_Array.forEach(function (element, index) {
    var ouid = element[0];
    var ouidName = element[1];
    sample(ouid, ouidName, 1);
    if (orgUnitChildren_Array.length - 1 == index) {
        sample(ouid, ouidName, 0);
    }

}, this)

function datafordate(ouid, period) {
    var dataA = 0;
    $.ajax({
        async: false,
        url: "../api/dataValues.json?de=yl3ZGkjVbli&pe=" + period + "&ou=" + ouid + "",
        success: function (data) {
            dataA = data[0];
        }
    });
    return dataA;
}


function sample(ouid, ouidName, count1) {
    $.when(
        $.getJSON("../api/25/analytics.json?dimension=dx:RJfitXH0ogB.JwN0Nd8k7kd;RJfitXH0ogB.JIRcwduowqO;RJfitXH0ogB.Rxm0NEmxHzr;RJfitXH0ogB.Chgy01mVvk9;RJfitXH0ogB.uZ15uQTUzdv;RJfitXH0ogB.YlSZtA2RG6B;RJfitXH0ogB.GxstxsOgtR0;RJfitXH0ogB.X4dDBc8xo7X;zkKipoo5ZxD.JwN0Nd8k7kd;zkKipoo5ZxD.JIRcwduowqO;zkKipoo5ZxD.Rxm0NEmxHzr;zkKipoo5ZxD.ubW2IE0qoKr;zkKipoo5ZxD.uZ15uQTUzdv;zkKipoo5ZxD.YlSZtA2RG6B;zkKipoo5ZxD.GxstxsOgtR0;zkKipoo5ZxD.X4dDBc8xo7X;HGcV6Es1N8C.JwN0Nd8k7kd;HGcV6Es1N8C.JIRcwduowqO;HGcV6Es1N8C.Rxm0NEmxHzr;HGcV6Es1N8C.Chgy01mVvk9;HGcV6Es1N8C.uZ15uQTUzdv;HGcV6Es1N8C.YlSZtA2RG6B;HGcV6Es1N8C.GxstxsOgtR0;HGcV6Es1N8C.X4dDBc8xo7X;u7araRyzMU8.JwN0Nd8k7kd;u7araRyzMU8.JIRcwduowqO;u7araRyzMU8.Rxm0NEmxHzr;u7araRyzMU8.Chgy01mVvk9;u7araRyzMU8.uZ15uQTUzdv;u7araRyzMU8.YlSZtA2RG6B;u7araRyzMU8.GxstxsOgtR0;u7araRyzMU8.X4dDBc8xo7X;RhFZgNOtftw.JwN0Nd8k7kd;RhFZgNOtftw.JIRcwduowqO;RhFZgNOtftw.Rxm0NEmxHzr;RhFZgNOtftw.Chgy01mVvk9;RhFZgNOtftw.uZ15uQTUzdv;RhFZgNOtftw.YlSZtA2RG6B;RhFZgNOtftw.GxstxsOgtR0;RhFZgNOtftw.X4dDBc8xo7X;EPKygAxObKf.JwN0Nd8k7kd;EPKygAxObKf.JIRcwduowqO;EPKygAxObKf.Rxm0NEmxHzr;EPKygAxObKf.Chgy01mVvk9;EPKygAxObKf.uZ15uQTUzdv;EPKygAxObKf.YlSZtA2RG6B;EPKygAxObKf.GxstxsOgtR0;EPKygAxObKf.X4dDBc8xo7X;u436ufom16f.JwN0Nd8k7kd;u436ufom16f.JIRcwduowqO;u436ufom16f.Rxm0NEmxHzr;u436ufom16f.Chgy01mVvk9;u436ufom16f.uZ15uQTUzdv;u436ufom16f.YlSZtA2RG6B;u436ufom16f.GxstxsOgtR0;u436ufom16f.X4dDBc8xo7X&dimension=ou:" + ouid + "&filter=pe:" + periodcumulative + "&displayProperty=NAME", {
            format: "json"
        }),
        $.getJSON("../api/25/analytics.json?dimension=dx:RJfitXH0ogB.JwN0Nd8k7kd;RJfitXH0ogB.JIRcwduowqO;RJfitXH0ogB.Rxm0NEmxHzr;RJfitXH0ogB.Chgy01mVvk9;RJfitXH0ogB.uZ15uQTUzdv;RJfitXH0ogB.YlSZtA2RG6B;RJfitXH0ogB.GxstxsOgtR0;RJfitXH0ogB.X4dDBc8xo7X;zkKipoo5ZxD.JwN0Nd8k7kd;zkKipoo5ZxD.JIRcwduowqO;zkKipoo5ZxD.Rxm0NEmxHzr;zkKipoo5ZxD.ubW2IE0qoKr;zkKipoo5ZxD.uZ15uQTUzdv;zkKipoo5ZxD.YlSZtA2RG6B;zkKipoo5ZxD.GxstxsOgtR0;zkKipoo5ZxD.X4dDBc8xo7X;HGcV6Es1N8C.JwN0Nd8k7kd;HGcV6Es1N8C.JIRcwduowqO;HGcV6Es1N8C.Rxm0NEmxHzr;HGcV6Es1N8C.Chgy01mVvk9;HGcV6Es1N8C.uZ15uQTUzdv;HGcV6Es1N8C.YlSZtA2RG6B;HGcV6Es1N8C.GxstxsOgtR0;HGcV6Es1N8C.X4dDBc8xo7X;u7araRyzMU8.JwN0Nd8k7kd;u7araRyzMU8.JIRcwduowqO;u7araRyzMU8.Rxm0NEmxHzr;u7araRyzMU8.Chgy01mVvk9;u7araRyzMU8.uZ15uQTUzdv;u7araRyzMU8.YlSZtA2RG6B;u7araRyzMU8.GxstxsOgtR0;u7araRyzMU8.X4dDBc8xo7X;RhFZgNOtftw.JwN0Nd8k7kd;RhFZgNOtftw.JIRcwduowqO;RhFZgNOtftw.Rxm0NEmxHzr;RhFZgNOtftw.Chgy01mVvk9;RhFZgNOtftw.uZ15uQTUzdv;RhFZgNOtftw.YlSZtA2RG6B;RhFZgNOtftw.GxstxsOgtR0;RhFZgNOtftw.X4dDBc8xo7X;EPKygAxObKf.JwN0Nd8k7kd;EPKygAxObKf.JIRcwduowqO;EPKygAxObKf.Rxm0NEmxHzr;EPKygAxObKf.Chgy01mVvk9;EPKygAxObKf.uZ15uQTUzdv;EPKygAxObKf.YlSZtA2RG6B;EPKygAxObKf.GxstxsOgtR0;EPKygAxObKf.X4dDBc8xo7X;u436ufom16f.JwN0Nd8k7kd;u436ufom16f.JIRcwduowqO;u436ufom16f.Rxm0NEmxHzr;u436ufom16f.Chgy01mVvk9;u436ufom16f.uZ15uQTUzdv;u436ufom16f.YlSZtA2RG6B;u436ufom16f.GxstxsOgtR0;u436ufom16f.X4dDBc8xo7X&dimension=ou:" + ouid + "&filter=pe:" + period + "&displayProperty=NAME", {
            format: "json"
        })
    ).then(function (res4, res5) {
        count++;
        finalvalue(res4, res5, ouidName, count, count1);
    })
}



function finalvalue(res4, res5, ouidName, count, count1) {

    if (count1 != 0) {

        value0 = datavalue(res5[0], 'RJfitXH0ogB.JwN0Nd8k7kd');
        value1 = datavalue(res4[0], 'RJfitXH0ogB.JwN0Nd8k7kd');

        value2 = datavalue(res5[0], 'RJfitXH0ogB.JIRcwduowqO');
        value3 = datavalue(res4[0], 'RJfitXH0ogB.JIRcwduowqO');

        value4 = datavalue(res5[0], 'RJfitXH0ogB.Rxm0NEmxHzr');
        value5 = datavalue(res4[0], 'RJfitXH0ogB.Rxm0NEmxHzr');

        value6 = datavalue(res5[0], 'RJfitXH0ogB.Chgy01mVvk9');
        value7 = datavalue(res4[0], 'RJfitXH0ogB.Chgy01mVvk9');
       

        value8 = datavalue(res5[0], 'RJfitXH0ogB.uZ15uQTUzdv');
        value9 = datavalue(res4[0], 'RJfitXH0ogB.uZ15uQTUzdv');
    

        value10 = datavalue(res5[0], 'RJfitXH0ogB.YlSZtA2RG6B');
        value11 = datavalue(res4[0], 'RJfitXH0ogB.YlSZtA2RG6B');

        value12 = datavalue(res5[0], 'RJfitXH0ogB.GxstxsOgtR0');
        value13 = datavalue(res4[0], 'RJfitXH0ogB.GxstxsOgtR0');

        value14 = datavalue(res5[0], 'RJfitXH0ogB.X4dDBc8xo7X');
        value15 = datavalue(res4[0], 'RJfitXH0ogB.X4dDBc8xo7X');

        value16 = datavalue(res5[0], 'zkKipoo5ZxD.JwN0Nd8k7kd');
       value17 = datavalue(res4[0], 'zkKipoo5ZxD.JwN0Nd8k7kd');

        value18 = datavalue(res5[0], 'zkKipoo5ZxD.JIRcwduowqO');
        value19 = datavalue(res4[0], 'zkKipoo5ZxD.JIRcwduowqO');

        value20 = datavalue(res5[0], 'zkKipoo5ZxD.Rxm0NEmxHzr');
        value21 = datavalue(res4[0], 'zkKipoo5ZxD.Rxm0NEmxHzr');
   
        value22 = datavalue(res5[0], 'zkKipoo5ZxD.ubW2IE0qoKr');
        value23 = datavalue(res4[0], 'zkKipoo5ZxD.ubW2IE0qoKr');
      
        value24 = datavalue(res5[0], 'zkKipoo5ZxD.uZ15uQTUzdv');
        value25 = datavalue(res4[0], 'zkKipoo5ZxD.uZ15uQTUzdv');

        value26 = datavalue(res5[0], 'zkKipoo5ZxD.YlSZtA2RG6B');
        value27 = datavalue(res4[0], 'zkKipoo5ZxD.YlSZtA2RG6B');

        value28 = datavalue(res5[0], 'zkKipoo5ZxD.GxstxsOgtR0');
        value29 = datavalue(res4[0], 'zkKipoo5ZxD.GxstxsOgtR0');

        value30 = datavalue(res5[0], 'zkKipoo5ZxD.X4dDBc8xo7X');
        value31 = datavalue(res4[0], 'zkKipoo5ZxD.X4dDBc8xo7X'); 

        value32 = datavalue(res5[0], 'HGcV6Es1N8C.JwN0Nd8k7kd'); 
        value33 = datavalue(res4[0], 'HGcV6Es1N8C.JwN0Nd8k7kd');

        value34 = datavalue(res5[0], 'HGcV6Es1N8C.JIRcwduowqO');
        value35 = datavalue(res4[0], 'HGcV6Es1N8C.JIRcwduowqO');
        //0
        value36 = datavalue(res5[0], 'HGcV6Es1N8C.Rxm0NEmxHzr');
        value37 = datavalue(res4[0], 'HGcV6Es1N8C.Rxm0NEmxHzr');

        value38 = datavalue(res5[0], 'HGcV6Es1N8C.Chgy01mVvk9');
        value39 = datavalue(res4[0], 'HGcV6Es1N8C.Chgy01mVvk9');

        value40 = datavalue(res5[0], 'HGcV6Es1N8C.uZ15uQTUzdv');
        value41 = datavalue(res4[0], 'HGcV6Es1N8C.uZ15uQTUzdv');

        value42 = datavalue(res5[0], 'HGcV6Es1N8C.YlSZtA2RG6B');
        value43 = datavalue(res4[0], 'HGcV6Es1N8C.YlSZtA2RG6B');

      
        value44 = datavalue(res5[0], 'HGcV6Es1N8C.GxstxsOgtR0');
        value45 = datavalue(res4[0], 'HGcV6Es1N8C.GxstxsOgtR0');
     

        value46 = datavalue(res5[0], 'HGcV6Es1N8C.X4dDBc8xo7X');
        value47 = datavalue(res4[0], 'HGcV6Es1N8C.X4dDBc8xo7X');

        value48 = datavalue(res5[0], 'u7araRyzMU8.JwN0Nd8k7kd');
        value49 = datavalue(res4[0], 'u7araRyzMU8.JwN0Nd8k7kd');

        value50 = datavalue(res5[0], 'u7araRyzMU8.JIRcwduowqO');
        value51 = datavalue(res4[0], 'u7araRyzMU8.JIRcwduowqO');

        value52 = datavalue(res5[0], 'u7araRyzMU8.Rxm0NEmxHzr');
       value53 = datavalue(res4[0], 'u7araRyzMU8.Rxm0NEmxHzr');

        value54 = datavalue(res5[0], 'u7araRyzMU8.Chgy01mVvk9');
        value55 = datavalue(res4[0], 'u7araRyzMU8.Chgy01mVvk9');

        value56 = datavalue(res5[0], 'u7araRyzMU8.uZ15uQTUzdv');
        value57 = datavalue(res4[0], 'u7araRyzMU8.uZ15uQTUzdv');
       
        value58 = datavalue(res5[0], 'u7araRyzMU8.YlSZtA2RG6B');
        value59 = datavalue(res4[0], 'u7araRyzMU8.YlSZtA2RG6B');
        //

        value60 = datavalue(res5[0], 'u7araRyzMU8.GxstxsOgtR0');
        value61 = datavalue(res4[0], 'u7araRyzMU8.GxstxsOgtR0');

        value62 = datavalue(res5[0], 'u7araRyzMU8.X4dDBc8xo7X');
        value63 = datavalue(res4[0], 'u7araRyzMU8.X4dDBc8xo7X');  


        value64 = datavalue(res5[0], 'RhFZgNOtftw.JwN0Nd8k7kd');
       value65 = datavalue(res4[0], 'RhFZgNOtftw.JwN0Nd8k7kd');
       
       value66 = datavalue(res5[0], 'RhFZgNOtftw.JIRcwduowqO');
       value67 = datavalue(res4[0], 'RhFZgNOtftw.JIRcwduowqO');
       
       value68 = datavalue(res5[0], 'RhFZgNOtftw.Rxm0NEmxHzr');
       value69 = datavalue(res4[0], 'RhFZgNOtftw.Rxm0NEmxHzr');
       
       value70 = datavalue(res5[0], 'RhFZgNOtftw.Chgy01mVvk9');
       value71 = datavalue(res4[0], 'RhFZgNOtftw.Chgy01mVvk9');
       
       value72 = datavalue(res5[0], 'RhFZgNOtftw.uZ15uQTUzdv');
       value73 = datavalue(res4[0], 'RhFZgNOtftw.uZ15uQTUzdv');
       
       value74 = datavalue(res5[0], 'RhFZgNOtftw.YlSZtA2RG6B');
       value75 = datavalue(res4[0], 'RhFZgNOtftw.YlSZtA2RG6B');
       
       value76 = datavalue(res5[0], 'RhFZgNOtftw.GxstxsOgtR0');
       value77 = datavalue(res4[0], 'RhFZgNOtftw.GxstxsOgtR0');
       
       value78 = datavalue(res5[0], 'RhFZgNOtftw.X4dDBc8xo7X');
       value79 = datavalue(res4[0], 'RhFZgNOtftw.X4dDBc8xo7X');

      
       value80 = datavalue(res5[0], 'EPKygAxObKf.JwN0Nd8k7kd');
        value81 = datavalue(res4[0], 'EPKygAxObKf.JwN0Nd8k7kd');

        value82 = datavalue(res5[0], 'EPKygAxObKf.JIRcwduowqO');
        value83 = datavalue(res4[0], 'EPKygAxObKf.JIRcwduowqO');

        value84= datavalue(res5[0], 'EPKygAxObKf.Rxm0NEmxHzr');
        value85 = datavalue(res4[0], 'EPKygAxObKf.Rxm0NEmxHzr');

        value86 = datavalue(res5[0], 'EPKygAxObKf.Chgy01mVvk9');
        value87 = datavalue(res4[0], 'EPKygAxObKf.Chgy01mVvk9');

        value88 = datavalue(res5[0], 'EPKygAxObKf.uZ15uQTUzdv');
        value89 = datavalue(res4[0], 'EPKygAxObKf.uZ15uQTUzdv');
        
        value90 = datavalue(res5[0], 'EPKygAxObKf.YlSZtA2RG6B');
        value91 = datavalue(res4[0], 'EPKygAxObKf.YlSZtA2RG6B');
       

        value92 = datavalue(res5[0], 'EPKygAxObKf.GxstxsOgtR0');
        value93 = datavalue(res4[0], 'EPKygAxObKf.GxstxsOgtR0');

        value94 = datavalue(res5[0], 'EPKygAxObKf.X4dDBc8xo7X');
        value95 = datavalue(res4[0], 'EPKygAxObKf.X4dDBc8xo7X');

        value96 = datavalue(res5[0], 'u436ufom16f.JwN0Nd8k7kd');
       value97 = datavalue(res4[0], 'u436ufom16f.JwN0Nd8k7kd');

        value98 = datavalue(res5[0], 'u436ufom16f.JIRcwduowqO');
        value99 = datavalue(res4[0], 'u436ufom16f.JIRcwduowqO');

        value100 = datavalue(res5[0], 'u436ufom16f.Rxm0NEmxHzr');
        value101 = datavalue(res4[0], 'u436ufom16f.Rxm0NEmxHzr');

        value102 = datavalue(res5[0], 'u436ufom16f.Chgy01mVvk9');
        value103 = datavalue(res4[0], 'u436ufom16f.Chgy01mVvk9');

        value104 = datavalue(res5[0], 'u436ufom16f.uZ15uQTUzdv');
       value105 = datavalue(res4[0], 'u436ufom16f.uZ15uQTUzdv');

        value106 = datavalue(res5[0], 'u436ufom16f.YlSZtA2RG6B');
       value107 = datavalue(res4[0], 'u436ufom16f.YlSZtA2RG6B');

        value108 = datavalue(res5[0], 'u436ufom16f.GxstxsOgtR0');
        value109 = datavalue(res4[0], 'u436ufom16f.GxstxsOgtR0');

        value110 = datavalue(res5[0], 'u436ufom16f.X4dDBc8xo7X');
        value111 = datavalue(res4[0], 'u436ufom16f.X4dDBc8xo7X');





   

            var tabledata = '<tr>';

                    tabledata +=  ("<td rowspan = '7' style = 'border-top:1px solid black'>" + count + "</td><td rowspan = '7' style = 'border-top:1px solid black'>" + orgUnit.name + "</td><td rowspan = '7' style = 'border-top:1px solid black'>" + ouidName + "</td><td style = 'border-top:1px solid black'> Dental Caries </td><td style = 'border-top:1px solid black'>" + value0 + "</td><td style = 'border-top:1px solid black'>" + value1 + "</td><td style = 'border-top:1px solid black'>" + value2 + "</td><td style = 'border-top:1px solid black'>" + value3 + "</td><td style = 'border-top:1px solid black'>" + value4 + "</td><td style = 'border-top:1px solid black'>" + value5 + "</td><td style = 'border-top:1px solid black'>" + value6 + "</td><td style = 'border-top:1px solid black'>" + value7 + "</td><td style = 'border-top:1px solid black'>" + value8 + "</td><td style = 'border-top:1px solid black'>" + value9 + "</td><td style = 'border-top:1px solid black'>" + value10 + "</td><td style = 'border-top:1px solid black'>" + value11 + "</td><td style = 'border-top:1px solid black'>" + value12 + "</td><td style = 'border-top:1px solid black'>" + value13 + "</td><td style = 'border-top:1px solid black'>" + value14 + "</td><td style = 'border-top:1px solid black'>" + value15 + "</td><tr><td>Gingivitis</td><td>" +  value16 + "</td><td>" + value17 + "</td><td>" + value18 + "</td><td>" + value19 + "</td><td>" + value20 + "</td><td>" + value21 + "</td><td> " + value22 + "</td><td>" + value23 + "</td><td>" + value24 + "</td><td>" + value25 + "</td><td>" + value26 + "</td><td>" + value27 + "</td><td>" + value28 + "</td><td>" + value29 + "</td><td>" + value30 + "</td><td>" + value31 + "</td></tr><tr><td>Periodontitis</td><td>" + value32 + "</td><td>" + value33 + "</td><td>" + value34 + "</td><td>" + value35 + "</td><td>" + value36 + "</td><td>" + value37 + "</td><td>" + value38 + "</td><td>" + value39 + "</td><td>" + value40 + "</td ><td>" + value41 + "</td><td>" + value42 + "</td><td>" + value43 + "</td><td>" + value44 + "</td><td>" + value45 + "</td><td>" + value46 + "</td><td>" + value47 + "</td></tr><tr><td>Dental Trauma</td><td>" + value48 + "</td><td>" + value49 + "</td><td>" + value50 + "</td><td>" + value51 + "</td><td>" + value52 + "</td><td>" + value53 + "</td><td>" + value54 + "</td><td>" + value55 + "</td><td>" + value56 + "</td><td>" + value57 + "</td><td>" + value58 + "</td><td>" + value59 + "</td><td>" + value60 + "</td><td>" + value61 + "</td><td>" + value62 + "</td><td>" + value63 + "</td></tr><tr><td>Precancerous lessions/Conditions</td><td>" + value64 + "</td><td>" + value65 + "</td><td>" + value66 + "</td><td>" + value67 + "</td><td>" + value68 + "</td><td>" + value69 + "</td><td>" + value70 + "</td><td>" + value71 + "</td><td>" + value72 + "</td><td>" + value73 + "</td><td>" + value74 + "</td><td>" + value75 + "</td><td>" + value76 + "</td><td>" + value77 + "</td><td>" + value78 + "</td><td>" + value79 + "</td></tr><tr><td>Oral Cancer</td><td>" + value80 + "</td><td>" + value81 + "</td><td>" + value82 + "</td><td>" + value83 + "</td><td>" + value84 + "</td><td>" + value85 + "</td><td>" + value86 + "</td><td>" + value87 + "</td><td>" + value88 + "</td><td>" + value89 + "</td><td>" + value90 + "</td><td>" + value91 + "</td><td>" + value92 + "</td><td>" + value93 + "</td><td>" + value94 + "</td><td>" + value95 + "</td></tr><tr><td>Edentulaous ness</td><td>" + value96 + "</td><td>" + value97 + "</td><td>" + value98 + "</td><td>" + value99 + "</td><td>" + value100 + "</td><td>" + value101 + "</td><td>" + value102 + "</td><td>" + value103 + "</td><td>" + value104 + "</td><td>" + value105 + "</td><td>" + value106 + "</td><td>" + value107 + "</td><td>" + value108 + "</td><td>" + value109 + "</td><td>" + value110 + "</td><td>" + value111 + "</td>");
                        tabledata += "</tr>";
                   
        
        document.getElementById("dataTable").innerHTML += tabledata;
        document.getElementById("loader").style.display = "none";
        document.getElementById("printing").style.display = "block";

        sum1 += value1;
        sum2 += value2;
        sum3 += value3;
        sum4 += value4;
        sum5 += value5;
        sum6 += value6;
        sum7 += value7;
        sum8 += value8;
        sum9 += value9;
        sum10 += value10;
        sum11 += value11;

        sum12 += value12;
        sum13 += value13;
        sum14 += value14;
        sum15 += value15;
        sum16 += value16;
        sum17 += value17;
        sum18 += value18;
        sum19 += value19;
            sum20 += value20;
            sum21 += value21;

            sum22 += value22;
            sum23 += value23;
        sum24 += value24;
            sum25 += value25;
            sum26 += value26;
            sum27 += value27;
            sum28 += value28;
            sum29 += value29;
            sum30 += value30;

            sum22 += value22;
            sum23 += value23;
            sum24 += value24;
            sum25 += value25;
            sum26 += value26;
            sum27 += value27;
            sum28 += value28;
            sum29 += value29;
            sum30 += value30;

            sum31 += value31;
            sum32 += value32;
            sum33 += value33;
            sum34 += value34;
            sum35 += value35;
            sum36 += value36;
            sum37 += value37;
            sum38 += value38;
            sum39 += value39;
            sum40 += value40;

            sum41 += value41;
            sum42 += value42;
            sum43 += value43;
            sum44 += value44;
            sum45 += value45;
            sum46 += value46;
            sum47 += value47;
            sum48 += value48;
            sum49 += value49;
            sum50 += value50;
            sum51 +=value51;
            sum52 += value52;
            sum53 += value53;
            sum54 += value54;
            sum55 += value55;
            sum56 += value56;

            sum57 += value57;
            sum58 += value58;
            sum59 += value59;
            sum60 += value60;
            sum61 += value61;
            sum62 += value62;
            sum63 += value63;
            sum64 += value64;

            sum65 += value65;
            sum66 += value66;
            sum67 += value67;
            sum68 += value68;
            sum69 += value69;
            sum70 += value70;

            sum71 += value71;
            sum72 += value72;
            sum73 += value73;
            sum74 += value74;
            sum75 += value75;
            sum76 += value76;
            sum77 += value77;
            sum78 += value78;
            sum79 += value79;
            sum80 += value80;
            sum81 += value81;
            sum82 += value82;
            sum83 += value83;

            sum84 += value84;
            sum85 += value85;
            sum86 += value86;
            sum87 += value87;
            sum88 += value88;
            sum89 += value89;
            sum90 += value90;

            sum91 += value91;
            sum92 += value92;
            sum93 += value93;
            sum94 += value94;
            sum95 += value95;
            sum96 += value96;
            sum97 += value97;
            sum98 += value98;
            sum99 += value99;
            sum100 += value100;
            sum101+= value101;

            sum102+= value102;
            sum103+= value103;
            sum104+= value104;
            sum105+= value105;
            sum106+= value106;

            sum107 += value107;
            sum108 += value108;
            sum109 += value109;
            sum110 += value110;
            sum111 += value111;



    }
    else if (count1 == 0) {


        setTimeout(function () {
            tabledata =  ("<tr style='background:#ADD8E6'><td colspan='3'>Total</td><td> Dental Caries </td><td>" + sum0 + "</td><td>" + sum1 + "</td><td>" + sum2 + "</td><td>" + sum3 + "</td><td>" + sum4 + "</td><td>" + sum5 + "</td><td>" + sum6 + "</td><td>" + sum7 + "</td><td>" + sum8 + "</td><td>" + sum9 + "</td><td>" + sum10 + "</td><td>" + sum11 + "</td><td>" + sum12 + "</td><td>" + sum13 + "</td><td>" + sum14 + "</td><td>" + sum15 + "</td></tr><tr style='background:#ADD8E6'><td colspan='3'>Total</td><td>Gingivitis</td><td>" + sum16 + "</td><td>" + sum17 + "</td><td>" + sum18 + "</td><td>" + sum19 + "</td><td>" + sum20 + "</td><td>" + sum21 + "</td><td>" + sum22 + " </td><td>" + sum23 + "</td><td>" + sum24 + "</td><td>" + sum25 + "</td><td>" + sum26 + "</td><td>" + sum27 + "</td><td>" + sum28 + "</td><td>" + sum29 + "</td><td>" + sum30 + "</td><td>" + sum31 + "</td></tr><tr style='background:#ADD8E6'><td colspan='3'>Total</td><td>Periodontitis</td><td>" + sum32 + "</td><td>" + sum33 + "</td><td>" + sum34 + "</td><td>" + sum35 + "</td><td>" + sum36 + "</td><td>" + sum37 + "</td><td>" + sum38 + "</td><td>" + sum39 + "</td><td>" + sum40 + "</td ><td>" + sum41 + "</td><td>" + sum42 + "</td><td>" + sum43 + "</td><td>" + sum44 + "</td><td>" + sum45 + "</td><td>" + sum46 + "</td><td>" + sum47 + "</td></tr><tr style='background:#ADD8E6'><td colspan='3'>Total</td><td>Dental Trauma</td><td>" + sum48 + "</td><td>" + sum49 + "</td><td>" + sum50 + "</td><td>" + sum51 + "</td><td>" + sum52 + "</td><td>" + sum53 + "</td><td>" + sum54 + "</td><td>" + sum55 + "</td><td>" + sum56 + "</td><td>" + sum57 + "</td><td>" + sum58 + "</td><td>" + sum59 + "</td><td>" + sum60 + "</td><td>" + sum61 + "</td><td>" + sum62 + "</td><td>" + sum63 + "</td></tr><tr style='background:#ADD8E6'><td colspan='3'>Total</td><td>Precancerous lessions/Conditions</td><td>" + sum64 + "</td><td>" + sum65 + "</td><td>" + sum66 + "</td><td>" + sum67 + "</td><td>" + sum68 + "</td><td>" + sum69 + "</td><td>" + sum70 + "</td><td>" + sum71 + "</td><td>" + sum72 + "</td><td>" + sum73 + "</td><td>" + sum74 + "</td><td>" + sum75 + "</td><td>" + sum76 + "</td><td>" + sum77 + "</td><td>" + sum78 + "</td><td>" + sum79 + "</td></tr><tr style='background:#ADD8E6'><td colspan='3'>Total</td><td>Oral Cancer</td><td>" + sum80 + "</td><td>" + sum81 + "</td><td>" + sum82 + "</td><td>" + sum83 + "</td><td>" + sum84 + "</td><td>" + sum85 + "</td><td>" + sum86 + "</td><td>" + sum87 + "</td><td>" + sum88 + "</td><td>" + sum89 + "</td><td>" + sum90 + "</td><td>" + sum91 + "</td><td>" + sum92 + "</td><td>" + sum93 + "</td><td>" + sum94 + "</td><td>" + sum95 + "</td></tr><tr style='background:#ADD8E6'><td colspan='3'>Total</td><td>Edentulaous ness</td><td>" + sum96 + "</td><td>" + sum97 + "</td><td>" + sum98 + "</td><td>" + sum99 + "</td><td>" + sum100 + "</td><td>" + sum101 + "</td><td>" + sum102 + "</td><td>" + sum103 + "</td><td>" + sum104 + "</td><td>" + sum105 + "</td><td>" + sum106 + "</td><td>" + sum107 + "</td><td>" + sum108 + "</td><td>" + sum109 + "</td><td>" + sum110 + "</td><td>" + sum111 + "</td></tr>");
            
                            document.getElementById("dataTable").innerHTML += tabledata;

        }, 1000);


    }

}


function datavalue(dataJSON, id) {
    var value1 = 0;
    for (var i = 0; i < dataJSON.rows.length; i++) {
        if (dataJSON.rows[i][0] == id) {
            value1 = parseInt(dataJSON.rows[i][2]);
        }
    }
    return (value1);
}


function datavalue1(dataJSON, id, id1) {
    var value1 = 'No';
    for (var i = 0; i < dataJSON.rows.length; i++) {
        if (dataJSON.rows[i][0] == id) {
            value1 = 'Yes';
        }
    }
    return (value1);
}


function arraySorting(a, b) {
    return ((a[1] < b[1]) ? -1 : ((a[1] > b[1]) ? 1 : 0));
}

function getPeriod(pr) {
    var year = pr.substring(0, 4);
    var month = pr.substring(4, 6);
    var strMonth = "";

    if (month == "01" || month == "1") strMonth = "January";
    else if (month == "02" || month == "2") strMonth = "February";
    else if (month == "03" || month == "3") strMonth = "March";
    else if (month == "04" || month == "4") strMonth = "April";
    else if (month == "05" || month == "5") strMonth = "May";
    else if (month == "06" || month == "6") strMonth = "June";
    else if (month == "07" || month == "7") strMonth = "July";
    else if (month == "08" || month == "8") strMonth = "August";
    else if (month == "09" || month == "9") strMonth = "September";
    else if (month == "10") strMonth = "October";
    else if (month == "11") strMonth = "November";
    else if (month == "12") strMonth = "December";

    return strMonth + " " + year;
}

function getPeriods() {
    var periodArray = [];
    var year = parseInt(gotPeriod.substring(0, 4));
    var mnth = parseInt(gotPeriod.substring(4, 6));

    if (mnth > 3) {
        for (var i = 4; i <= mnth; i++) {
            if (i < 10) {
                periodArray.push(year.toString() + "0" + i + ";");
            }
            else {
                periodArray.push(year.toString() + i + ";");
            }
        }
    }

    if (mnth <= 3) {
        for (var i = 4; i <= 12; i++) {
            if (i < 10) {
                periodArray.push((year - 1).toString() + "0" + i + ";");
            }
            else {
                periodArray.push((year - 1).toString() + i + ";");
            }
        }

        for (var i = 1; i <= mnth; i++) {
            if (i < 10) {
                periodArray.push(year.toString() + "0" + i + ";");
            }
            else {
                periodArray.push(year.toString() + i + ";");
            }
        }

    }
    return periodArray;
}

var tableToExcel = (function () {
    var uri = 'data:application/vnd.ms-excel;base64,'
        , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
        , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
        , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
    return function (table, name, filename) {
        if (!table.nodeType) table = document.getElementById(table)
        var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

        document.getElementById("dlink").href = uri + base64(format(template, ctx));
        document.getElementById("dlink").download = filename;
        document.getElementById("dlink").click();

    }
})()

</script>