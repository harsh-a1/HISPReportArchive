<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
crossorigin="anonymous">

<style>
thead>tr>td {
    font-weight: bold;
}
/* Center the loader */

#loader {
    position: absolute;
    left: 50%;
    top: 50%;
    z-index: 1;
    width: 150px;
    height: 150px;
    margin: -75px 0 0 -75px;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid #34B4DB;
    width: 120px;
    height: 120px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
}

@-webkit-keyframes spin {
    0% {
        -webkit-transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(360deg);
    }
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}
/* Add animation to "page content" */

.animate-bottom {
    position: relative;
    -webkit-animation-name: animatebottom;
    -webkit-animation-duration: 1s;
    animation-name: animatebottom;
    animation-duration: 1s
}

@-webkit-keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0px;
        opacity: 1
    }
}

@keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0;
        opacity: 1
    }
}

#printing {
    display: none;
    text-align: center;
}
</style>
<a id="dlink" style="display:none;"></a>

<button type="button" id="btnBack" class="btn brn-default btn-sm" style="vertical-align: middle;" onclick="location.href='../dhis-web-reports-app/index.html#/generate-report'"><span
class="glyphicon glyphicon-chevron-left" style="font-size: 15px;"></span>&nbsp; Goto Report Selection Page
</button>
<button type="button" class="btn btn-primary btn-sm" style="vertical-align: middle;" onclick="printContent('printing')"><span class="glyphicon glyphicon-print" style="font-size: 15px;"></span> &nbsp;
Print
</button>
<button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport" onclick="tableToExcel('dataTable', 'name', 'A summary report of revised Medical Tramination of Pregancy .xls')"><span class="glyphicon glyphicon-download-alt" style="font-size: 15px;"></span> &nbsp;
Download As Excel
</button>

<br><br>
<div id="loader"></div>
<div id="printing" style="display:none;" class="animate-bottom">
<div id='state'>
    <table width="100%" id="dataTable" border="1" class="table table-bordered table-hover text-center" cellspacing="6" cellpadding="4">
        <thead style="background:#ADD8E6; font-weight:400; text-align:center">
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; ">
                <td style="border:1px solid black" colspan="51">A summary report of revised Medical Tramination of Pregancy </td>
            </tr>
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                <td style="border:1px solid black" colspan="6">Organisation Unit:- <span id="ouname"></span></td>
                <td style="border:1px solid black; text-align:left" colspan="45">TimeStamp:-<span id="timeStamp"></span></td>
            </tr>
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                <td style="border:1px solid black" colspan="6">Reporting month:-<span id="periodName"></span></td>
                <td style="border:1px solid black" colspan="45">&nbsp;</td>
            </tr>
            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                <td style="border:1px solid black" rowspan="2" width="64">Sl.</td>
                <td style="border:1px solid black" rowspan="2" width="64" id="level1"></td>
                <td style="border:1px solid black" rowspan="2" width="64" id="level2"></td>
                <td style="border:1px solid black" colspan="2" width="128">1. Number of institutions approved to conduct MTP</td>
                <td style="border:1px solid black" colspan="4" width="128">2. Pregancy weeks (Number)</td>
                <td style="border:1px solid black" colspan="10" width="128">3. Age wise</td>
                <td style="border:1px solid black" colspan="8" width="128">4. Cause of Tramination of Pregancy</td>
                <td style="border:1px solid black" colspan="3" width="128">5. Area</td>
                <td style="border:1px solid black" rowspan="2" width="128">5. Total reported death  due to MTP</td>
                <td style="border:1px solid black" colspan="5" width="128">6. No. of facilities sending report</td>
                <td style="border:1px solid black" colspan="7" width="128">8. Accepted family planning method after MTP</td>
                <td style="border:1px solid black" colspan="7" width="128">9. Religion</td>
               
            </tr>

            <tr style="background:#ADD8E6; font-weight:400; text-align:center; border:1px solid black">
                <td style="border:1px solid black"  width="64">Govt.</td>
                <td style="border:1px solid black"  width="64">Private.</td>
                <td style="border:1px solid black"  width="64">up to 12 weeks</td>
                <td style="border:1px solid black"  width="64">12-20 weeks</td>
                <td style="border:1px solid black"  width="64">non classified</td>
                <td style="border:1px solid black"  width="64">Total</td>
                <td style="border:1px solid black"  width="64">less than 15 yr</td>
                <td style="border:1px solid black"  width="64">15-19 yr</td>
                <td style="border:1px solid black"  width="64">20-24 yr</td>
                <td style="border:1px solid black"  width="64">25-29 yr</td>
                <td style="border:1px solid black"  width="64">30-34 yr</td>
                <td style="border:1px solid black"  width="64">35-39 yr</td>
                <td style="border:1px solid black"  width="64">40-44 yr</td>
                <td style="border:1px solid black"  width="64">45 &amps; more</td>
                <td style="border:1px solid black"  width="64">non classified</td>
                <td style="border:1px solid black"  width="64">Total</td>
                <td style="border:1px solid black"  width="64">Threat for life of PW </td>
                <td style="border:1px solid black"  width="64">Threat for other factor of PW</td>
                <td style="border:1px solid black"  width="64">Threat for Mental health of PW</td>
                <td style="border:1px solid black"  width="64">Pregnancy due to rape</td>
                <td style="border:1px solid black"  width="64">If infant has threat for physical and menatal deformity or it is handicapped</td>
                <td style="border:1px solid black"  width="64">Failure of contraceptive method</td>
                <td style="border:1px solid black"  width="64">non classified</td>
                <td style="border:1px solid black"  width="64">Total</td>
                <td style="border:1px solid black"  width="64">Urban</td>
                <td style="border:1px solid black"  width="64">Rural</td>
                <td style="border:1px solid black"  width="64">Total</td>
                <td style="border:1px solid black"  width="64">No. of Gov. facilities sending report</td>
                <td style="border:1px solid black"  width="64">No. of Pvt. facilities sending report</td>
                <td style="border:1px solid black"  width="64">No. of MTP done by Gov. facilities</td>
                <td style="border:1px solid black"  width="64">No. of MTP done by Pvt. facilities</td>
                <td style="border:1px solid black"  width="64">Total</td>
                <td style="border:1px solid black"  width="64">Sterelization</td>
                <td style="border:1px solid black"  width="64">Copper-t</td>
                <td style="border:1px solid black"  width="64">OCP</td>
                <td style="border:1px solid black"  width="64">Conddom</td>
                <td style="border:1px solid black"  width="64">Non classified</td>
                <td style="border:1px solid black"  width="64">No any methords</td>
                <td style="border:1px solid black"  width="64">Total</td>
                <td style="border:1px solid black"  width="64">Hindu</td>
                <td style="border:1px solid black"  width="64">Muslim</td>
                <td style="border:1px solid black"  width="64">Christian</td>
                <td style="border:1px solid black"  width="64">Shikh</td>
                <td style="border:1px solid black"  width="64">Others</td>
                <td style="border:1px solid black"  width="64">Non classified</td>
                <td style="border:1px solid black"  width="64">Total</td>
               
            </tr>

          
        </thead>
    </table>
</div>
</div>
<!-- printing script -->
<script type="text/javascript">
function printContent(el) {
    var restorepage = document.body.innerHTML;
    var printcontent = document.getElementById(el).innerHTML;
    document.body.innerHTML = printcontent;
    window.print();
    document.body.innerHTML = restorepage;
}

</script>

<script>
// Code fr date and time stamp
var today = new Date();
var dd = today.getDate();
var mm = today.getMonth() + 1; //January is 0!
var yyyy = today.getFullYear();

if (dd < 10) {
    dd = '0' + dd
}

if (mm < 10) {
    mm = '0' + mm
}

today = mm + '/' + dd + '/' + yyyy;



function displayTime() {
    var str = "";

    var currentTime = new Date()
    var hours = currentTime.getHours()
    var minutes = currentTime.getMinutes()
    var seconds = currentTime.getSeconds()

    if (minutes < 10) {
        minutes = "0" + minutes
    }
    if (seconds < 10) {
        seconds = "0" + seconds
    }
    str += hours + ":" + minutes + ":" + seconds + " ";
    if (hours > 11) {
        str += "PM"
    } else {
        str += "AM"
    }
    return str;
}


document.getElementById('timeStamp').innerHTML = today + "-" + displayTime();

</script>

<script>
// How to force async functions to execute sequentially 
// by using deferred pipe chaining.

// The master deferred.
var dfd = $.Deferred(),  // Master deferred
    dfdNext = dfd; // Next deferred in the chain
x = 0, // Loop index
    values = [], // Saves loop values because functions are called after loop finishes


    // Simulates $.ajax, but with predictable behaviour.
    // You only need to understand that higher 'value' param will finish earlier.
    simulateAjax = function (value) {
        var dfdAjax = $.Deferred();
        // console.log('simulateAjax with value: ' + value);
        // console.log('simulateAjax DONE with value: ' + value);

        var res4 = $.ajax(
            {
                type: "GET",
                url: "../api/25/analytics.json?dimension=dx:cJuO09FbtTt.s1zm76jgYGp;cJuO09FbtTt.h6Rz3NjBtkB;ODM09OO2TFX.gMBrq91YZS2;ODM09OO2TFX.hfCavaPjxSV;ODM09OO2TFX.VvV30VHNxZQ;oCStX51SBzL.tESbn1TQcrE;oCStX51SBzL.H67YfOTFjY8;oCStX51SBzL.XWnjlzO5Y69;oCStX51SBzL.sewJeZdeUFe;oCStX51SBzL.yrVTU4CWcCm;oCStX51SBzL.t4OLM931oZM;oCStX51SBzL.sNljeoGXoyI;oCStX51SBzL.TpjpleIiGtl;oCStX51SBzL.NHC9bOwgXPO;koUQ6diR1OV.W0Ldd1v0ePf;koUQ6diR1OV.QY8zrBvHwVk;koUQ6diR1OV.ziLae2L1Z6P;koUQ6diR1OV.LKzTQ87jRKn;koUQ6diR1OV.WnwHfg8g1ae;koUQ6diR1OV.LcYtADp4pUO;koUQ6diR1OV.P2jBr8jKb7J;LAQdJj1xXOF.vbpK2kKrODH;LAQdJj1xXOF.mgP02vazHvj;nDyiQF8621e.Ti9FJqkSK6J;MNVMTECglhK.Ti9FJqkSK6J;XM80X304I9P.Ti9FJqkSK6J;Q9NgSZ4rMHW.Ti9FJqkSK6J;HSv23P9Wk78.ck7ltlqiHwT;HSv23P9Wk78.QCLBXG46wP9;HSv23P9Wk78.n2U4e9CrQlq;HSv23P9Wk78.xQK2Loj37St;HSv23P9Wk78.OMkeZeG0WPD;HSv23P9Wk78.hcFwQVwvoAA;BYEV1H8wLVr.D6cXMENcvrT;BYEV1H8wLVr.yIK12v4JA2K;BYEV1H8wLVr.fiNwN76mmpC;BYEV1H8wLVr.I32eatdUcEC;BYEV1H8wLVr.U2OLqJawQqA;BYEV1H8wLVr.v4Nznfpii9M;&dimension=ou:" + value + "&filter=pe:" + period + "&displayProperty=NAME",
                data: JSON,
                success: function (data4, status) {
                    dfdAjax.resolve(data4);
                    

                }
            });

        return dfdAjax.promise();
    },
    // This would be a user function that makes an ajax request
    requestAjax = function (value) {
        // console.log('requestAjax with value: ' + value);
        return simulateAjax(value);
    };

// Start the pipe chain.  You should be able to do this anywhere in the program, even
// at the end,and it should still give the same results.
// console.log('Setting off the pipes...');
dfd.resolve();

//Defferd code ends here 


var periods = dhis2.report.periods;
var period = periods[0];

var periodName = getPeriod(period);

document.getElementById('periodName').innerHTML = periodName;


var url = window.location.href;
var params = url.split('=');
var gotOrgUnit = params[3];
var gotPeriod = params[2].toString().substring(0, 6);
var periodArray = getPeriods();
var periodcum = periodArray.toString();
var periodcumulative = periodcum.replace(/,/g, "");


var selOrgUnitLevel = dhis2.report.organisationUnitHierarchy.length;


if (selOrgUnitLevel == 2) {
    document.getElementById('level1').innerHTML = "Divison Name";
    document.getElementById('level2').innerHTML = "District Name";
}
else if (selOrgUnitLevel == 3) {
    document.getElementById('level1').innerHTML = "District Name";
    document.getElementById('level2').innerHTML = "Block Name";
}
else if (selOrgUnitLevel == 4) {
    document.getElementById('level1').innerHTML = "Block Name";
    document.getElementById('level2').innerHTML = "Facility Name";
}

var value1=0;
var value2=0;
var value3=0;
var value4=0;
var value5=0;
var value6=0;
var value7=0;
var value8=0;
var value9=0;
var value10=0;
var value11=0;
var value12=0;
var value13=0;
var value14=0;
var value15=0;
var value16=0;
var value17=0;
var value18=0;
var value19=0;
var value20=0;
var value21=0;
var value22=0;
var value23=0;
var value24=0;
var value25=0;
var value26=0;
var value27=0;
var value28=0;
var value29=0;
var value30=0;
var value31=0;
var value32=0;
var value33=0;
var value34=0;
var value35=0;
var value36=0;
var value37=0;
var value38=0;
var value39=0;
var value40=0;
var value41=0;
var value42=0;
var value43=0;
var value44=0;
var value45=0;
var value46=0;

var sum1=0;
var sum2=0;
var sum3=0;
var sum4=0;
var sum5=0;
var sum6=0;
var sum7=0;
var sum8=0;
var sum9=0;
var sum10=0;
var sum11=0;
var sum12=0;
var sum13=0;
var sum14=0;
var sum15=0;
var sum16=0;
var sum17=0;
var sum18=0;
var sum19=0;
var sum20=0;
var sum21=0;
var sum22=0;
var sum23=0;
var sum24=0;
var sum25=0;
var sum26=0;
var sum27=0;
var sum28=0;
var sum29=0;
var sum30=0;
var sum31=0;
var sum32=0;
var sum33=0;
var sum34=0;
var sum35=0;
var sum36=0;
var sum37=0;
var sum38=0;
var sum39=0;
var sum40=0;
var sum41=0;
var sum42=0;
var sum43=0;
var sum44=0;
var sum45=0;
var sum46=0;



// Variables for grand total

var msum1=0;
var msum2=0;
var msum3=0;
var msum4=0;
var msum5=0;
var msum6=0;
var msum7=0;
var msum8=0;
var msum9=0;
var msum10=0;
var msum11=0;
var msum12=0;
var msum13=0;
var msum14=0;
var msum15=0;
var msum16=0;
var msum17=0;
var msum18=0;
var msum19=0;
var msum20=0;
var msum21=0;
var msum22=0;
var msum23=0;
var msum24=0;
var msum25=0;
var msum26=0;
var msum27=0;
var msum28=0;
var msum29=0;
var msum30=0;
var msum31=0;
var msum32=0;
var msum33=0;
var msum34=0;
var msum35=0;
var msum36=0;
var msum37=0;
var msum38=0;
var msum39=0;
var msum40=0;
var msum41=0;
var msum42=0;
var msum43=0;
var msum44=0;
var msum45=0;
var msum46=0;

var orgUnitChildren_Array = [];
var secondChildren_Array = [];
var orgUnit = dhis2.report.organisationUnit;
var orgUnitChildren = dhis2.report.organisationUnitChildren;
var selOrgUnitLevel = dhis2.report.organisationUnitHierarchy.length;



document.getElementById('ouname').innerHTML = orgUnit.name;



$.each(orgUnitChildren, function (i, val) {
    orgUnitChildren_Array.push([val.id, val.name]);
});
orgUnitChildren_Array.sort(arraySorting);



// New Code start from here
var count = 0;
var count1 = 0;
var secondChild = [];
var count4 = 0;




$.each(orgUnitChildren_Array, function (index, element) {
    var ouid = element[0];


    var orgUnitAPI = $.ajax(
        {
            type: "GET",
            async: 'false',
            url: "../api/organisationUnits/" + ouid + ".json?fields=children[id,name]&order=name:desc",
            data: JSON,
            success: function (data, status) {
            }
        });


    $.when(orgUnitAPI).then(function (res) {
        var ouidName = element[1];
        count4++;


        var values1 = [];
        var count3 = 0;
        for (var x = 0; x < res.children.length; x++) {

            values.push(res.children[x].id);
            values1.push(res.children[x].name);

            dfdNext = dfdNext.pipe(function () {

                var divName = values1.shift();
                var value = values.shift();

                return requestAjax(value).
                    done(function (response) {
                        count++;
                        count3++;



                        finalvalue(response, ouidName, divName, count);

                        if (count3 == res.children.length) {
                            finalvalue(0, 0, 0, 0);
                        }

                        if (index == orgUnitChildren_Array.length - 1 && count3 == res.children.length) {
                            finalvalue( 0, 0, 0, undefined, 00);
                        }

                    });
            });

        }

    });



})

//res 4 contains cumulative data
//res5 contains monthly data

function finalvalue( res5, ouidName, name, count, count1) {

    if (count != 0 && count != undefined) {

                    value1 = datavalue(res5, 'cJuO09FbtTt.s1zm76jgYGp');
        
                    value2 = datavalue(res5, 'cJuO09FbtTt.h6Rz3NjBtkB');
        
                    value3 = datavalue(res5, 'ODM09OO2TFX.gMBrq91YZS2');
        
                    value4 = datavalue(res5, 'ODM09OO2TFX.hfCavaPjxSV');
        
                    value5 = datavalue(res5, 'ODM09OO2TFX.VvV30VHNxZQ');
        
                    value6 = value3+value4+value5;

                    value7 = datavalue(res5, 'oCStX51SBzL.tESbn1TQcrE');

                    value8 = datavalue(res5, 'oCStX51SBzL.H67YfOTFjY8');

                    value9 = datavalue(res5, 'oCStX51SBzL.XWnjlzO5Y69');

                    value10 = datavalue(res5, 'oCStX51SBzL.sewJeZdeUFe');

                    value11 = datavalue(res5, 'oCStX51SBzL.yrVTU4CWcCm');

                    value12 = datavalue(res5, 'oCStX51SBzL.t4OLM931oZM');

                    value13 = datavalue(res5, 'oCStX51SBzL.sNljeoGXoyI');

                    value14 = datavalue(res5, 'oCStX51SBzL.TpjpleIiGtl');

                    value15 = datavalue(res5, 'oCStX51SBzL.NHC9bOwgXPO');

                    value16 = value7+value8+value9+value10+value11+value12+value13+value14+value15;

                    value17 = datavalue(res5, 'koUQ6diR1OV.W0Ldd1v0ePf');

                    value18 = datavalue(res5, 'koUQ6diR1OV.QY8zrBvHwVk');

                    value19 = datavalue(res5, 'koUQ6diR1OV.ziLae2L1Z6P');

                    value20 = datavalue(res5, 'koUQ6diR1OV.LKzTQ87jRKn');

                    value21 = datavalue(res5, 'koUQ6diR1OV.WnwHfg8g1ae');

                    value22 = datavalue(res5, 'koUQ6diR1OV.LcYtADp4pUO');

                    value23 = datavalue(res5, 'koUQ6diR1OV.P2jBr8jKb7J');

                    value24 = value17+value18+value19+value20+value21+value22+value23;

                    value25 = datavalue(res5, 'LAQdJj1xXOF.vbpK2kKrODH');

                    value26 = datavalue(res5, 'LAQdJj1xXOF.mgP02vazHvj');

                    value27 = value25+value26;

                    value28 = datavalue(res5, 'nDyiQF8621e.Ti9FJqkSK6J');

                    value29 = datavalue(res5, 'MNVMTECglhK.Ti9FJqkSK6J');

                    value30 = datavalue(res5, 'XM80X304I9P.Ti9FJqkSK6J');

                    value31 = datavalue(res5, 'Q9NgSZ4rMHW.Ti9FJqkSK6J');

                    value32 = value28+value29+value30+value31;

                    value33 = datavalue(res5, 'HSv23P9Wk78.ck7ltlqiHwT');

                    value34 = datavalue(res5, 'HSv23P9Wk78.QCLBXG46wP9');

                    value35 = datavalue(res5, 'HSv23P9Wk78.n2U4e9CrQlq');

                    value36 = datavalue(res5, 'HSv23P9Wk78.xQK2Loj37St');

                    value37 = datavalue(res5, 'HSv23P9Wk78.OMkeZeG0WPD');

                    value38 = datavalue(res5, 'HSv23P9Wk78.hcFwQVwvoAA');

                    value39 = value33+value34+value35+value36+value37+value38;

                    value40 = datavalue(res5, 'BYEV1H8wLVr.D6cXMENcvrT');

                    value41 = datavalue(res5, 'BYEV1H8wLVr.yIK12v4JA2K');

                    value42 = datavalue(res5, 'BYEV1H8wLVr.fiNwN76mmpC');

                    value43 = datavalue(res5, 'BYEV1H8wLVr.I32eatdUcEC');

                    value44 = datavalue(res5, 'BYEV1H8wLVr.U2OLqJawQqA');

                    value45 = datavalue(res5, 'BYEV1H8wLVr.v4Nznfpii9M');

                    value46 = value40+value41+value42+value43+value44+value45;




        var tabledata = '<tr>';

                tabledata += ("<td>" + count + "</td><td>" + orgUnit.name + "</td><td>" + ouidName + "</td><td>" + value1+ "</td><td>" + value2+ "</td><td>" + value3+ "</td><td>" + value4+ "</td><td>" + value5+ "</td><td>" + value6+ "</td><td>" + value7+ "</td><td>" + value8+ "</td><td>" + value9+ "</td><td>" + value10+ "</td><td>" + value11+ "</td><td>" + value12+ "</td><td>" + value13+ "</td><td>" + value14+ "</td><td>" + value15+ "</td><td>" + value16+ "</td><td>" + value17+ "</td><td>" + value18+ "</td><td>" + value19+ "</td><td>" + value20+ "</td><td>" + value21+ "</td><td>" + value22+ "</td><td>" + value23+ "</td><td>" + value24+ "</td><td>" + value25+ "</td><td>" + value26+ "</td><td>" + value27+ "</td><td>"+ "</td><td>" + value28+ "</td><td>" + value29+ "</td><td>" + value30+ "</td><td>" + value31+ "</td><td>" + value32+ "</td><td>" + value33+ "</td><td>" + value34+ "</td><td>" + value35+ "</td><td>" + value36 + "</td><td>" + value37+ "</td><td>" + value38+ "</td><td>" + value39+ "</td><td>" + value40+ "</td><td>" + value41+ "</td><td>" + value42+ "</td><td>" + value43+ "</td><td>" + value44+ "</td><td>" + value45+ "</td><td>" + value46);
                        


        tabledata += "</tr>";
        document.getElementById("dataTable").innerHTML += tabledata;
        document.getElementById("loader").style.display = "none";
        document.getElementById("printing").style.display = "block";

        sum1+=value1;
        sum2+=value2;
        sum3+=value3;
        sum4+=value4;
        sum5+=value5;
        sum6+=value6;
        sum7+=value7;
        sum8+=value8;
        sum9+=value9;
        sum10+=value10;
        sum11+=value11;
        sum12+=value12;
        sum13+=value13;
        sum14+=value14;
        sum15+=value15;
        sum16+=value16;
        sum17+=value17;
        sum18+=value18;
        sum19+=value19;
        sum20+=value20;
        sum21+=value21;
        sum22+=value22;
        sum23+=value23;
        sum24+=value24;
        sum25+=value25;
        sum26+=value26;
        sum27+=value27;
        sum28+=value28;
        sum29+=value29;
        sum30+=value30;
        sum31+=value31;
        sum32+=value32;
        sum33+=value33;
        sum34+=value34;
        sum35+=value35;
        sum36+=value36;
        sum37+=value37;
        sum38+=value38;
        sum39+=value39;
        sum40+=value40;
        sum41+=value41;
        sum42+=value42;
        sum43+=value43;
        sum44+=value44;
        sum45+=value45;
        sum46+=value46;
    }



    else if (count == 0) {

        var tabledata = '<tr style = "background:#ADD8E6">';

     
                tabledata += ("<td colspan='3'>Total</td><td>"+sum1+ "</td><td>" + sum2+ "</td><td>" + sum3+ "</td><td>" + sum4+ "</td><td>" + sum5+ "</td><td>" + sum6+ "</td><td>" + sum7+ "</td><td>" + sum8+ "</td><td>" + sum9+ "</td><td>" + sum10+ "</td><td>" + sum11+ "</td><td>" + sum12+ "</td><td>" + sum13+ "</td><td>" + sum14+ "</td><td>" + sum15+ "</td><td>" + sum16+ "</td><td>" + sum17+ "</td><td>" + sum18+ "</td><td>" + sum19+ "</td><td>" + sum20+ "</td><td>" + sum21+ "</td><td>" + sum22+ "</td><td>" + sum23+ "</td><td>" + sum24+ "</td><td>" + sum25+ "</td><td>" + sum26+ "</td><td>" + sum27+ "</td><td>"+ "</td><td>" + sum28+ "</td><td>" + sum29+ "</td><td>" + sum30+ "</td><td>" + sum31+ "</td><td>" + sum32+ "</td><td>" + sum33+ "</td><td>" + sum34+ "</td><td>" + sum35+ "</td><td>" + sum36 + "</td><td>" + sum37+ "</td><td>" + sum38+ "</td><td>" + sum39+ "</td><td>" + sum40+ "</td><td>" + sum41+ "</td><td>" + sum42+ "</td><td>" + sum43+ "</td><td>" + sum44+ "</td><td>" + sum45+ "</td><td>" + sum46);
                
        document.getElementById("dataTable").innerHTML += tabledata;

        msum1+=sum1;
        msum2+=sum2;
        msum3+=sum3;
        msum4+=sum4;
        msum5+=sum5;
        msum6+=sum6;
        msum7+=sum7;
        msum8+=sum8;
        msum9+=sum9;
        msum10+=sum10;
        msum11+=sum11;
        msum12+=sum12;
        msum13+=sum13;
        msum14+=sum14;
        msum15+=sum15;
        msum16+=sum16;
        msum17+=sum17;
        msum18+=sum18;
        msum19+=sum19;
        msum20+=sum20;
        msum21+=sum21;
        msum22+=sum22;
        msum23+=sum23;
        msum24+=sum24;
        msum25+=sum25;
        msum26+=sum26;
        msum27+=sum27;
        msum28+=sum28;
        msum29+=sum29;
        msum30+=sum30;
        msum31+=sum31;
        msum32+=sum32;
        msum33+=sum33;
        msum34+=sum34;
        msum35+=sum35;
        msum36+=sum36;
        msum37+=sum37;
        msum38+=sum38;
        msum39+=sum39;
        msum40+=sum40;
        msum41+=sum41;
        msum42+=sum42;
        msum43+=sum43;
        msum44+=sum44;
        msum45+=sum45;
        msum46+=sum46;



        // Variable for total
        sum1=0;
        sum2=0;
        sum3=0;
        sum4=0;
        sum5=0;
        sum6=0;
        sum7=0;
        sum8=0;
        sum9=0;
        sum10=0;
        sum11=0;
        sum12=0;
        sum13=0;
        sum14=0;
        sum15=0;
        sum16=0;
        sum17=0;
        sum18=0;
        sum19=0;
        sum20=0;
        sum21=0;
        sum22=0;
        sum23=0;
        sum24=0;
        sum25=0;
        sum26=0;
        sum27=0;
        sum28=0;
        sum29=0;
        sum30=0;
        sum31=0;
        sum32=0;
        sum33=0;
        sum34=0;
        sum35=0;
        sum36=0;
        sum37=0;
        sum38=0;
        sum39=0;
        sum40=0;
        sum41=0;
        sum42=0;
        sum43=0;
        sum44=0;
        sum45=0;
        sum46=0;
     

    }

    if (count1 == 00) {
       
       var tabledata = '<tr style = "background:#ADD8E6">';
        tabledata += ("<td colspan='3'>Grand Total</td><td>"+msum1+ "</td><td>" + msum2+ "</td><td>" + msum3+ "</td><td>" + msum4+ "</td><td>" + msum5+ "</td><td>" + msum6+ "</td><td>" + msum7+ "</td><td>" + msum8+ "</td><td>" + msum9+ "</td><td>" + msum10+ "</td><td>" + msum11+ "</td><td>" + msum12+ "</td><td>" + msum13+ "</td><td>" + msum14+ "</td><td>" + msum15+ "</td><td>" + msum16+ "</td><td>" + msum17+ "</td><td>" + msum18+ "</td><td>" + msum19+ "</td><td>" + msum20+ "</td><td>" + msum21+ "</td><td>" + msum22+ "</td><td>" + msum23+ "</td><td>" + msum24+ "</td><td>" + msum25+ "</td><td>" + msum26+ "</td><td>" + msum27+ "</td><td>"+ "</td><td>" + msum28+ "</td><td>" + msum29+ "</td><td>" + msum30+ "</td><td>" + msum31+ "</td><td>" + msum32+ "</td><td>" + msum33+ "</td><td>" + msum34+ "</td><td>" + msum35+ "</td><td>" + msum36 + "</td><td>" + msum37+ "</td><td>" + msum38+ "</td><td>" + msum39+ "</td><td>" + msum40+ "</td><td>" + msum41+ "</td><td>" + msum42+ "</td><td>" + msum43+ "</td><td>" + msum44+ "</td><td>" + msum45+ "</td><td>" + msum46);

        document.getElementById("dataTable").innerHTML += tabledata;

    }


}



function datavalue(dataJSON, id, id1) {
    var value1 = 0;
    for (var i = 0; i < dataJSON.rows.length; i++) {
        if (dataJSON.rows[i][0] == id) {
            value1 = parseInt(dataJSON.rows[i][2]);
        }
    }
    return (value1);
}


function datavalue1(dataJSON, id, id1) {
    var value1 = 'No';
    for (var i = 0; i < dataJSON.rows.length; i++) {
        if (dataJSON.rows[i][0] == id) {
            value1 = 'Yes';
        }
    }
    return (value1);
}



function arraySorting(a, b) {
    return ((a[1] < b[1]) ? -1 : ((a[1] > b[1]) ? 1 : 0));
}

function getPeriod(pr) {
    var year = pr.substring(0, 4);
    var month = pr.substring(4, 6);
    var strMonth = "";

    if (month == "01" || month == "1") strMonth = "January";
    else if (month == "02" || month == "2") strMonth = "February";
    else if (month == "03" || month == "3") strMonth = "March";
    else if (month == "04" || month == "4") strMonth = "April";
    else if (month == "05" || month == "5") strMonth = "May";
    else if (month == "06" || month == "6") strMonth = "June";
    else if (month == "07" || month == "7") strMonth = "July";
    else if (month == "08" || month == "8") strMonth = "August";
    else if (month == "09" || month == "9") strMonth = "September";
    else if (month == "10") strMonth = "October";
    else if (month == "11") strMonth = "November";
    else if (month == "12") strMonth = "December";

    return strMonth + " " + year;
}

function getPeriods() {
    var periodArray = [];
    var year = parseInt(gotPeriod.substring(0, 4));
    var mnth = parseInt(gotPeriod.substring(4, 6));

    if (mnth > 3) {
        for (var i = 4; i <= mnth; i++) {
            if (i < 10) {
                periodArray.push(year.toString() + "0" + i + ";");
            }
            else {
                periodArray.push(year.toString() + i + ";");
            }
        }
    }

    if (mnth <= 3) {
        for (var i = 4; i <= 12; i++) {
            if (i < 10) {
                periodArray.push((year - 1).toString() + "0" + i + ";");
            }
            else {
                periodArray.push((year - 1).toString() + i + ";");
            }
        }

        for (var i = 1; i <= mnth; i++) {
            if (i < 10) {
                periodArray.push(year.toString() + "0" + i + ";");
            }
            else {
                periodArray.push(year.toString() + i + ";");
            }
        }

    }
    return periodArray;
}

var tableToExcel = (function () {
    var uri = 'data:application/vnd.ms-excel;base64,'
        , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
        , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
        , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
    return function (table, name, filename) {
        if (!table.nodeType) table = document.getElementById(table)
        var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }

        document.getElementById("dlink").href = uri + base64(format(template, ctx));
        document.getElementById("dlink").download = filename;
        document.getElementById("dlink").click();

    }
})()

</script>