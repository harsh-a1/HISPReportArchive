<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ"
    crossorigin="anonymous">

<style>
    thead>tr>td {
    font-weight: bold;
}
tbody>tr>td {
    font-weight: bold;
}

/* Center the loader  */

#loader {
    position: absolute;
    left: 50%;
    top: 50%;
    z-index: 1;
    width: 150px;
    height: 150px;
    margin: -75px 0 0 -75px;
    border: 16px solid #f3f3f3;
    border-radius: 50%;
    border-top: 16px solid #34B4DB;
    width: 120px;
    height: 120px;
    -webkit-animation: spin 2s linear infinite;
    animation: spin 2s linear infinite;
}

@-webkit-keyframes spin {
    0% {
        -webkit-transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(360deg);
    }
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}
/* Add animation to "page content" */

.animate-bottom {
    position: relative;
    -webkit-animation-name: animatebottom;
    -webkit-animation-duration: 1s;
    animation-name: animatebottom;
    animation-duration: 1s
}

@-webkit-keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0px;
        opacity: 1
    }
}

@keyframes animatebottom {
    from {
        bottom: -100px;
        opacity: 0
    }
    to {
        bottom: 0;
        opacity: 1
    }
}

#printing {
    display: none;
    text-align: center;
}

</style>

<a id="dlink" style="display:none;"></a>
<button type="button" class="btn btn-primary btn-sm" style="vertical-align: middle;" onclick="printContent('printing')"><span
        class="glyphicon glyphicon-print" style="font-size: 15px;"></span> &nbsp; Print
</button>

<button type="button" class="btn btn-success btn-sm" style="vertical-align: middle;" id="btnExport" onclick="tableToExcel('dataTable', 'Global Health Observatory', 'Global Health Observatory.xls')"><span
        class="glyphicon glyphicon-download-alt" style="font-size: 15px;"></span>Download As Excel</button>
<br><br>
<div id="loader"></div>
<div id="printing" class="animate-bottom">
    <div id='state'>
        <table id="dataTable" border="1" class="table  table-hover text-center" cellspacing="6" cellpadding="4" style="border-collapse: collapse; text-align: center">
            <thead>
                <tr style=" font-weight:400; text-align:center;">
                    <td rowspan="3" colspan="2" style="border:1px solid black;background:#ADD8E6;">Region and country</td>
                    <td id="text1" style="border:1px solid black;background:#ADD8E6; ">Global Health Observatory</td>
                </tr>
                <tr style=" font-weight:400; text-align:center;">
                    <td id="text2" style="border:1px solid black;background:#ADD8E6; ">Reporting Year : - <span id="startPeriod"></span>
                        to <span id="endPeriod"></span></td>
                </tr>
                <tr style=" font-weight:400; text-align:center;">
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 1 [New Cases
                        detected]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 2 [New Case
                        Detection Rate] </td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 3 [Registered
                        Prevalence cases]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 4 [Registered
                        Prevalence Rate]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 5 [New G2D cases]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 6 [Percentage of
                        New G2D cases]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 7 [New G2D Case
                        Rate]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 8 [New Child G2D
                        Cases]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 9 [New Child
                        Cases]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 10 [Percentage of
                        New Child Cases]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 11 [New Female
                        Cases]</td>
                    <td class="diffCol" style="border:1px solid black;background:#ADD8E6;">Indicator 12 [Percentage of
                        New Female
                        Cases]</td>
                </tr>
            </thead>
        </table>
    </div>
</div>


<!-- printing script -->
<script type="text/javascript">
    function printContent(el) {
        var restorepage = document.body.innerHTML;
        var printcontent = document.getElementById(el).innerHTML;
        document.body.innerHTML = printcontent;
        window.print();
        document.body.innerHTML = restorepage;
    }

</script>

<!-- Main Script -->

<script type="text/javascript">
    $(document).ready(function () {
        var startDate = 2012;
        var d = new Date();
        // var endDate = d.getFullYear()-1;
        var endDate = 2017;
        var dateDifference = endDate - startDate;
        document.getElementById('startPeriod').innerHTML = startDate;
        document.getElementById('endPeriod').innerHTML = endDate;
        document.getElementById('text1').colSpan = (12 * (dateDifference + 1));
        document.getElementById('text2').colSpan = (12 * (dateDifference + 1));
        var result = [];

        for (var i = startDate; i <= endDate; i++) {
            result.push(i);
        }
        var date = ("" + result.join(";") + "");

        var periodsRow = '';

        periodsRow = '<tr><td style="border:1px solid black;background:#ADD8E6;">Name</td>\
                    <td style="border:1px solid black;background:#ADD8E6;">Code</td>';
        for (var j = 0; j < 12; j++) {
            for (var i = startDate; i <= endDate; i++) {
                periodsRow += ('<td align="left" style="border:1px solid black; background-color:#DCDCDC">' + i + "</td>");
            }
        }
        periodsRow += "</tr>";
        document.getElementById("dataTable").innerHTML += periodsRow;

        var x = document.getElementById("dataTable").getElementsByClassName("diffCol");

        for (var i = 0; i < x.length; i++) {
            x[i].colSpan = dateDifference + 1;
        }

        function arraySorting(a, b) {
            return ((a.name < b.name) ? -1 : ((a.name > b.name) ? 1 : 0));
        }

        var allOrgUnits;
        var level2OrgUnitsList = [];
        var level3OrgUnitsList = [];
        var firstOrgUnitUid = "x3i5oi4axNu";
        var tabledatalevel2Orgs = '';
        var tabledata = '';
        var ouidName = '';
        var ouidCode = '';
        var population = [];

        var value1_2012;
        var value1_2013;
        var value1_2014;
        var value1_2015;
        var value1_2016;
        var value1_2017;

        var value2_2012;
        var value2_2013;
        var value2_2014;
        var value2_2015;
        var value2_2016;
        var value2_2017;

        var value3_2012;
        var value3_2013;
        var value3_2014;
        var value3_2015;
        var value3_2016;
        var value3_2017;

        var value4_2012;
        var value4_2013;
        var value4_2014;
        var value4_2015;
        var value4_2016;
        var value4_2017;

        var value5_2012;
        var value5_2013;
        var value5_2014;
        var value5_2015;
        var value5_2016;
        var value5_2017;

        var value6_2012;
        var value6_2013;
        var value6_2014;
        var value6_2015;
        var value6_2016;
        var value6_2017;

        var value7_2012;
        var value7_2013;
        var value7_2014;
        var value7_2015;
        var value7_2016;
        var value7_2017;

        var value8_2012;
        var value8_2013;
        var value8_2014;
        var value8_2015;
        var value8_2016;
        var value8_2017;

        var value9_2012;
        var value9_2013;
        var value9_2014;
        var value9_2015;
        var value9_2016;
        var value9_2017;

        var value10_2012;
        var value10_2013;
        var value10_2014;
        var value10_2015;
        var value10_2016;
        var value10_2017;

        var value11_2012;
        var value11_2013;
        var value11_2014;
        var value11_2015;
        var value11_2016;
        var value11_2017;

        var value12_2012;
        var value12_2013;
        var value12_2014;
        var value12_2015;
        var value12_2016;
        var value12_2017;

        $.ajax(
            {
                type: "GET",
                async: false,
                url: "../api/organisationUnits/" + firstOrgUnitUid + ".json?fields=id,name,children[id,name]&paging=false",
                data: JSON,
                success: function (data, status) {
                    allOrgUnits = data;
                    for (var i = 0; i < allOrgUnits.children.length; i++) {
                        level2OrgUnitsList.push({ "id": allOrgUnits.children[i].id, "name": allOrgUnits.children[i].name });
                    }
                }
            });

        level2OrgUnitsList.sort(arraySorting);

        for (var j = 0; j < level2OrgUnitsList.length; j++) {
            tabledatalevel2Orgs = '<tr>';
            tabledatalevel2Orgs += ('<td colspan="' + ((12 * (dateDifference + 1)) + 2) + '" align="left" style="border:1px solid black; background-color:#DCDCDC">' + level2OrgUnitsList[j].name + "</td>");
            tabledatalevel2Orgs += "</tr>";
            document.getElementById("dataTable").innerHTML += tabledatalevel2Orgs;

            var level3OrgUnitsList = [];
            $.ajax({
                type: "GET",
                async: false,
                url: "../api/organisationUnits/" + level2OrgUnitsList[j].id + ".json?fields=id,name,children[id,name,code]&paging=false",
                data: JSON,
                success: function (data, status) {
                    for (var i = 0; i < data.children.length; i++) {
                        level3OrgUnitsList.push({ "id": data.children[i].id, "name": data.children[i].name, "code": data.children[i].code });
                    }
                    level3OrgUnitsList.sort(arraySorting);
                    getAllValues(level3OrgUnitsList);
                }
            });
        }

        function getAllValues(orgUnits) {
            var count = 0;
            for (var k = 0; k < orgUnits.length; k++) {
                ouidName = orgUnits[k].name;
                ouidCode = orgUnits[k].code;
                if (ouidCode == undefined) {
                    ouidCode = '';
                }

                $.ajax({
                    type: "GET",
                    async: false,
                    url: "../api/26/analytics.json?dimension=dx:d1d6EWQZJGB;liZaznYiWwp;aDsoJJ4En5m;LL3PpzJHqJZ;vw7AXy6SjdD;tzGljEoaVdT;pzEoCgYnvSz;CcGd2V8uc9T;uiiSia2NAnz;TBTHguhWty1;Js8yBC2S7SG;mNPlDlzmwru;PedwH0Dby8M;evXyDr6c7eu;gVmFx873rdZ;IQgrP2W9gTV;ElAjdwOrjMq;bLR7YvL1f5O;mdupOTsRJ58;lzbsUQJvvJB;sAXV6Hnve4i;xl4EXfRMBrK.Te9RyzefSAz;xl4EXfRMBrK.ZZFiCRpT37i;xl4EXfRMBrK.sdMU6tpPki6;j62SFyBOrSN;v1Fr4On014j;MiHLzmsVFPf;ubgNtdy3h9H;tyHgOKrZsMJ;C6xcdI95huJ;xdbnQxRVTBq;KrvcvcTLqIh;EnQPW5xZDPX;FSkYfwz16Be;scAXqcidvNn&dimension=pe:" + date + "&dimension=ou:" + orgUnits[k].id + "&displayProperty=NAME&user=fHBBxgutDDB",
                    data: JSON,
                    success: function (res4, status) {
                        count++;
                        finalvalue(res4, ouidName, ouidCode, count);
                    }
                });
            }
        }

        function finalvalue(res4, ouidName, ouidCode, count) {

            value1_2012 = isNaN(parseInt(datavalue(res4, 'liZaznYiWwp', 2012))) ? '' : parseInt(datavalue(res4, 'liZaznYiWwp', 2012));
            value1_2013 = isNaN(parseInt(datavalue(res4, 'liZaznYiWwp', 2013))) ? '' : parseInt(datavalue(res4, 'liZaznYiWwp', 2013));
            value1_2014 = isNaN(parseInt(datavalue(res4, 'liZaznYiWwp', 2014))) ? '' : parseInt(datavalue(res4, 'liZaznYiWwp', 2014));
            value1_2015 = isNaN(parseInt(datavalue(res4, 'liZaznYiWwp', 2015))) ? '' : parseInt(datavalue(res4, 'liZaznYiWwp', 2015));
            value1_2016 = isNaN(parseInt(datavalue(res4, 'liZaznYiWwp', 2016))) ? '' : parseInt(datavalue(res4, 'liZaznYiWwp', 2016));

            var val1 = isNaN(parseInt(datavalue(res4, 'evXyDr6c7eu', 2017))) ? '' : parseInt(datavalue(res4, 'evXyDr6c7eu', 2017));
            var val2 = isNaN(parseInt(datavalue(res4, 'gVmFx873rdZ', 2017))) ? '' : parseInt(datavalue(res4, 'gVmFx873rdZ', 2017));
            var val3 = isNaN(parseInt(datavalue(res4, 'IQgrP2W9gTV', 2017))) ? '' : parseInt(datavalue(res4, 'IQgrP2W9gTV', 2017));

            if (ouidName == 'Burundi' || ouidName == 'Cape Verde' || ouidName == 'Chad' || ouidName == 'Cote d\'Ivoire' || ouidName == 'Guinea' || ouidName == 'Namibia' || ouidName == 'France' || ouidName == 'Bolivia (Plurinational State of)' || ouidName == 'Chile' || ouidName == 'Dominican Republic' || ouidName == 'Guyana' || ouidName == 'Honduras' || ouidName == 'Suriname' || ouidName == 'Trinidad and Tobago' || ouidName == 'United States of America' || ouidName == 'Uruguay') {
                value1_2017 = isNaN(parseInt(datavalue(res4, 'FSkYfwz16Be', 2017))) ? '' : parseInt(datavalue(res4, 'FSkYfwz16Be', 2017));
            } else {
                value1_2017 = valueCheck(val1, val2, val3);
            }

            if (typeof (value1_2012) == 'number') {
                value2_2012 = datavalue(res4, 'aDsoJJ4En5m', 2012);
            }
            else {
                value2_2012 = '';
            }
            if (typeof (value1_2013) == 'number') {
                value2_2013 = datavalue(res4, 'aDsoJJ4En5m', 2013);
            }
            else {
                value2_2013 = '';
            }
            if (typeof (value1_2014) == 'number') {
                value2_2014 = datavalue(res4, 'aDsoJJ4En5m', 2014);
            }
            else {
                value2_2014 = '';
            }
            if (typeof (value1_2015) == 'number') {
                value2_2015 = datavalue(res4, 'aDsoJJ4En5m', 2015);
            }
            else {
                value2_2015 = '';
            }
            if (typeof (value1_2016) == 'number') {
                value2_2016 = datavalue(res4, 'aDsoJJ4En5m', 2016);
            }
            else {
                value2_2016 = '';
            }
            if (typeof (value1_2017) == 'number') {
                value2_2017 = datavalue(res4, 'ElAjdwOrjMq', 2017);
            }
            else {
                value2_2017 = '';
            }

            value3_2012 = isNaN(parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2012))) ? '' : parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2012));
            value3_2013 = isNaN(parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2013))) ? '' : parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2013));
            value3_2014 = isNaN(parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2014))) ? '' : parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2014));
            value3_2015 = isNaN(parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2015))) ? '' : parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2015));
            value3_2016 = isNaN(parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2016))) ? '' : parseInt(datavalue(res4, 'LL3PpzJHqJZ', 2016));

            var val5 = isNaN(parseInt(datavalue(res4, 'bLR7YvL1f5O', 2017))) ? '' : parseInt(datavalue(res4, 'bLR7YvL1f5O', 2017));
            var val6 = isNaN(parseInt(datavalue(res4, 'mdupOTsRJ58', 2017))) ? '' : parseInt(datavalue(res4, 'mdupOTsRJ58', 2017));
            var val7 = isNaN(parseInt(datavalue(res4, 'lzbsUQJvvJB', 2017))) ? '' : parseInt(datavalue(res4, 'lzbsUQJvvJB', 2017));

            value3_2017 = valueCheck(val5, val6, val7);

            if (typeof (value3_2012) == 'number') {
                value4_2012 = datavalue(res4, 'vw7AXy6SjdD', 2012);
            }
            else {
                value4_2012 = '';
            }
            if (typeof (value3_2013) == 'number') {
                value4_2013 = datavalue(res4, 'vw7AXy6SjdD', 2013);
            }
            else {
                value4_2013 = '';
            }
            if (typeof (value3_2014) == 'number') {
                value4_2014 = datavalue(res4, 'vw7AXy6SjdD', 2014);
            }
            else {
                value4_2014 = '';
            }
            if (typeof (value3_2015) == 'number') {
                value4_2015 = datavalue(res4, 'vw7AXy6SjdD', 2015);
            }
            else {
                value4_2015 = '';
            }
            if (typeof (value3_2016) == 'number') {
                value4_2016 = datavalue(res4, 'vw7AXy6SjdD', 2016);
            }
            else {
                value4_2016 = '';
            }
            if (typeof (value3_2017) == 'number') {
                value4_2017 = datavalue(res4, 'sAXV6Hnve4i', 2017);
            }
            else {
                value4_2017 = '';
            }

            value5_2012 = isNaN(parseInt(datavalue(res4, 'tzGljEoaVdT', 2012))) ? '' : parseInt(datavalue(res4, 'tzGljEoaVdT', 2012));
            value5_2013 = isNaN(parseInt(datavalue(res4, 'tzGljEoaVdT', 2013))) ? '' : parseInt(datavalue(res4, 'tzGljEoaVdT', 2013));
            value5_2014 = isNaN(parseInt(datavalue(res4, 'tzGljEoaVdT', 2014))) ? '' : parseInt(datavalue(res4, 'tzGljEoaVdT', 2014));
            value5_2015 = isNaN(parseInt(datavalue(res4, 'tzGljEoaVdT', 2015))) ? '' : parseInt(datavalue(res4, 'tzGljEoaVdT', 2015));
            value5_2016 = isNaN(parseInt(datavalue(res4, 'tzGljEoaVdT', 2016))) ? '' : parseInt(datavalue(res4, 'tzGljEoaVdT', 2016));

            var val9 = isNaN(parseInt(datavalue(res4, 'xl4EXfRMBrK.Te9RyzefSAz', 2017))) ? '' : parseInt(datavalue(res4, 'xl4EXfRMBrK.Te9RyzefSAz', 2017));
            var val10 = isNaN(parseInt(datavalue(res4, 'xl4EXfRMBrK.ZZFiCRpT37i', 2017))) ? '' : parseInt(datavalue(res4, 'xl4EXfRMBrK.ZZFiCRpT37i', 2017));
            var val11 = isNaN(parseInt(datavalue(res4, 'xl4EXfRMBrK.sdMU6tpPki6', 2017))) ? '' : parseInt(datavalue(res4, 'xl4EXfRMBrK.sdMU6tpPki6', 2017));

            value5_2017 = valueCheck(val9, val10, val11);

            if (typeof (value5_2012) == 'number') {
                value6_2012 = datavalue(res4, 'pzEoCgYnvSz', 2012);
                if (!value6_2012) {
                    value6_2012 = '0.00';
                }
            }
            else {
                value6_2012 = '';
            }
            if (typeof (value5_2013) == 'number') {
                value6_2013 = datavalue(res4, 'pzEoCgYnvSz', 2013);
                if (!value6_2013) {
                    value6_2013 = '0.00';
                }
            }
            else {
                value6_2013 = '';
            }
            if (typeof (value5_2014) == 'number') {
                value6_2014 = datavalue(res4, 'pzEoCgYnvSz', 2014);
                if (!value6_2014) {
                    value6_2014 = '0.00';
                }
            }
            else {
                value6_2014 = '';
            }
            if (typeof (value5_2015) == 'number') {
                value6_2015 = datavalue(res4, 'pzEoCgYnvSz', 2015);
                if (!value6_2015) {
                    value6_2015 = '0.00';
                }
            }
            else {
                value6_2015 = '';
            }
            if (typeof (value5_2016) == 'number') {
                value6_2016 = datavalue(res4, 'pzEoCgYnvSz', 2016);
                if (!value6_2016) {
                    value6_2016 = '0.00';
                }
            }
            else {
                value6_2016 = '';
            }
            if (typeof (value5_2017) == 'number') {
                value6_2017 = datavalue(res4, 'j62SFyBOrSN', 2017);
                if (!value6_2017) {
                    value6_2017 = '0.00';
                }
            }
            else {
                value6_2017 = '';
            }



            if (typeof (value5_2012) == 'number') {
                value7_2012 = datavalue(res4, 'CcGd2V8uc9T', 2012);
            }
            else {
                value7_2012 = '';
            }
            if (typeof (value5_2013) == 'number') {
                value7_2013 = datavalue(res4, 'CcGd2V8uc9T', 2013);
            }
            else {
                value7_2013 = '';
            }
            if (typeof (value5_2014) == 'number') {
                value7_2014 = datavalue(res4, 'CcGd2V8uc9T', 2014);
            }
            else {
                value7_2014 = '';
            }
            if (typeof (value5_2015) == 'number') {
                value7_2015 = datavalue(res4, 'CcGd2V8uc9T', 2015);
            }
            else {
                value7_2015 = '';
            }
            if (typeof (value5_2016) == 'number') {
                value7_2016 = datavalue(res4, 'CcGd2V8uc9T', 2016);
            }
            else {
                value7_2016 = '';
            }
            if (typeof (value5_2017) == 'number') {
                value7_2017 = datavalue(res4, 'v1Fr4On014j', 2017);
            }
            else {
                value7_2017 = '';
            }

            value8_2012 = isNaN(parseInt(datavalue(res4, 'uiiSia2NAnz', 2012))) ? '' : parseInt(datavalue(res4, 'uiiSia2NAnz', 2012));
            value8_2013 = isNaN(parseInt(datavalue(res4, 'uiiSia2NAnz', 2013))) ? '' : parseInt(datavalue(res4, 'uiiSia2NAnz', 2013));
            value8_2014 = isNaN(parseInt(datavalue(res4, 'uiiSia2NAnz', 2014))) ? '' : parseInt(datavalue(res4, 'uiiSia2NAnz', 2014));
            value8_2015 = isNaN(parseInt(datavalue(res4, 'uiiSia2NAnz', 2015))) ? '' : parseInt(datavalue(res4, 'uiiSia2NAnz', 2015));
            value8_2016 = isNaN(parseInt(datavalue(res4, 'uiiSia2NAnz', 2016))) ? '' : parseInt(datavalue(res4, 'uiiSia2NAnz', 2016));
            value8_2017 = isNaN(parseInt(datavalue(res4, 'xl4EXfRMBrK.ZZFiCRpT37i', 2017))) ? '' : parseInt(datavalue(res4, 'xl4EXfRMBrK.ZZFiCRpT37i', 2017));

            value9_2012 = isNaN(parseInt(datavalue(res4, 'TBTHguhWty1', 2012))) ? '' : parseInt(datavalue(res4, 'TBTHguhWty1', 2012));
            value9_2013 = isNaN(parseInt(datavalue(res4, 'TBTHguhWty1', 2013))) ? '' : parseInt(datavalue(res4, 'TBTHguhWty1', 2013));
            value9_2014 = isNaN(parseInt(datavalue(res4, 'TBTHguhWty1', 2014))) ? '' : parseInt(datavalue(res4, 'TBTHguhWty1', 2014));
            value9_2015 = isNaN(parseInt(datavalue(res4, 'TBTHguhWty1', 2015))) ? '' : parseInt(datavalue(res4, 'TBTHguhWty1', 2015));
            value9_2016 = isNaN(parseInt(datavalue(res4, 'TBTHguhWty1', 2016))) ? '' : parseInt(datavalue(res4, 'TBTHguhWty1', 2016));

            var val14 = isNaN(parseInt(datavalue(res4, 'MiHLzmsVFPf', 2017))) ? '' : parseInt(datavalue(res4, 'MiHLzmsVFPf', 2017));
            var val15 = isNaN(parseInt(datavalue(res4, 'ubgNtdy3h9H', 2017))) ? '' : parseInt(datavalue(res4, 'ubgNtdy3h9H', 2017));
            var val16 = isNaN(parseInt(datavalue(res4, 'tyHgOKrZsMJ', 2017))) ? '' : parseInt(datavalue(res4, 'tyHgOKrZsMJ', 2017));

            if (ouidName == 'Burundi' || ouidName == 'Cape Verde' || ouidName == 'Chad' || ouidName == 'Cote d\'Ivoire' || ouidName == 'Guinea' || ouidName == 'Namibia' || ouidName == 'France' || ouidName == 'Bolivia (Plurinational State of)' || ouidName == 'Chile' || ouidName == 'Dominican Republic' || ouidName == 'Guyana' || ouidName == 'Honduras' || ouidName == 'Suriname' || ouidName == 'Trinidad and Tobago' || ouidName == 'United States of America' || ouidName == 'Uruguay') {
                value9_2017 = isNaN(parseInt(datavalue(res4, 'EnQPW5xZDPX', 2017))) ? '' : parseInt(datavalue(res4, 'EnQPW5xZDPX', 2017));
            } else {
                value9_2017 = valueCheck(val14, val15, val16);
            }

            if (typeof (value9_2012) == 'number') {
                value10_2012 = datavalue(res4, 'Js8yBC2S7SG', 2012);
                if (!value10_2012) {
                    value10_2012 = '0.00';
                }
            }
            else {
                value10_2012 = '';
            }
            if (typeof (value9_2013) == 'number') {
                value10_2013 = datavalue(res4, 'Js8yBC2S7SG', 2013);
                if (!value10_2013) {
                    value10_2013 = '0.00';
                }
            }
            else {
                value10_2013 = '';
            }
            if (typeof (value9_2014) == 'number') {
                value10_2014 = datavalue(res4, 'Js8yBC2S7SG', 2014);
                if (!value10_2014) {
                    value10_2014 = '0.00';
                }
            }
            else {
                value10_2014 = '';
            }
            if (typeof (value9_2015) == 'number') {
                value10_2015 = datavalue(res4, 'Js8yBC2S7SG', 2015);
                if (!value10_2015) {
                    value10_2015 = '0.00';
                }
            }
            else {
                value10_2015 = '';
            }
            if (typeof (value9_2016) == 'number') {
                value10_2016 = datavalue(res4, 'Js8yBC2S7SG', 2016);
                if (!value10_2016) {
                    value10_2016 = '0.00';
                }
            }
            else {
                value10_2016 = '';
            }

            if (ouidName == 'Burundi' || ouidName == 'Cape Verde' || ouidName == 'Chad' || ouidName == 'Cote d\'Ivoire' || ouidName == 'Guinea' || ouidName == 'Namibia' || ouidName == 'France' || ouidName == 'Bolivia (Plurinational State of)' || ouidName == 'Chile' || ouidName == 'Dominican Republic' || ouidName == 'Guyana' || ouidName == 'Honduras' || ouidName == 'Suriname' || ouidName == 'Trinidad and Tobago' || ouidName == 'United States of America' || ouidName == 'Uruguay') {
                value10_2017 = datavalue(res4, 'scAXqcidvNn', 2017);
            }
            else {
                if (typeof (value9_2017) == 'number') {
                    value10_2017 = datavalue(res4, 'C6xcdI95huJ', 2017);
                    if (!value10_2017) {
                        value10_2017 = '0.00';
                    }
                }
                else {
                    value10_2017 = '';
                }
            }

            value11_2012 = isNaN(parseInt(datavalue(res4, 'mNPlDlzmwru', 2012))) ? '' : parseInt(datavalue(res4, 'mNPlDlzmwru', 2012));
            value11_2013 = isNaN(parseInt(datavalue(res4, 'mNPlDlzmwru', 2013))) ? '' : parseInt(datavalue(res4, 'mNPlDlzmwru', 2013));
            value11_2014 = isNaN(parseInt(datavalue(res4, 'mNPlDlzmwru', 2014))) ? '' : parseInt(datavalue(res4, 'mNPlDlzmwru', 2014));
            value11_2015 = isNaN(parseInt(datavalue(res4, 'mNPlDlzmwru', 2015))) ? '' : parseInt(datavalue(res4, 'mNPlDlzmwru', 2015));
            value11_2016 = isNaN(parseInt(datavalue(res4, 'mNPlDlzmwru', 2016))) ? '' : parseInt(datavalue(res4, 'mNPlDlzmwru', 2016));
            value11_2017 = isNaN(parseInt(datavalue(res4, 'xdbnQxRVTBq', 2017))) ? '' : parseInt(datavalue(res4, 'xdbnQxRVTBq', 2017));

            if (typeof (value11_2012) == 'number') {
                value12_2012 = datavalue(res4, 'PedwH0Dby8M', 2012);
                if (!value12_2012) {
                    value12_2012 = '0.00';
                }
            }
            else {
                value12_2012 = '';
            }
            if (typeof (value11_2013) == 'number') {
                value12_2013 = datavalue(res4, 'PedwH0Dby8M', 2013);
                if (!value12_2013) {
                    value12_2013 = '0.00';
                }
            }
            else {
                value12_2013 = '';
            }
            if (typeof (value11_2014) == 'number') {
                value12_2014 = datavalue(res4, 'PedwH0Dby8M', 2014);
                if (!value12_2014) {
                    value12_2014 = '0.00';
                }
            }
            else {
                value12_2014 = '';
            }
            if (typeof (value11_2015) == 'number') {
                value12_2015 = datavalue(res4, 'PedwH0Dby8M', 2015);
                if (!value12_2015) {
                    value12_2015 = '0.00';
                }
            }
            else {
                value12_2015 = '';
            }
            if (typeof (value11_2016) == 'number') {
                value12_2016 = datavalue(res4, 'PedwH0Dby8M', 2016);
                if (!value12_2016) {
                    value12_2016 = '0.00';
                }
            }
            else {
                value12_2016 = '';
            }
            if (typeof (value11_2017) == 'number') {
                value12_2017 = datavalue(res4, 'KrvcvcTLqIh', 2017);
                if (!value12_2017) {
                    value12_2017 = '0.00';
                }
            }
            else {
                value12_2017 = '';
            }

            var tabledata = '<tr>';

            tabledata += '<td style="font:bold;">' + ouidName + '</td><td style="font:bold;">' + ouidCode + '</td><td>' + value1_2012 + '</td><td>' + value1_2013 + '</td><td>' + value1_2014 + '</td><td>' + value1_2015 + '</td><td>' + value1_2016 + '</td><td>' + value1_2017 + '</td><td>' + value2_2012 + '</td><td>' + value2_2013 + '</td><td>' + value2_2014 + '</td><td>' + value2_2015 + '</td><td>' + value2_2016 + '</td><td>' + value2_2017 + '</td><td>' + value3_2012 + '</td><td>' + value3_2013 + '</td><td>' + value3_2014 + '</td><td>' + value3_2015 + '</td><td>' + value3_2016 + '</td><td>' + value3_2017 + '</td><td>' + value4_2012 + '</td><td>' + value4_2013 + '</td><td>' + value4_2014 + '</td><td>' + value4_2015 + '</td><td>' + value4_2016 + '</td><td>' + value4_2017 + '</td><td>' + value5_2012 + '</td><td>' + value5_2013 + '</td><td>' + value5_2014 + '</td><td>' + value5_2015 + '</td><td>' + value5_2016 + '</td><td>' + value5_2017 + '</td><td>' + value6_2012 + '</td><td>' + value6_2013 + '</td><td>' + value6_2014 + '</td><td>' + value6_2015 + '</td><td>' + value6_2016 + '</td><td>' + value6_2017 + '</td><td>' + value7_2012 + '</td><td>' + value7_2013 + '</td><td>' + value7_2014 + '</td><td>' + value7_2015 + '</td><td>' + value7_2016 + '</td><td>' + value7_2017 + '</td><td>' + value8_2012 + '</td><td>' + value8_2013 + '</td><td>' + value8_2014 + '</td><td>' + value8_2015 + '</td><td>' + value8_2016 + '</td><td>' + value8_2017 + '</td><td>' + value9_2012 + '</td><td>' + value9_2013 + '</td><td>' + value9_2014 + '</td><td>' + value9_2015 + '</td><td>' + value9_2016 + '</td><td>' + value9_2017 + '</td><td>' + value10_2012 + '</td><td>' + value10_2013 + '</td><td>' + value10_2014 + '</td><td>' + value10_2015 + '</td><td>' + value10_2016 + '</td><td>' + value10_2017 + '</td><td>' + value11_2012 + '</td><td>' + value11_2013 + '</td><td>' + value11_2014 + '</td><td>' + value11_2015 + '</td><td>' + value11_2016 + '</td><td>' + value11_2017 + '</td><td>' + value12_2012 + '</td><td>' + value12_2013 + '</td><td>' + value12_2014 + '</td><td>' + value12_2015 + '</td><td>' + value12_2016 + '</td><td>' + value12_2017 + '</td>';

            tabledata += '</tr>';
            // }
            document.getElementById("dataTable").innerHTML += tabledata;
            document.getElementById("loader").style.display = "none";
            document.getElementById("printing").style.display = "block";
        };

        function datavalue(dataJSON, id, period) {
            var value1 = '';
            for (var i = 0; i < dataJSON.rows.length; i++) {
                if (dataJSON.rows[i][0] == id && dataJSON.rows[i][1] == period) {
                    value1 = dataJSON.rows[i][3];
                    if (value1.indexOf('e') > 0 || value1.indexOf('E') > 0) {
                        value1 = scientificToDecimal(value1);
                    } else {
                        value1 = parseFloat(value1).toFixed(2);
                    }
                }
            }
            return (value1);
        };
    });

    function valueCheck(...theArgs) {
        console.log(theArgs);
        var sum = 0;
        var value = '';
        for (var x = 0; x < theArgs.length; x++) {
            if (theArgs.every(function (i) { return typeof i === "string" })) {
                value = '';
                return value;
            }
            else {
                sum += isNaN(parseInt(theArgs[x], 10)) ? 0 : parseInt(theArgs[x], 10);
            }
        }
        return sum;
    }

    function scientificToDecimal(num) {
        const sign = Math.sign(num);
        //if the number is in scientific notation remove it
        if (/\d+\.?\d*e[\+\-]*\d+/i.test(num)) {
            const zero = '0';
            const parts = String(num).toLowerCase().split('e'); //split into coeff and exponent
            const e = parts.pop(); //store the exponential part
            let l = Math.abs(e); //get the number of zeros
            const direction = e / l; // use to determine the zeroes on the left or right
            const coeff_array = parts[0].split('.');

            if (direction === -1) {
                coeff_array[0] = Math.abs(coeff_array[0]);
                num = zero + '.' + new Array(l).join(zero) + coeff_array.join('');
            }
            else {
                const dec = coeff_array[1];
                if (dec) l = l - dec.length;
                num = coeff_array.join('') + new Array(l + 1).join(zero);
            }
        }

        if (sign < 0) {
            num = -num;
        }

        return num;
    }

    var tableToExcel = (function () {
        var uri = 'data:application/vnd.ms-excel;base64,'
            , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
            , base64 = function (s) { return window.btoa(unescape(encodeURIComponent(s))) }
            , format = function (s, c) { return s.replace(/{(\w+)}/g, function (m, p) { return c[p]; }) }
        return function (table, name, filename) {
            if (!table.nodeType) table = document.getElementById(table)
            var ctx = { worksheet: name || 'Worksheet', table: table.innerHTML }
            document.getElementById("dlink").href = uri + base64(format(template, ctx));
            document.getElementById("dlink").download = filename;
            document.getElementById("dlink").click();
        }
    })()
</script>