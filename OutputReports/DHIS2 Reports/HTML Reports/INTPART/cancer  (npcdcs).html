<!DOCTYPE html>
<html>
<head>
<style>
td {
	border: 1px solid black;
     padding: 1px;
    text-align: center;
	 
}
#table2 {
	table-layout: fixed;
	 border-collapse: collapse;
	   
}
#table1 {
    table-layout: auto;
	border-collapse: collapse;
	 border-top:none;
}
.less{
    margin:0;
    padding:0;
}

</style>
</head>
<body>

<table id="table1" style="width:90%">
  <tr>  
    <td colspan="14">Form 2</td>
  </tr>
  <tr>
    <td colspan="14">National Programme on Prevention & Control of Cancer, Diabetes, CVDs & Stroke (NPCDCS)</td>
	</tr>
	<tr>
    <td colspan="14">Reporting performa for Primary Health Centre (PHC)</td>
	</tr>
	<tr>
    <td colspan="2">
	PHC
	</td>
	<td>
	PHD-25
	</td>
	<td colspan="2">
	Name of Linked Block PHC/CHC
	</td>
	<td>
	CHC,Sector 22
	</td>
	<td>
	
	</td>
	<td>
	District
	</td>
	<td>
	Chandigarh
	</td>
	<td>
	State
	</td>
	<td colspan="4">
	Chandigarh
	</td>
  </tr>
  <tr>
  <td colspan="2">
  Month
  </td>
  <td>
  June
  </td>
  <td>
  Year
  </td>
  <td>
  2017
  </td>
  <td colspan="9">
  </td> 
  </tr>
  <tr>
  <td colspan="2">
  Centres under the PHCs
  </td>
  <td>
  NA
  </td>
  <td colspan="2" >
  </td>
  <td colspan="4">
  No. of Sub-centres reported during the month
  </td>
<td >
   NA
  </td>
  <td colspan="4">
  </td>
  <tr>
  <td colspan="2">
  Part A (Screening )
  </td>
  <td colspan="12">
  </td>
  </tr>
  
  </table>
  
  <table class="reporttable" id="table2" style="width:90%">
  <tr >
  <td colspan="2" >
  
  </td>
  
  <td colspan="3">
 No. of persons screened for Cancers
  </td>
  
  <td  colspan="6" >
 
No. of persons suspected and refered to PHC/CHC/GH
  
  </td> 
  
 <td  colspan="3" >
 No. of known Cancer patients
 </td >
 
  </tr>
  
  <tr>
  <td colspan="2">
  
  </td>
  <td colspan="3">
  </td>
  <td colspan="3" >
  Oral
  </td>
  <td rowspan="2">
  Breast
  </td>
  <td rowspan="2">
  Cervical
  </td>
  <td rowspan="2">
  Total
  </td>
  <td rowspan="2">
  Male
  </td>
  <td rowspan="2">
  Female
  </td>
  <td rowspan="2">
  Total
  </td>
  </tr>
  <tr>
  
  
  
  <td colspan="2">
  Name of SubCentre/PHC
  </td>
   <td>
  Male
  </td>
  <td>
  Female
  </td>
  <td>
  Total
  </td>
   <td>
  Male
  </td>
  <td>
  Female
  </td>
  <td>
  Total
  </td>
  </tr>
  </table>
  </br>
  </br>
  </br>
  <div>
  <h6> Signature</h6>
  <h6> Name and Designation</h6>
  <h6> Date of reporting</h6>
  <h6 class="less"> * This report should be generated from PHC OPD screening data and also by compiling data of Form 1 of all sub-centres under the PHC</h6>
  <h6 class="less"> This should be verified and signed by Medical Officer I/C PHC</h6>
  <h6 class="less"> The report should be sent to Block PHC/CHC/District NCD Cell by 5th of every month.</h6>
  </div>
  <script type="text/javascript" async>
  var fem=0;
  var mal=0;
  var oldoral=0;
  var neworal=0;
  var newdm=0;
  var dmfem=0;
  var dmmal=0;
  var newhtn=0;
  var htnmal=0;
  var htnfem=0;
  var olddm=0;
   var  oldhtnmal=0;
  var oldhtn=0;
  var olddmfem=0;
  var olddmmal=0;
  var oldhtnfem=0;
  var cervical=0;
  var breastca=0;
  var totcancer=0;
  var lengthentity;
  var obj=[];
  var obj1=[];
  var obj2=[];
  var obj3=[];
  var filtroldhtn=[];
  var filtrnewhtn=[];
  var filtrolddm=[];
  var filternewdm=[];
  var filteroldca=[];
  var filternewca=[];
  var uniquee=[];
  var uniqueee=[];
  var commonValues = [];
  var commonValuess=[];
  $.ajaxSetup({
        async: false
    });
	 var url = "../api/events.json?orgUnit=lZtSBQjZCaX&program=jC8Gprj4pWV&startDate=2017-01-01&endDate=2017-08-30&skipPaging=true";
	
	
	       var url1=  "../api/trackedEntityInstances.json?ou=lZtSBQjZCaX&program=jC8Gprj4pWV&programStartDate=2017-01-01&programEndDate=2017-08-30&skipPaging=true";
			 
			 
			  $.get(url1, function (data1) {
			 
			var trackdata=data1;
                console.log(trackdata);
				
				for(var i=0;i<trackdata.trackedEntityInstances.length;i++)
				{
						 lengthentity=trackdata.trackedEntityInstances.length;
				var attributepath=trackdata.trackedEntityInstances[i].attributes; 
				 for(var q=0;q<attributepath.length;q++)
                    {
				if(attributepath[q].value=="Female")
				{
				fem++;
				}
				else if(attributepath[q].value=="Male")
				{
				mal++;
				}

				 }
			  
			  
				}
				
			console.log("no of female"+fem );
			  console.log("no of male"+mal );
			  return fem;
			  return mal;
			  });
			  // 
			  
			  
            $.get(url, function (data) {
			var eventdata=data;
                console.log(eventdata);
				
				
				
				for(var j=0;j<eventdata.events.length;j++)
				{
				// leng=eventdata.events.length;
				 
			     //  console.log(leng);
				   var dm=eventdata.events[j].dataValues;
				   for(var q=0;q<dm.length;q++)
				   {                                                         // ObkhLek0zZf
				                                                                //C4YdSPG3Mr0     breast ca
				   var id=dm[q].dataElement;
				   // new caseof dm
				   if(id=="pihDaRwwk9q"){ //known case of ca
				   
				   var track= eventdata.events[j].trackedEntityInstance;
				   
				   obj.push(track);
				   var val=dm[q].value;
		           if(val=="true")
		             {
					 filteroldca.push(track);
			           oldoral++;
		             }
					 
				   }
				     else if(id=="ObkhLek0zZf") // oral ca
					 {
					  var trackk= eventdata.events[j].trackedEntityInstance;
				   
				   obj.push(track);
				   var val=dm[q].value;
		           if(val=="true")
		             {
					 filternewca.push(trackk);
			           neworal++;
		             }
				   
                   }                                                // cervical   gpJWjauP93y
                       // breast cancer
					    else if(id=="C4YdSPG3Mr0")
					 {
					  var trackk= eventdata.events[j].trackedEntityInstance;		
				   var val=dm[q].value;
		           if(val=="true")
		             {
			          breastca++;
		             } 
                   }
				        // cervical cancer
    			      else if(id=="gpJWjauP93y")
					 {
					  var trackk= eventdata.events[j].trackedEntityInstance;
				   				 
				   var val=dm[q].value;
		           if(val=="true")
		             {
					
			           cervical++;
		             }
				   
                   }				   
				    }
				//console.log(obj);
				 }
				 totcancer=breastca+cervical;
            });
	
			  
			  
			  
			  //common value of oral and old cancer
				var i, j; 
				var arr1Length = filteroldca.length;
				var arr2Length = filternewca.length;

				for (i = 0; i < arr1Length; i++) {
					for (j = 0; j < arr2Length; j++) {
						if (filteroldca[i] === filternewca[j]) {
							commonValues.push(filteroldca[i]);
						}
					}
				}
				
				// unique value of oral and cancer
				// unique values of htn old and new case
	//---------------------------------------------------
	   
	function uniquenumber(filteroldca,filternewca){
	      var aa=filteroldca.length;
		  var bb= filternewca.length;
		  if(aa>bb)
		  {
		  var onearray=filternewca;
		  var twoarray=filtroldhtn;
		  }
		  else
		  {
		  var onearray=filternewca;
		  var twoarray=filteroldca;
		  }
	var array3 = onearray.filter(function(obj) { return twoarray.indexOf(obj) == -1; });
	  return array3;
	 // console.log(array3);
	};
	//------------------------------------------------
	 uniquee= uniquenumber(filteroldca,filternewca);
							
// male and femal of oral
for(var p=0;p<commonValues.length;p++)
	{
	
	 $.getJSON("../api/trackedEntityInstances/"+commonValues[p]+".json?", function (data99) {
	 
	 for(var i=0;i<data99.attributes.length;i++)
				{
						
				var attrib=data99.attributes[i].value; 
				
				if(attrib=="Female")
				{
				htnfem++;
				}
				else if(attrib=="Male")
				{
				htnmal++;
				}

				 }
	    });
	
	}			
	// male and femal of known cancer
for(var p=0;p<uniquee.length;p++)
	{
	
	 $.getJSON("../api/trackedEntityInstances/"+uniquee[p]+".json?", function (data99) {
	 
	 for(var i=0;i<data99.attributes.length;i++)
				{
						
				var attrib=data99.attributes[i].value; 
				
				if(attrib=="Female")
				{
				oldhtnfem++;
				}
				else if(attrib=="Male")
				{
				oldhtnmal++;
				}

				 }
	    });
	
	}			
			  
			  
			  var group = $("<tr style='border:1px solid black;background-color:#fffacd;height:30px'><td style= 'text-align:center' colspan='2' >PHD-25 </td> 	<td style= 'text-align:center' colspan='1' >"+mal+"</td> <td style= 'text-align:center' colspan='1' >" +fem+ "</td><td style= 'text-align:center' colspan='1' >" +lengthentity + "</td> <td style= 'text-align:center' colspan='1' >" +htnmal + "</td><td style= 'text-align:center' colspan='1' >" +htnfem + "</td><td style= 'text-align:center' colspan='1' >" +commonValues.length + "</td><td style= 'text-align:center' colspan='1' >"+breastca+"</td> <td style= 'text-align:center' colspan='1' >"+cervical+"</td> <td style= 'text-align:center' colspan='1' >"+totcancer+"</td><td style= 'text-align:center' colspan='1' >"+oldhtnmal+" </td><td style= 'text-align:center' colspan='1' >"+oldhtnfem+"</td><td style= 'text-align:center' colspan='1' >"+uniquee.length+"</td> </tr>");
	         var totalall = $("<tr style='border:1px solid black;background-color:#fffacd;height:30px'><td style= 'text-align:center' colspan='2' >Overall Total </td> 	<td style= 'text-align:center' colspan='1' >"+mal+"</td> <td style= 'text-align:center' colspan='1' >" +fem+ "</td><td style= 'text-align:center' colspan='1' >" +lengthentity + "</td> <td style= 'text-align:center' colspan='1' >" +htnmal + "</td><td style= 'text-align:center' colspan='1' >" +htnfem + "</td><td style= 'text-align:center' colspan='1' >" +commonValues.length + "</td><td style= 'text-align:center' colspan='1' >"+breastca+"</td> <td style= 'text-align:center' colspan='1' >"+cervical+"</td> <td style= 'text-align:center' colspan='1' >"+totcancer+"</td><td style= 'text-align:center' colspan='1' >"+oldhtnmal+" </td><td style= 'text-align:center' colspan='1' >"+oldhtnfem+"</td><td style= 'text-align:center' colspan='1' >"+uniquee.length+"</td> </tr>");
            
			    $(".reporttable").append(group);
				$(".reporttable").append(totalall);
  </script>
  
  </body>
</html>