<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

<style>
td {
	border: 1px solid black;
     padding: 1px;
    text-align: center;
	 
}
#table1 {
    table-layout: auto;
	border-collapse: collapse;
	 border:none;
}
.emptyRow td {
	border:none;
}
.less{
    margin:0;
    padding:0;
}

</style>
</head>
<body>

 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
   
Start Date:
  <input type="date" name="entry" id="start">
  End Date:
  <input type="date" name="exit" id="end">
   <button type="button" class="btn btn-success" id="getreport" style="font-size:20px;margin-left:100px;" onclick="getreportt()"><i class="fa fa-search"></i>  &nbsp&nbspLow Child Weight  </button>
<!--<button style="font-size:24px;color:red;margin-left:450px;" onclick="abc()">Daily reminder  <i class="fa fa-clock-o"></i></button>-->
<a class="btn btn-danger" onclick="location.reload();" style='font-size:20px;color:white;margin-left:60px;'><i class="fa fa-trash-o fa-lg"></i> &nbsp&nbspClear</a>

<br>
<br>
<br>

<table id="table1" class="reporttable"   style="width:100%">
  
 
    </table>
   <script type="text/javascript" async>
      $.ajaxSetup({
        async: false
    });
	
	     var count=1;
	    var namee=[];
		var objresul=[];
		var objcontraception;
		var sex=[];
		var anmname=[];
		var objtrack=[];
		var housenumber;
		var objedd=[];
		var objmctsid=[];
		var objrefer;
		var objname=[];
		var objlmpadate=[];
		
		var objid=[];
	
		var premature;
		var objdate=[];
		var visitdate;
		var childfeeding;
		var birthweight;
		var sexofinfant;
		var objmatchevent=[];
		var objahouseid=[];
		var objeventid=[];
		var hbvalue;
		var objage=[];
		var objtrack1=[];
		var housedetailss=["xalnzkNfD77","nHR1zCU0maL","Dnm1mq6iq2d","PbEhJPnon0o","kelN057pfhq","zLsKdtlBCIx"];
		var objatt=[];
		var objattribute=[];
		var basichouse=["AiPFBqutPYy","xalnzkNfD77"];
		var basicresult=["FnLijkR1Qku","meeJHik8FU4","D3ugBMt7BTp","RUmmHdBXikB"];
		var objanm=["yDCO4KM4WVA"];
		 function getreportt(){
		 
		 var startdatee=document.getElementById('start').value;
				var enddatee=document.getElementById('end').value;
				
				 $.get("../api/events.json?orgUnit=lZtSBQjZCaX&program=SUCUF657zNe&startDate="+startdatee+"&endDate="+enddatee+"&skipPaging=true", function (data) {
	
			var trackdata=data;
                console.log(trackdata);
				 
				for(var i=0;i<trackdata.events.length;i++)
				{
				
				var matchevent=trackdata.events[i].programStage;
				if(matchevent=="hARiXfJyZe6") {
	
				
				if(trackdata.events[i].eventDate){
			
				
		        var eventdata=trackdata.events[i].dataValues;
				for(var q=0;q<eventdata.length;q++)
				   {
				   var id=eventdata[q].dataElement;
				 // objid.push(id);
				   if(id=="xYguBHfKWLX")//birth weight
				   {
				   var vall=eventdata[q].value;
		            	   
					if(vall < 2.5){

					objtrack.push(trackdata.events[i].trackedEntityInstance);
					objeventid.push(trackdata.events[i].event);
					}
				}
				}
				}
				}
				}
				});
				
				
				  for(var g=0;g<objtrack.length;g++)
				{
				
				 $.get("../api/trackedEntityInstances.json?ou=lZtSBQjZCaX&program=SUCUF657zNe&trackedEntityInstance="+objtrack[g]+"&skipPaging=true", function (data1) {
			  var trackdata=data1;
			 
			    for(var i=0;i<trackdata.trackedEntityInstances.length;i++)
				{
			 
			   var attributepath=trackdata.trackedEntityInstances[i].attributes; 
			  // objtrack.push(trackdata.trackedEntityInstances[i].trackedEntityInstance);
			  for(var q=0;q<attributepath.length;q++)
                    {
					 var idd =attributepath[q].attribute;
					 objattribute.push(idd);
				  
				if(attributepath[q].attribute=="AiPFBqutPYy")//mcts id of mother
				  {
				var aa=attributepath[q].value;
				
				//housenumber=aa;
				objmctsid.push(aa);
			
				 
				 }
				 else if(attributepath[q].attribute=="xalnzkNfD77")//Name of woman
				  {
				var aa=attributepath[q].value;
				
				//nameofwoman=aa;
				objname.push(aa);
			
				 
				 }
				
			 
				  }
			   }
			    }); 
				var array3 = basichouse.filter(function(obj) { return objattribute.indexOf(obj) == -1; });
		          for(var t=0;t<array3.length;t++)
					{
					if(array3[t]=="AiPFBqutPYy")
				      objmctsid.push("");
					else if(array3[t]=="xalnzkNfD77")
					objname.push("");
				
					
					}
					
				 		objattribute=[];
				
				}
			
		              var lowchild="<tr style='border:1px solid black;background-color:#A2FF66;'>  <td  text-align='center' height='12px' colspan='9'> <b>Child Born With Low Weight in the mon th of </b></td><td  text-align='center' height='12px' colspan='8'> <b>Post Natal Visits </b></td>  </tr>";
					 var healthfacilty="<tr style='border:1px solid black;background-color:#A2FF66;'>  <td  text-align='center' height='12px' colspan='9'> <b>Health Facility :PHD-25</b></td><td  text-align='center' height='12px' colspan='8'> <b>Write date of visit and weight at time of visit </b></td>  </tr>";
				
              var header="<tr style='border:1px solid black;background-color:#A2FF66;'>  <td> S.no </td>   <td>MCTS ID No.</td><td>Mother Name</td><td>Delivery Date</td><td>Anemia of mother</td><td>Is Premature of baby</td><td>Child Sex</td><td>Birth Weight</td><td>Child Breastfeeding</td><td>Date of Discharge</td><td>1st</td><td>2nd</td><td>3rd</td><td>4th</td><td>5th</td><td>6th</td></tr>";
			$(".reporttable").append(lowchild);
			$(".reporttable").append(healthfacilty);
				$(".reporttable").append(header);
				if(objtrack.length <=0){
				 var headerresult="<tr>  <td>0</td>   <td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Date of Discharge</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td><td>Nil</td></tr>";
				$(".reporttable").append(headerresult);
				
				}
				
			     for(var j=0;j<objtrack.length;j++){
		 $.get("../api/events.json?orgUnit=lZtSBQjZCaX&program=SUCUF657zNe&trackedEntityInstance="+objtrack[j]+"&&order=eventDate:asc&skipPaging=true", function (data) {
	
			var trackdata=data;
                //console.log(trackdata);
				 
				for(var i=0;i<trackdata.events.length;i++)
				{
				var matchevent=trackdata.events[i].programStage;
				if(matchevent=="hARiXfJyZe6") {
				if(trackdata.events[i].event==objeventid[j]){
				if(trackdata.events[i].eventDate){
		            visitdate=trackdata.events[i].eventDate.substring(0, 10);;
		        var eventdata=trackdata.events[i].dataValues;
				for(var q=0;q<eventdata.length;q++)
				   {
				   var id=eventdata[q].dataElement;
				  objid.push(id);
				   if(id=="RUmmHdBXikB")//sex of infant
				   {
				   
				   
				   var vall=eventdata[q].value;
		            sexofinfant=vall;	   
					
				}
				else  if(id=="meeJHik8FU4")// Preterm
				   {
				   
				   
				   var vall=eventdata[q].value;
		            premature=vall;	   
					
				}
			
				
				else  if(id=="xYguBHfKWLX")// birth weight    
				   { 
				 
				   var vall=eventdata[q].value;
		            birthweight=vall;	   
				}
				
				else  if(id=="XnJa2oYO6jZ")// child breast feeding  
				   { 
				 
				   var vall=eventdata[q].value;
		            childfeeding=vall;	   
				}
               
	       }
		  
					
				 
						}
						}
		   }
		   
		  else if(matchevent=="aAmtHNAQo7g" || matchevent=="WMnWjG8PS58")//anc
		  {
			
				if(trackdata.events[i].eventDate){
		            //visitdate=trackdata.events[i].eventDate.substring(0, 10);;
		        var eventdata=trackdata.events[i].dataValues;
				for(var q=0;q<eventdata.length;q++)
				   {
				   var id=eventdata[q].dataElement;
				  objid.push(id);
				   if(id=="RUmmHdBXikB")//sex of infant
				   {
				   
				   
				   var vall=eventdata[q].value;
		            sexofinfant=vall;	   
					
				}
				else  if(id=="jTyiikEB6Vm")// HB gm   
				   {
				   
				   
				   var vall=eventdata[q].value;
				   if (vall >11)
		            hbvalue="yes";	   
					
				}
				else  if(id=="yka2bblmdbM")// HB gm   1st 
				   { 
				   
				   
				   var vall=eventdata[q].value;
				    if (vall >11)
		            hbvalue="yes";	   
					
				}
				else  if(id=="XI9R4MyF4cP")// HB gm    2nd
				   { 
				   
				   
				   var vall=eventdata[q].value;
				    if (vall >11)
		            hbvalue="yes";	   
				}
				else  if(id=="RMGf5pzvlGN")// HB gm 3rd   
				   { 
				   
				   
				   var vall=eventdata[q].value;
				    if (vall >11)
		            hbvalue="yes";	   
				}
				else  if(id=="HkOHsdUuQSl")// HB gm 4rd    
				   { 
				   
				   
				   var vall=eventdata[q].value;
				    if (vall >11)
		            hbvalue="yes";	   
				}
				
               
	       }
		  
					
				 
						}
						
		   }
		  else if(matchevent=="DEwcVnLljOB")//pnc
		  {
				
				if(trackdata.events[i].eventDate){
				 
				 objmatchevent.push(trackdata.events[i].eventDate.substring(0,10));
				 }
				}
		   
		   }
		   
		   });
		if(premature==undefined)
			  {
			  
			  premature="No";
			  }
			  if(childfeeding==undefined)
			  {
			  
			  childfeeding="&nbsp&nbsp";
			  }
			  if(hbvalue!="yes"){
			  hbvalue="No";	
			  }
			   var length_ovjmatchevent=objmatchevent.length;
		     var pushresult=7-parseInt(length_ovjmatchevent);
			 
			 for(var l=0;l<pushresult;l++)
			 {
			 objmatchevent.push("&nbsp&nbsp&nbsp");
			 }
		   //var result="<tr style='border:1px solid black;background-color:white;'>  <td>"+j+"</td><td>"+objmatchevent+" </td><td>"+objname[j]+"</td><td>PHD-25</td><td> "+objage[j]+"</td><td>Yes</td><td>"+objresul+"</td><td>"+objrefer+"</td><td>"+objcontraception+"</td><td>"+anmname[j]+"</td></tr>";
				
				  var headerresult="<tr>  <td>"+j+"</td>   <td>"+objmctsid[j]+"</td><td>"+objname[j]+"</td><td>"+visitdate+"</td><td>"+hbvalue+"</td><td>"+premature+"</td><td>"+sexofinfant+"</td><td>"+birthweight+"</td><td>"+childfeeding+"</td><td>Date of Discharge</td><td>"+objmatchevent[0]+"</td><td>"+objmatchevent[1]+"</td><td>"+objmatchevent[2]+"</td><td>"+objmatchevent[3]+"</td><td>"+objmatchevent[4]+"</td><td>"+objmatchevent[5]+"</td></tr>";
				$(".reporttable").append(headerresult);
		
			hbvalue="No";	
			objmatchevent=[];
		   }	
				
			
		    
		    } 
		   
   </script>
  

  </body>
  </html>