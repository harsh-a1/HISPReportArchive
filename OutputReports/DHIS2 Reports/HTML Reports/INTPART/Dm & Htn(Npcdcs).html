<!DOCTYPE html>
<html>
<head>
<style>
td {
	border: 1px solid black;
     padding: 1px;
    text-align: center;
	 
}
#table2 {
	table-layout: fixed;
	 border-collapse: collapse;
	   
}
#table1 {
    table-layout: auto;
	border-collapse: collapse;
	 border-top:none;
}
.less{
    margin:0;
    padding:0;
}

</style>
</head>
<body>

<table id="table1" style="width:90%">
  <tr>  
    <td colspan="17">Form 2</td>
  </tr>
  <tr>
    <td colspan="17">National Programme on Prevention & Control of Cancer, Diabetes, CVDs & Stroke (NPCDCS)</td>
	</tr>
	<tr>
    <td colspan="17">Reporting performa for Primary Health Centre (PHC)</td>
	</tr>
	<tr>
    <td colspan="2">
	PHC
	</td>
	<td>
	PHD-25
	</td>
	<td colspan="2">
	Name of Linked Block PHC/CHC
	</td>
	<td>
	CHC,Sector 22
	</td>
	<td>
	
	</td>
	<td>
	District
	</td>
	<td>
	Chandigarh
	</td>
	<td>
	State
	</td>
	<td colspan="7">
	Chandigarh
	</td>
  </tr>
  <tr>
  <td colspan="2">
  Month
  </td>
  <td>
  June
  </td>
  <td>
  Year
  </td>
  <td>
  2017
  </td>
  <td colspan="12">
  </td> 
  </tr>
  <tr>
  <td colspan="2">
  Centres under the PHCs
  </td>
  <td>
  NA
  </td>
  <td colspan="2" >
  </td>
  <td colspan="4">
  No. of Sub-centres reported during the month
  </td>
<td >
   NA
  </td>
  <td colspan="7">
  </td>
  <tr>
  <td colspan="2">
  Part A (Screening )
  </td>
  <td colspan="15">
  </td>
  </tr>
  
  </table>
  
  <table class="reporttable" id="table2" style="width:90%">
  <tr >
  <td colspan="2" >
  Name of SubCentre/PHC
  </td>
  
  <td colspan="3"  >
  Total NCD Checkups Done
  </td>
  
  <td  colspan="3" >
 
 No. of new persons suspected for DM and refered for Confirmation 
  
  </td> 
  
 <td  colspan="3" >
 No. of new persons Suspected for HTN and refered for Confirmation
 </td >
 
 <td colspan="3" >
 No. of known cases of DM on Follow-up
 </td>
 <td colspan="3" >
 No. of known cases of HTN on Follow-up
 </td>
  </tr>
  
  <tr>
  <td colspan="2">
  PHC
  </td>
  <td colspan="3">
  </td>
  <td rowspan="2">
  Male
  </td>
  <td rowspan="2">
  Female
  </td>
  <td rowspan="2">
  Total
  </td>
  <td rowspan="2">
  Male
  </td>
  <td rowspan="2">
  Female
  </td>
  <td rowspan="2">
  Total
  </td>
  <td rowspan="2">
  Male
  </td>
  <td rowspan="2">
  Female
  </td>
  <td rowspan="2">
  Total
  </td>
   <td  rowspan="2">
  Male
  </td>
  <td  rowspan="2">
  Female
  </td>
  <td  rowspan="2">
  Total
  </td>
  </tr>
  <tr>
  <td colspan="2">
  </td>
   <td>
  Male
  </td>
  <td>
  Female
  </td>
  <td>
  Total
  </td>
  </tr>
  </table>
  </br>
  </br>
  </br>
  <div>
  <h6> Signature</h6>
  <h6> Name and Designation</h6>
  <h6> Date of reporting</h6>
  <h6 class="less"> * This report should be generated from PHC OPD screening data and also by compiling data of Form 1 of all sub-centres under the PHC</h6>
  <h6 class="less"> This should be verified and signed by Medical Officer I/C PHC</h6>
  <h6 class="less"> The report should be sent to Block PHC/CHC/District NCD Cell by 5th of every month.</h6>
  </div>
 <script type="text/javascript" async>
  var fem=0;
  var mal=0;
  var newdm=0;
  var dmfem=0;
  var dmmal=0;
  var newhtn=0;
  var htnmal=0;
  var htnfem=0;
  var olddm=0;
   var  oldhtnmal=0;
  var oldhtn=0;
  var olddmfem=0;
  var olddmmal=0;
  var oldhtnfem=0;
  var lengthentity;
  var obj=[];
  var obj1=[];
  var obj2=[];
  var obj3=[];
  var filtroldhtn=[];
  var filtrnewhtn=[];
  var filtrolddm=[];
  var filternewdm=[];
  var uniquee=[];
  var uniqueee=[];
  var commonValues = [];
  var commonValuess=[];
  $.ajaxSetup({
        async: false
    });
	 var url = "../api/events.json?orgUnit=lZtSBQjZCaX&program=jC8Gprj4pWV&startDate=2017-08-01&endDate=2017-08-30&skipPaging=true";
	
	
	       var url1=  "../api/trackedEntityInstances.json?ou=lZtSBQjZCaX&program=jC8Gprj4pWV&programStartDate=2017-08-01&programEndDate=2017-08-30&skipPaging=true";
			 
			 
			  $.get(url1, function (data1) {
			 
			var trackdata=data1;
                console.log(trackdata);
				
				for(var i=0;i<trackdata.trackedEntityInstances.length;i++)
				{
						 lengthentity=trackdata.trackedEntityInstances.length;
				var attributepath=trackdata.trackedEntityInstances[i].attributes; 
				 for(var q=0;q<attributepath.length;q++)
                    {
				if(attributepath[q].value=="Female")
				{
				fem++;
				}
				else if(attributepath[q].value=="Male")
				{
				mal++;
				}

				 }
			  
			  
				}
				
			console.log("no of female"+fem );
			  console.log("no of male"+mal );
			  return fem;
			  return mal;
			  });
			  //------------------------------------------dm---------------
			  
			  
			
			 
	 
            $.get(url, function (data) {
			var eventdata=data;
                console.log(eventdata);
				
				
				
				for(var j=0;j<eventdata.events.length;j++)
				{
				// leng=eventdata.events.length;
				 
			     //  console.log(leng);
				   var dm=eventdata.events[j].dataValues;
				   for(var q=0;q<dm.length;q++)
				   {
				   var id=dm[q].dataElement;
				   // new caseof dm
				   if(id=="GREEuTukX3P"){
				   
				   var track= eventdata.events[j].trackedEntityInstance;
				   
				   obj.push(track);
				   var val=dm[q].value;
		           if(val=="true")
		             {
					 filternewdm.push(track);
			           newdm++;
		             }
					 
				   }
				   else if(id=="FSD6mDILc7l")
				   {
				   var trackk=eventdata.events[j].trackedEntityInstance;
				   obj1.push(trackk);
				   var vall=dm[q].value;
		           if(vall=="true")
		             {
					 filtrnewhtn.push(trackk);
			           newhtn++;
		             }
				   
				   }
				   // old dm cases
				   else if(id=="MAegca1cc8A")
				   {
				    var trackkk=eventdata.events[j].trackedEntityInstance;
				   obj2.push(trackkk);
				     var val2=dm[q].value;
		           if(val2=="true")
		             {
					 filtrolddm.push(trackkk);
			           olddm++;
		             }
				   
				   }
				   // old htn
				   
				    else if(id=="CjdVmiha2lq")
				   {
				    var trackkkk=eventdata.events[j].trackedEntityInstance;
				   obj3.push(trackkkk);
				     var val3=dm[q].value;
		           if(val3=="true")
		             {
					 filtroldhtn.push(trackkkk);
			           oldhtn++;
		             }
				   
				   }
				   
				   
                   }            
				}
				//console.log(obj);
				 console.log("total of new dm"+newdm);
                  console.log("total of new htn"+newhtn);
				   console.log("total of old dm   "+olddm);
            });
	
	
	
	// common values of htn old and new case
	
var i, j;
var arr1Length = filtrnewhtn.length;
var arr2Length = filtroldhtn.length;

for (i = 0; i < arr1Length; i++) {
    for (j = 0; j < arr2Length; j++) {
        if (filtrnewhtn[i] === filtroldhtn[j]) {
            commonValues.push(filtrnewhtn[i]);
        }
    }
}
//-------------------------

	// common values of dm old and new case
	
var ii, jj;
var arr1Lengthh = filternewdm.length;
var arr2Lengthh = filtrolddm.length;

for (ii = 0; ii < arr1Lengthh; ii++) {
    for (jj = 0; jj < arr2Lengthh; jj++) {
        if (filternewdm[ii] === filtrolddm[jj]) {
            commonValuess.push(filternewdm[ii]);
        }
    }
}
   // unique values of htn old and new case
	//---------------------------------------------------
	   
	function uniquenumber(filtrnewhtn,filtroldhtn){
	      var aa=filtrnewhtn.length;
		  var bb= filtroldhtn.length;
		  if(aa>bb)
		  {
		  var onearray=filtrnewhtn;
		  var twoarray=filtroldhtn;
		  }
		  else
		  {
		  var onearray=filtroldhtn;
		  var twoarray=filtrnewhtn;
		  }
	var array3 = onearray.filter(function(obj) { return twoarray.indexOf(obj) == -1; });
	  return array3;
	 // console.log(array3);
	};
	//------------------------------------------------
	 uniquee= uniquenumber(filtrnewhtn,filtroldhtn);
	 
	 // unique value of dm old and new value
	 
	//---------------------------------------------------
	   
	function uniquenumberr(filternewdm,filtrolddm){
	      var aa=filternewdm.length;
		  var bb= filtrolddm.length;
		  if(aa>bb)
		  {
		  var onearray=filternewdm;
		  var twoarray=filtrolddm;
		  }
		  else
		  {
		  var onearray=filtrolddm;
		  var twoarray=filternewdm;
		  }
	var array4 = onearray.filter(function(obj) { return twoarray.indexOf(obj) == -1; });
	  return array4;
	 // console.log(array3);
	};
	//------------------------------------------------
	 uniqueee= uniquenumberr(filternewdm,filtrolddm);
	 
	 
	
	
	
	
	//for getting males and females of dm
	
	for(var p=0;p<commonValuess.length;p++)
	{
	
	 $.getJSON("../api/trackedEntityInstances/"+commonValuess[p]+".json?", function (data99) {
	 
	 for(var i=0;i<data99.attributes.length;i++)
				{
						
				var attrib=data99.attributes[i].value; 
				
				if(attrib=="Female")
				{
				dmfem++;
				}
				else if(attrib=="Male")
				{
				dmmal++;
				}

				 }
	    });
	
	}
	console.log("no of dm female"+dmfem);
	console.log("no of dm male"+dmmal);
	// For male and female of the htn
	for(var p=0;p<commonValues.length;p++)
	{
	
	 $.getJSON("../api/trackedEntityInstances/"+commonValues[p]+".json?", function (data99) {
	 
	 for(var i=0;i<data99.attributes.length;i++)
				{
						
				var attrib=data99.attributes[i].value; 
				
				if(attrib=="Female")
				{
				htnfem++;
				}
				else if(attrib=="Male")
				{
				htnmal++;
				}

				 }
	    });
	
	}
	// For male and female of the old dm
	for(var p=0;p<uniqueee.length;p++)
	{
	
	 $.getJSON("../api/trackedEntityInstances/"+uniqueee[p]+".json?", function (data99) {
	 
	 for(var i=0;i<data99.attributes.length;i++)
				{
						
				var attrib=data99.attributes[i].value; 
				
				if(attrib=="Female")
				{
				olddmfem++;
				}
				else if(attrib=="Male")
				{
				olddmmal++;
				}

				 }
	    });
	
	}
	// For male and female of the old htn
	for(var p=0;p<uniquee.length;p++)
	{
	
	 $.getJSON("../api/trackedEntityInstances/"+uniquee[p]+".json?", function (data99) {
	 
	 for(var i=0;i<data99.attributes.length;i++)
				{
						
				var attrib=data99.attributes[i].value; 
				
				if(attrib=="Female")
				{
				oldhtnfem++;
				}
				else if(attrib=="Male")
				{
				oldhtnmal++;
				}

				 }
	    });
	
	}
	//---------------------------------------------------

	 
	 
	 
	 
	 
	 
	 //+++++++++++++++++++++++++++++++++++++++
	console.log(filtrnewhtn);
	console.log(filtroldhtn);
	console.log(commonValues);
	console.log(uniquee);
	var group = $("<tr style='border:1px solid black;background-color:#fffacd;height:30px'><td style= 'text-align:center' colspan='2' >PHD-25 </td> 	<td style= 'text-align:center' colspan='1' >"+mal+"</td> <td style= 'text-align:center' colspan='1' >" +fem+ "</td><td style= 'text-align:center' colspan='1' >" +lengthentity + "</td> <td style= 'text-align:center' colspan='1' >"+dmmal+" </td> <td style= 'text-align:center' colspan='1' >" +dmfem+ "</td> <td style= 'text-align:center' colspan='1' >"+commonValuess.length+"</td> <td style= 'text-align:center' colspan='1' >"+htnmal+"</td> <td style= 'text-align:center' colspan='1' >"+htnfem+"</td> <td style= 'text-align:center' colspan='1' >"+commonValues.length+"</td><td style= 'text-align:center' colspan='1' >"+olddmmal+"</td> <td style= 'text-align:center' colspan='1' >"+olddmfem+"</td> <td style= 'text-align:center' colspan='1' >"+uniqueee.length+"</td> <td style= 'text-align:center' colspan='1' >"+oldhtnmal+"</td><td style= 'text-align:center' colspan='1' >"+oldhtnfem+"</td><td style= 'text-align:center' colspan='1' >"+uniquee.length+"</td>  	</tr>");
	 var totalall=$("<tr style='border:1px solid black;background-color:#fffacd;height:30px'><td style= 'text-align:center' colspan='2' >Over Total</td> 	<td style= 'text-align:center' colspan='1' >"+mal+"</td> <td style= 'text-align:center' colspan='1' >" +fem+ "</td><td style= 'text-align:center' colspan='1' >" +lengthentity + "</td> <td style= 'text-align:center' colspan='1' >"+dmmal+" </td> <td style= 'text-align:center' colspan='1' >" +dmfem+ "</td> <td style= 'text-align:center' colspan='1' >"+commonValuess.length+"</td> <td style= 'text-align:center' colspan='1' >"+htnmal+"</td> <td style= 'text-align:center' colspan='1' >"+htnfem+"</td> <td style= 'text-align:center' colspan='1' >"+commonValues.length+"</td><td style= 'text-align:center' colspan='1' >"+olddmmal+"</td> <td style= 'text-align:center' colspan='1' >"+olddmfem+"</td> <td style= 'text-align:center' colspan='1' >"+uniqueee.length+"</td> <td style= 'text-align:center' colspan='1' >"+oldhtnmal+"</td><td style= 'text-align:center' colspan='1' >"+oldhtnfem+"</td><td style= 'text-align:center' colspan='1' >"+uniquee.length+"</td> </tr>");
            
			    $(".reporttable").append(group);
				$(".reporttable").append(totalall);
	
 </script>

</body>
</html>
